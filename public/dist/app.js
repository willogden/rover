!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){"use strict";require("angular"),require("angular-touch"),require("angular-ui-router"),require("famous-angular"),require("../../build/templates"),module.exports=angular.module("app",["ui.router","famous.angular","templates",require("./home/home").name,require("./about/about").name]).config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/home")}]).controller("AppCtrl",require("./app-controller")).factory("jsonWebSocketFactory",require("./components/jsonwebsocket-factory")).service("roverJSONWebSocketService",require("./components/rover-jsonwebsocket-service")).run(["$rootScope","$state","$stateParams","jsonWebSocketFactory",function($rootScope,$state,$stateParams){$rootScope.$state=$state,$rootScope.$stateParams=$stateParams}])},{"../../build/templates":2,"./about/about":3,"./app-controller":4,"./components/jsonwebsocket-factory":6,"./components/rover-jsonwebsocket-service":7,"./home/home":9,angular:12,"angular-touch":10,"angular-ui-router":11,"famous-angular":13}],2:[function(){!function(module){try{module=angular.module("templates")}catch(e){module=angular.module("templates",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("about/about.tpl.html",'<ul><li ng-repeat="choice in dropdownDemoItems"><a>{{choice}}</a></li></ul>')}])}(),function(module){try{module=angular.module("templates")}catch(e){module=angular.module("templates",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("home/home.tpl.html",'<div class="home" ng-controller="HomeCtrl"><control-stick ng-model="motorspeed0"></control-stick><control-stick ng-model="motorspeed1"></control-stick><fa-app style="height: 200px"><fa-surface fa-background-color="\'red\'">Hello world</fa-surface></fa-app></div>')}])}(),function(module){try{module=angular.module("templates")}catch(e){module=angular.module("templates",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("components/control-stick/control-stick.tpl.html",'<input ng-model="controlStickValue" type="range" min="0" max="100" value="0">')}])}()},{}],3:[function(require,module){"use strict";module.exports=angular.module("app.about",["ui.router"]).config(["$stateProvider",function($stateProvider){$stateProvider.state("about",{url:"/about",views:{main:{controller:"AboutCtrl",templateUrl:"about/about.tpl.html"}},data:{pageTitle:"What is It?"}})}]).controller("AboutCtrl",["$scope",function($scope){$scope.dropdownDemoItems=["The first choice!","And another choice for you.","but wait! A third!"]}])},{}],4:[function(require,module){module.exports=function($scope){$scope.$on("$stateChangeSuccess",function(event,toState){angular.isDefined(toState.data.pageTitle)&&($scope.pageTitle=toState.data.pageTitle+" | app")}),$scope.navVisible=!1,$scope.toggleNav=function(){$scope.navVisible=!$scope.navVisible}}},{}],5:[function(require,module){module.exports=function(){return{templateUrl:"components/control-stick/control-stick.tpl.html",scope:{controlStickValue:"=ngModel"},link:function(scope,element){scope.controlStickValue=0,element.addClass("components__control-stick")}}}},{}],6:[function(require,module){module.exports=function(){var _connections={},JSONWebSocket=function(name,URI){this.registeredEventListeners={onopen:[],onerror:[],onmessage:[]},this.name=name,this.connection=new WebSocket(URI),this.connection.onopen=function(){for(var c in this.registeredEventListeners.onopen)this.registeredEventListeners.onopen[c].call(this)}.bind(this),this.connection.onerror=function(error){for(var c in this.registeredEventListeners.onerror)this.registeredEventListeners.onerror[c].call(this,error)}.bind(this),this.connection.onmessage=function(e){for(var c in this.registeredEventListeners.onmessage)this.registeredEventListeners.onmessage[c].call(this,JSON.parse(e.data))}.bind(this)};return JSONWebSocket.prototype.send=function(pojo){this.connection.send(JSON.stringify(pojo))},JSONWebSocket.prototype.addEventListener=function(event,callback){this.registeredEventListeners[event].push(callback)},JSONWebSocket.prototype.isReady=function(){return 1==this.connection.readyState},{create:function(name,URI){return name in _connections||(_connections[name]=new JSONWebSocket(name,URI)),_connections[name]},get:function(name){return _connections[name]}}}},{}],7:[function(require,module){module.exports=function(jsonWebSocketFactory){return jsonWebSocketFactory.create("rover","ws://"+location.host+"/api/ws")}},{}],8:[function(require,module){module.exports=function($scope,roverJSONWebSocketService){var roverJSONWebSocket=roverJSONWebSocketService;roverJSONWebSocket.addEventListener("onopen",function(){}),roverJSONWebSocket.addEventListener("onerror",function(error){console.log("Error",error)}),roverJSONWebSocket.addEventListener("onmessage",function(data){console.log("Message",data)}),$scope.motorspeed0=0,$scope.motorspeed1=0,$scope.$watch("motorspeed0",function(newValue){roverJSONWebSocket.isReady()&&roverJSONWebSocket.send({type:"motorspeed",data:{motor:0,speed:Number(newValue)}})}),$scope.$watch("motorspeed1",function(newValue){roverJSONWebSocket.isReady()&&roverJSONWebSocket.send({type:"motorspeed",data:{motor:1,speed:Number(newValue)}})})}},{}],9:[function(require,module){"use strict";var HomeCtrl=require("./home-controller"),ControlStickDirective=require("../components/control-stick/control-stick-directive");module.exports=angular.module("app.home",["ui.router","ngTouch"]).config(["$stateProvider",function($stateProvider){$stateProvider.state("home",{url:"/home",views:{main:{controller:"HomeCtrl",templateUrl:"home/home.tpl.html"}},data:{pageTitle:"Home"}})}]).controller("HomeCtrl",HomeCtrl).directive("controlStick",ControlStickDirective)},{"../components/control-stick/control-stick-directive":5,"./home-controller":8}],10:[function(require,module){(function(global){require("/Users/willogden/Development/projects/go/src/github.com/willogden/rover/public/vendor/angular/angular.js"),__browserify_shim_require__=require,function(){!function(window,angular){"use strict";function makeSwipeDirective(directiveName,direction,eventName){ngTouch.directive(directiveName,["$parse","$swipe",function($parse,$swipe){var MAX_VERTICAL_DISTANCE=75,MAX_VERTICAL_RATIO=.3,MIN_HORIZONTAL_DISTANCE=30;return function(scope,element,attr){function validSwipe(coords){if(!startCoords)return!1;var deltaY=Math.abs(coords.y-startCoords.y),deltaX=(coords.x-startCoords.x)*direction;return valid&&MAX_VERTICAL_DISTANCE>deltaY&&deltaX>0&&deltaX>MIN_HORIZONTAL_DISTANCE&&MAX_VERTICAL_RATIO>deltaY/deltaX}var startCoords,valid,swipeHandler=$parse(attr[directiveName]);$swipe.bind(element,{start:function(coords){startCoords=coords,valid=!0},cancel:function(){valid=!1},end:function(coords,event){validSwipe(coords)&&scope.$apply(function(){element.triggerHandler(eventName),swipeHandler(scope,{$event:event})})}})}}])}var ngTouch=angular.module("ngTouch",[]);ngTouch.factory("$swipe",[function(){function getCoordinates(event){var touches=event.touches&&event.touches.length?event.touches:[event],e=event.changedTouches&&event.changedTouches[0]||event.originalEvent&&event.originalEvent.changedTouches&&event.originalEvent.changedTouches[0]||touches[0].originalEvent||touches[0];return{x:e.clientX,y:e.clientY}}var MOVE_BUFFER_RADIUS=10;return{bind:function(element,eventHandlers){var totalX,totalY,startCoords,lastPos,active=!1;element.on("touchstart mousedown",function(event){startCoords=getCoordinates(event),active=!0,totalX=0,totalY=0,lastPos=startCoords,eventHandlers.start&&eventHandlers.start(startCoords,event)}),element.on("touchcancel",function(event){active=!1,eventHandlers.cancel&&eventHandlers.cancel(event)}),element.on("touchmove mousemove",function(event){if(active&&startCoords){var coords=getCoordinates(event);if(totalX+=Math.abs(coords.x-lastPos.x),totalY+=Math.abs(coords.y-lastPos.y),lastPos=coords,!(MOVE_BUFFER_RADIUS>totalX&&MOVE_BUFFER_RADIUS>totalY))return totalY>totalX?(active=!1,void(eventHandlers.cancel&&eventHandlers.cancel(event))):(event.preventDefault(),void(eventHandlers.move&&eventHandlers.move(coords,event)))}}),element.on("touchend mouseup",function(event){active&&(active=!1,eventHandlers.end&&eventHandlers.end(getCoordinates(event),event))})}}}]),ngTouch.config(["$provide",function($provide){$provide.decorator("ngClickDirective",["$delegate",function($delegate){return $delegate.shift(),$delegate}])}]),ngTouch.directive("ngClick",["$parse","$timeout","$rootElement",function($parse,$timeout,$rootElement){function hit(x1,y1,x2,y2){return Math.abs(x1-x2)<CLICKBUSTER_THRESHOLD&&Math.abs(y1-y2)<CLICKBUSTER_THRESHOLD}function checkAllowableRegions(touchCoordinates,x,y){for(var i=0;i<touchCoordinates.length;i+=2)if(hit(touchCoordinates[i],touchCoordinates[i+1],x,y))return touchCoordinates.splice(i,i+2),!0;return!1}function onClick(event){if(!(Date.now()-lastPreventedTime>PREVENT_DURATION)){var touches=event.touches&&event.touches.length?event.touches:[event],x=touches[0].clientX,y=touches[0].clientY;1>x&&1>y||lastLabelClickCoordinates&&lastLabelClickCoordinates[0]===x&&lastLabelClickCoordinates[1]===y||(lastLabelClickCoordinates&&(lastLabelClickCoordinates=null),"label"===event.target.tagName.toLowerCase()&&(lastLabelClickCoordinates=[x,y]),checkAllowableRegions(touchCoordinates,x,y)||(event.stopPropagation(),event.preventDefault(),event.target&&event.target.blur()))}}function onTouchStart(event){var touches=event.touches&&event.touches.length?event.touches:[event],x=touches[0].clientX,y=touches[0].clientY;touchCoordinates.push(x,y),$timeout(function(){for(var i=0;i<touchCoordinates.length;i+=2)if(touchCoordinates[i]==x&&touchCoordinates[i+1]==y)return void touchCoordinates.splice(i,i+2)},PREVENT_DURATION,!1)}function preventGhostClick(x,y){touchCoordinates||($rootElement[0].addEventListener("click",onClick,!0),$rootElement[0].addEventListener("touchstart",onTouchStart,!0),touchCoordinates=[]),lastPreventedTime=Date.now(),checkAllowableRegions(touchCoordinates,x,y)}var lastPreventedTime,touchCoordinates,lastLabelClickCoordinates,TAP_DURATION=750,MOVE_TOLERANCE=12,PREVENT_DURATION=2500,CLICKBUSTER_THRESHOLD=25,ACTIVE_CLASS_NAME="ng-click-active";return function(scope,element,attr){function resetState(){tapping=!1,element.removeClass(ACTIVE_CLASS_NAME)}var tapElement,startTime,touchStartX,touchStartY,clickHandler=$parse(attr.ngClick),tapping=!1;element.on("touchstart",function(event){tapping=!0,tapElement=event.target?event.target:event.srcElement,3==tapElement.nodeType&&(tapElement=tapElement.parentNode),element.addClass(ACTIVE_CLASS_NAME),startTime=Date.now();var touches=event.touches&&event.touches.length?event.touches:[event],e=touches[0].originalEvent||touches[0];touchStartX=e.clientX,touchStartY=e.clientY}),element.on("touchmove",function(){resetState()}),element.on("touchcancel",function(){resetState()}),element.on("touchend",function(event){var diff=Date.now()-startTime,touches=event.changedTouches&&event.changedTouches.length?event.changedTouches:event.touches&&event.touches.length?event.touches:[event],e=touches[0].originalEvent||touches[0],x=e.clientX,y=e.clientY,dist=Math.sqrt(Math.pow(x-touchStartX,2)+Math.pow(y-touchStartY,2));tapping&&TAP_DURATION>diff&&MOVE_TOLERANCE>dist&&(preventGhostClick(x,y),tapElement&&tapElement.blur(),angular.isDefined(attr.disabled)&&attr.disabled!==!1||element.triggerHandler("click",[event])),resetState()}),element.onclick=function(){},element.on("click",function(event,touchend){scope.$apply(function(){clickHandler(scope,{$event:touchend||event})})}),element.on("mousedown",function(){element.addClass(ACTIVE_CLASS_NAME)}),element.on("mousemove mouseup",function(){element.removeClass(ACTIVE_CLASS_NAME)})}}]),makeSwipeDirective("ngSwipeLeft",-1,"swipeleft"),makeSwipeDirective("ngSwipeRight",1,"swiperight")}(window,window.angular)}.call(global,module,void 0,void 0)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"/Users/willogden/Development/projects/go/src/github.com/willogden/rover/public/vendor/angular/angular.js":12}],11:[function(require,module,exports){(function(global){require("/Users/willogden/Development/projects/go/src/github.com/willogden/rover/public/vendor/angular/angular.js"),__browserify_shim_require__=require,function(module){"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(window,angular,undefined){"use strict";function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst.hasOwnProperty(key)||(dst[key]=value)})}),dst}function ancestors(first,second){var path=[];for(var n in first.path){if(first.path[n]!==second.path[n])break;path.push(first.path[n])}return path}function objectKeys(object){if(Object.keys)return Object.keys(object);var result=[];return angular.forEach(object,function(val,key){result.push(key)}),result}function arraySearch(array,value){if(Array.prototype.indexOf)return array.indexOf(value,Number(arguments[2])||0);var len=array.length>>>0,from=Number(arguments[2])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in array&&array[from]===value)return from;return-1}function inheritParams(currentParams,newParams,$current,$to){var parentParams,parents=ancestors($current,$to),inherited={},inheritList=[];for(var i in parents)if(parents[i].params&&(parentParams=objectKeys(parents[i].params),parentParams.length))for(var j in parentParams)arraySearch(inheritList,parentParams[j])>=0||(inheritList.push(parentParams[j]),inherited[parentParams[j]]=currentParams[parentParams[j]]);return extend({},inherited,newParams)}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return!1}return!0}function filterByKeys(keys,values){var filtered={};return forEach(keys,function(name){filtered[name]=values[name]}),filtered}function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){function visit(value,key){if(visited[key]!==VISIT_DONE){if(cycle.push(key),visited[key]===VISIT_IN_PROGRESS)throw cycle.splice(0,cycle.indexOf(key)),new Error("Cyclic dependency: "+cycle.join(" -> "));if(visited[key]=VISIT_IN_PROGRESS,isString(value))plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES);else{var params=$injector.annotate(value);forEach(params,function(param){param!==key&&invocables.hasOwnProperty(param)&&visit(invocables[param],param)}),plan.push(key,value,params)}cycle.pop(),visited[key]=VISIT_DONE}}function isResolve(value){return isObject(value)&&value.then&&value.$$promises}if(!isObject(invocables))throw new Error("'invocables' must be an object");var plan=[],cycle=[],visited={};return forEach(invocables,visit),invocables=cycle=visited=null,function(locals,parent,self){function done(){--wait||(merged||merge(values,parent.$$values),result.$$values=values,result.$$promises=!0,delete result.$$inheritedValues,resolution.resolve(values))}function fail(reason){result.$$failure=reason,resolution.reject(reason)}function invoke(key,invocable,params){function onfailure(reason){invocation.reject(reason),fail(reason)}function proceed(){if(!isDefined(result.$$failure))try{invocation.resolve($injector.invoke(invocable,self,values)),invocation.promise.then(function(result){values[key]=result,done()},onfailure)}catch(e){onfailure(e)}}var invocation=$q.defer(),waitParams=0;forEach(params,function(dep){promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)&&(waitParams++,promises[dep].then(function(result){values[dep]=result,--waitParams||proceed()},onfailure))}),waitParams||proceed(),promises[key]=invocation.promise}if(isResolve(locals)&&self===undefined&&(self=parent,parent=locals,locals=null),locals){if(!isObject(locals))throw new Error("'locals' must be an object")}else locals=NO_LOCALS;if(parent){if(!isResolve(parent))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else parent=NO_PARENT;var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=!1;if(isDefined(parent.$$failure))return fail(parent.$$failure),result;parent.$$inheritedValues&&merge(values,parent.$$inheritedValues),parent.$$values?(merged=merge(values,parent.$$values),result.$$inheritedValues=parent.$$values,done()):(parent.$$inheritedValues&&(result.$$inheritedValues=parent.$$inheritedValues),extend(promises,parent.$$promises),parent.then(done,fail));for(var i=0,ii=plan.length;ii>i;i+=3)locals.hasOwnProperty(plan[i])?done():invoke(plan[i],plan[i+1],plan[i+2]);return result}},this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null},this.fromString=function(template,params){return isFunction(template)?template(params):template},this.fromUrl=function(url,params){return isFunction(url)&&(url=url(params)),null==url?null:$http.get(url,{cache:$templateCache}).then(function(response){return response.data})},this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}function UrlMatcher(pattern,config){function $value(value){return isDefined(value)?this.type.decode(value):$UrlMatcherFactory.$$getDefaultValue(this)}function addParameter(id,type,config){if(!/^\w+(-+\w+)*$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(params[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");params[id]=extend({type:type||new Type,$value:$value},config)}function quoteRegExp(string,pattern,isOptional){var result=string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!pattern)return result;var flag=isOptional?"?":"";return result+flag+"("+pattern+")"+flag}function paramConfig(param){if(!config.params||!config.params[param])return{};var cfg=config.params[param];return isObject(cfg)?cfg:{value:cfg}}config=angular.isObject(config)?config:{};var m,placeholder=/([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,compiled="^",last=0,segments=this.segments=[],params=this.params={};this.source=pattern;for(var id,regexp,segment,type,cfg;(m=placeholder.exec(pattern))&&(id=m[2]||m[3],regexp=m[4]||("*"==m[1]?".*":"[^/]*"),segment=pattern.substring(last,m.index),type=this.$types[regexp]||new Type({pattern:new RegExp(regexp)}),cfg=paramConfig(id),!(segment.indexOf("?")>=0));)compiled+=quoteRegExp(segment,type.$subPattern(),isDefined(cfg.value)),addParameter(id,type,cfg),segments.push(segment),last=placeholder.lastIndex;segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);segment=segment.substring(0,i),this.sourcePath=pattern.substring(0,last+i),forEach(search.substring(1).split(/[&?]/),function(key){addParameter(key,null,paramConfig(key))})}else this.sourcePath=pattern,this.sourceSearch="";compiled+=quoteRegExp(segment)+(config.strict===!1?"/?":"")+"$",segments.push(segment),this.regexp=new RegExp(compiled,config.caseInsensitive?"i":undefined),this.prefix=segments[0]}function Type(config){extend(this,config)}function $UrlMatcherFactory(){function getDefaultConfig(){return{strict:isStrictMode,caseInsensitive:isCaseInsensitive}}function isInjectable(value){return isFunction(value)||isArray(value)&&isFunction(value[value.length-1])}function flushTypeQueue(){forEach(typeQueue,function(type){if(UrlMatcher.prototype.$types[type.name])throw new Error("A type named '"+type.name+"' has already been defined.");var def=new Type(isInjectable(type.def)?injector.invoke(type.def):type.def);UrlMatcher.prototype.$types[type.name]=def})}var injector,isCaseInsensitive=!1,isStrictMode=!0,enqueue=!0,typeQueue=[],defaultTypes={"int":{decode:function(val){return parseInt(val,10)},is:function(val){return isDefined(val)?this.decode(val.toString())===val:!1},pattern:/\d+/},bool:{encode:function(val){return val?1:0},decode:function(val){return 0===parseInt(val,10)?!1:!0},is:function(val){return val===!0||val===!1},pattern:/0|1/},string:{pattern:/[^\/]*/},date:{equals:function(a,b){return a.toISOString()===b.toISOString()},decode:function(val){return new Date(val)},encode:function(val){return[val.getFullYear(),("0"+(val.getMonth()+1)).slice(-2),("0"+val.getDate()).slice(-2)].join("-")},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/}};$UrlMatcherFactory.$$getDefaultValue=function(config){if(!isInjectable(config.value))return config.value;if(!injector)throw new Error("Injectable functions cannot be called at configuration time");return injector.invoke(config.value)},this.caseInsensitive=function(value){isCaseInsensitive=value},this.strictMode=function(value){isStrictMode=value},this.compile=function(pattern,config){return new UrlMatcher(pattern,extend(getDefaultConfig(),config))},this.isMatcher=function(o){if(!isObject(o))return!1;var result=!0;return forEach(UrlMatcher.prototype,function(val,name){isFunction(val)&&(result=result&&isDefined(o[name])&&isFunction(o[name]))}),result},this.type=function(name,def){return isDefined(def)?(typeQueue.push({name:name,def:def}),enqueue||flushTypeQueue(),this):UrlMatcher.prototype.$types[name]},this.$get=["$injector",function($injector){return injector=$injector,enqueue=!1,UrlMatcher.prototype.$types={},flushTypeQueue(),forEach(defaultTypes,function(type,name){UrlMatcher.prototype.$types[name]||(UrlMatcher.prototype.$types[name]=new Type(type))}),this}]}function $UrlRouterProvider($locationProvider,$urlMatcherFactory){function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return null!=prefix?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match["$"===what?0:Number(what)]})}function handleIfMatch($injector,handler,match){if(!match)return!1;var result=$injector.invoke(handler,handler,{$match:match});return isDefined(result)?result:!0}function $get($location,$rootScope,$injector,$browser){function appendBasePath(url,isHtml5,absolute){return"/"===baseHref?url:isHtml5?baseHref.slice(0,-1)+url:absolute?baseHref.slice(1)+url:url}function update(evt){function check(rule){var handled=rule($injector,$location);return handled?(isString(handled)&&$location.replace().url(handled),!0):!1}if(!evt||!evt.defaultPrevented){var i,n=rules.length;for(i=0;n>i;i++)if(check(rules[i]))return;otherwise&&check(otherwise)}}function listen(){return listener=listener||$rootScope.$on("$locationChangeSuccess",update)}var baseHref=$browser.baseHref(),location=$location.url();return interceptDeferred||listen(),{sync:function(){update()},listen:function(){return listen()},update:function(read){return read?void(location=$location.url()):void($location.url()!==location&&($location.url(location),$location.replace()))},push:function(urlMatcher,params,options){$location.url(urlMatcher.format(params||{})),options&&options.replace&&$location.replace()},href:function(urlMatcher,params,options){if(!urlMatcher.validates(params))return null;var isHtml5=$locationProvider.html5Mode(),url=urlMatcher.format(params);if(options=options||{},isHtml5||null===url||(url="#"+$locationProvider.hashPrefix()+url),url=appendBasePath(url,isHtml5,options.absolute),!options.absolute||!url)return url;var slash=!isHtml5&&url?"/":"",port=$location.port();return port=80===port||443===port?"":":"+port,[$location.protocol(),"://",$location.host(),port,slash,url].join("")}}}var listener,rules=[],otherwise=null,interceptDeferred=!1;this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");return rules.push(rule),this},this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");return otherwise=rule,this},this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what)&&(what=$urlMatcherFactory.compile(what)),!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){return handlerIsString&&(redirect=$urlMatcherFactory.compile(handler),handler=["$match",function($match){return redirect.format($match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");return handlerIsString&&(redirect=handler,handler=["$match",function($match){return interpolate(redirect,$match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}},check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check)if(check[n])return this.rule(strategies[n](what,handler));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(defer){defer===undefined&&(defer=!0),interceptDeferred=defer},this.$get=$get,$get.$inject=["$location","$rootScope","$injector","$browser"]}function $StateProvider($urlRouterProvider,$urlMatcherFactory){function isRelative(stateName){return 0===stateName.indexOf(".")||0===stateName.indexOf("^")}function findState(stateOrName,base){if(!stateOrName)return undefined;var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");for(var rel=name.split("."),i=0,pathLength=rel.length,current=base;pathLength>i;i++)if(""!==rel[i]||0!==i){if("^"!==rel[i])break;if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent}else current=base;rel=rel.slice(i).join("."),name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];return!state||!isStr&&(isStr||state!==stateOrName&&state.self!==stateOrName)?undefined:state}function queueState(parentName,state){queue[parentName]||(queue[parentName]=[]),queue[parentName].push(state)}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"'' is already defined");var parentName=-1!==name.indexOf(".")?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:"";if(parentName&&!states[parentName])return queueState(parentName,state.self);for(var key in stateBuilder)isFunction(stateBuilder[key])&&(state[key]=stateBuilder[key](state,stateBuilder.$delegates[key]));if(states[name]=state,!state[abstractKey]&&state.url&&$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){$state.$current.navigable==state&&equalForKeys($match,$stateParams)||$state.transitionTo(state,$match,{location:!1})}]),queue[name])for(var i=0;i<queue[name].length;i++)registerState(queue[name][i]);return state}function isGlob(text){return text.indexOf("*")>-1}function doesStateMatchGlob(glob){var globSegments=glob.split("."),segments=$state.$current.name.split(".");if("**"===globSegments[0]&&(segments=segments.slice(segments.indexOf(globSegments[1])),segments.unshift("**")),"**"===globSegments[globSegments.length-1]&&(segments.splice(segments.indexOf(globSegments[globSegments.length-2])+1,Number.MAX_VALUE),segments.push("**")),globSegments.length!=segments.length)return!1;for(var i=0,l=globSegments.length;l>i;i++)"*"===globSegments[i]&&(segments[i]="*");return segments.join("")===globSegments.join("")}function decorator(name,func){return isString(name)&&!isDefined(func)?stateBuilder[name]:isFunction(func)&&isString(name)?(stateBuilder[name]&&!stateBuilder.$delegates[name]&&(stateBuilder.$delegates[name]=stateBuilder[name]),stateBuilder[name]=func,this):this}function state(name,definition){return isObject(name)?definition=name:definition.name=name,registerState(definition),this}function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$urlRouter){function handleRedirect(redirect,state,params,options){var evt=$rootScope.$broadcast("$stateNotFound",redirect,state,params);if(evt.defaultPrevented)return $urlRouter.update(),TransitionAborted;if(!evt.retry)return null;if(options.$retry)return $urlRouter.update(),TransitionFailed;var retryTransition=$state.transition=$q.when(evt.retry);return retryTransition.then(function(){return retryTransition!==$state.transition?TransitionSuperseded:(redirect.options.$retry=!0,$state.transitionTo(redirect.to,redirect.toParams,redirect.options))},function(){return TransitionAborted}),$urlRouter.update(),retryTransition}function resolveState(state,params,paramsAreFiltered,inherited,dst){var $stateParams=paramsAreFiltered?params:filterByKeys(objectKeys(state.params),params),locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];return inherited&&promises.push(inherited),forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:locals,params:$stateParams})||""}],promises.push($resolve.resolve(injectables,locals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,locals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else result.$$controller=view.controller;result.$$state=state,result.$$controllerAs=view.controllerAs,dst[name]=result}))}),$q.all(promises).then(function(){return dst})}var TransitionSuperseded=$q.reject(new Error("transition superseded")),TransitionPrevented=$q.reject(new Error("transition prevented")),TransitionAborted=$q.reject(new Error("transition aborted")),TransitionFailed=$q.reject(new Error("transition failed"));return root.locals={resolve:null,globals:{$stateParams:{}}},$state={params:{},current:root.self,$current:root,transition:null},$state.reload=function(){$state.transitionTo($state.current,$stateParams,{reload:!0,inherit:!1,notify:!1})},$state.go=function(to,params,options){return $state.transitionTo(to,params,extend({inherit:!0,relative:$state.$current},options))},$state.transitionTo=function(to,toParams,options){toParams=toParams||{},options=extend({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},options||{});var evt,from=$state.$current,fromParams=$state.params,fromPath=from.path,toState=findState(to,options.relative);if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options},redirectResult=handleRedirect(redirect,from.self,fromParams,options);
if(redirectResult)return redirectResult;if(to=redirect.to,toParams=redirect.toParams,options=redirect.options,toState=findState(to,options.relative),!isDefined(toState)){if(!options.relative)throw new Error("No such state '"+to+"'");throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");options.inherit&&(toParams=inheritParams($stateParams,toParams||{},$state.$current,toState)),to=toState;var toPath=to.path,keep=0,state=toPath[keep],locals=root.locals,toLocals=[];if(!options.reload)for(;state&&state===fromPath[keep]&&equalForKeys(toParams,fromParams,state.ownParams);)locals=toLocals[keep]=state.locals,keep++,state=toPath[keep];if(shouldTriggerReload(to,from,locals,options))return to.self.reloadOnSearch!==!1&&$urlRouter.update(),$state.transition=null,$q.when($state.current);if(toParams=filterByKeys(objectKeys(to.params),toParams||{}),options.notify&&$rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams).defaultPrevented)return $urlRouter.update(),TransitionPrevented;for(var resolved=$q.when(locals),l=keep;l<toPath.length;l++,state=toPath[l])locals=toLocals[l]=inherit(locals),resolved=resolveState(state,toParams,state===to,resolved,locals);var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--)exiting=fromPath[l],exiting.self.onExit&&$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals),exiting.locals=null;for(l=keep;l<toPath.length;l++)entering=toPath[l],entering.locals=toLocals[l],entering.self.onEnter&&$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals);return $state.transition!==transition?TransitionSuperseded:($state.$current=to,$state.current=to.self,$state.params=toParams,copy($state.params,$stateParams),$state.transition=null,options.location&&to.navigable&&$urlRouter.push(to.navigable.url,to.navigable.locals.globals.$stateParams,{replace:"replace"===options.location}),options.notify&&$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams),$urlRouter.update(!0),$state.current)},function(error){return $state.transition!==transition?TransitionSuperseded:($state.transition=null,evt=$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error),evt.defaultPrevented||$urlRouter.update(),$q.reject(error))});return transition},$state.is=function(stateOrName,params){var state=findState(stateOrName);return isDefined(state)?$state.$current!==state?!1:isDefined(params)&&null!==params?angular.equals($stateParams,params):!0:undefined},$state.includes=function(stateOrName,params){if(isString(stateOrName)&&isGlob(stateOrName)){if(!doesStateMatchGlob(stateOrName))return!1;stateOrName=$state.$current.name}var state=findState(stateOrName);return isDefined(state)?isDefined($state.$current.includes[state.name])?equalForKeys(params,$stateParams):!1:undefined},$state.href=function(stateOrName,params,options){options=extend({lossy:!0,inherit:!0,absolute:!1,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;options.inherit&&(params=inheritParams($stateParams,params||{},$state.$current,state));var nav=state&&options.lossy?state.navigable:state;return nav&&nav.url?$urlRouter.href(nav.url,filterByKeys(objectKeys(state.params),params||{}),{absolute:options.absolute}):null},$state.get=function(stateOrName,context){if(0===arguments.length)return objectKeys(states).map(function(name){return states[name].self});var state=findState(stateOrName,context);return state&&state.self?state.self:null},$state}function shouldTriggerReload(to,from,locals,options){return to!==from||(locals!==from.locals||options.reload)&&to.self.reloadOnSearch!==!1?void 0:!0}var root,$state,states={},queue={},abstractKey="abstract",stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){return state.parent&&state.parent.data&&(state.data=state.self.data=extend({},state.parent.data,state.data)),state.data},url:function(state){var url=state.url,config={params:state.params||{}};if(isString(url))return"^"==url.charAt(0)?$urlMatcherFactory.compile(url.substring(1),config):(state.parent.navigable||root).url.concat(url,config);if(!url||$urlMatcherFactory.isMatcher(url))return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},params:function(state){return state.params?state.params:state.url?state.url.params:state.parent.params},views:function(state){var views={};return forEach(isDefined(state.views)?state.views:{"":state},function(view,name){name.indexOf("@")<0&&(name+="@"+state.parent.name),views[name]=view}),views},ownParams:function(state){if(state.params=state.params||{},!state.parent)return objectKeys(state.params);var paramNames={};forEach(state.params,function(v,k){paramNames[k]=!0}),forEach(state.parent.params,function(v,k){if(!paramNames[k])throw new Error("Missing required parameter '"+k+"' in state '"+state.name+"'");paramNames[k]=!1});var ownParams=[];return forEach(paramNames,function(own,p){own&&ownParams.push(p)}),ownParams},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};return includes[state.name]=!0,includes},$delegates:{}};root=registerState({name:"",url:"^",views:null,"abstract":!0}),root.navigable=null,this.decorator=decorator,this.state=state,this.$get=$get,$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter"]}function $ViewProvider(){function $get($rootScope,$templateFactory){return{load:function(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return options=extend(defaults,options),options.view&&(result=$templateFactory.fromConfig(options.view,options.params,options.locals)),result&&options.notify&&$rootScope.$broadcast("$viewContentLoading",options),result}}}this.$get=$get,$get.$inject=["$rootScope","$templateFactory"]}function $ViewScrollProvider(){var useAnchorScroll=!1;this.useAnchorScroll=function(){useAnchorScroll=!0},this.$get=["$anchorScroll","$timeout",function($anchorScroll,$timeout){return useAnchorScroll?$anchorScroll:function($element){$timeout(function(){$element[0].scrollIntoView()},0,!1)}}]}function $ViewDirective($state,$injector,$uiViewScroll){function getService(){return $injector.has?function(service){return $injector.has(service)?$injector.get(service):null}:function(service){try{return $injector.get(service)}catch(e){return null}}}function getRenderer(attrs,scope){var statics=function(){return{enter:function(element,target,cb){target.after(element),cb()},leave:function(element,cb){element.remove(),cb()}}};if($animate)return{enter:function(element,target,cb){$animate.enter(element,null,target,cb)},leave:function(element,cb){$animate.leave(element,cb)}};if($animator){var animate=$animator&&$animator(scope,attrs);return{enter:function(element,target,cb){animate.enter(element,null,target),cb()},leave:function(element,cb){animate.leave(element),cb()}}}return statics()}var service=getService(),$animator=service("$animator"),$animate=service("$animate"),directive={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(tElement,tAttrs,$transclude){return function(scope,$element,attrs){function cleanupLastView(){previousEl&&(previousEl.remove(),previousEl=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentEl&&(renderer.leave(currentEl,function(){previousEl=null}),previousEl=currentEl,currentEl=null)}function updateView(firstTime){var newScope,name=getUiViewName(attrs,$element.inheritedData("$uiView")),previousLocals=name&&$state.$current&&$state.$current.locals[name];if(firstTime||previousLocals!==latestLocals){newScope=scope.$new(),latestLocals=$state.$current.locals[name];var clone=$transclude(newScope,function(clone){renderer.enter(clone,$element,function(){(angular.isDefined(autoScrollExp)&&!autoScrollExp||scope.$eval(autoScrollExp))&&$uiViewScroll(clone)}),cleanupLastView()});currentEl=clone,currentScope=newScope,currentScope.$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}}var previousEl,currentEl,currentScope,latestLocals,onloadExp=attrs.onload||"",autoScrollExp=attrs.autoscroll,renderer=getRenderer(attrs,scope);scope.$on("$stateChangeSuccess",function(){updateView(!1)}),scope.$on("$viewContentLoading",function(){updateView(!1)}),updateView(!0)}}};return directive}function $ViewDirectiveFill($compile,$controller,$state){return{restrict:"ECA",priority:-400,compile:function(tElement){var initial=tElement.html();return function(scope,$element,attrs){var current=$state.$current,name=getUiViewName(attrs,$element.inheritedData("$uiView")),locals=current&&current.locals[name];if(locals){$element.data("$uiView",{name:name,state:locals.$$state}),$element.html(locals.$template?locals.$template:initial);var link=$compile($element.contents());if(locals.$$controller){locals.$scope=scope;var controller=$controller(locals.$$controller,locals);locals.$$controllerAs&&(scope[locals.$$controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}link(scope)}}}}}function getUiViewName(attrs,inherited){var name=attrs.uiView||attrs.name||"";return name.indexOf("@")>=0?name:name+"@"+(inherited?inherited.state.name:"")}function parseStateRef(ref,current){var parsed,preparsed=ref.match(/^\s*({[^}]*})\s*$/);if(preparsed&&(ref=current+"("+preparsed[1]+")"),parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!parsed||4!==parsed.length)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");return stateData&&stateData.state&&stateData.state.name?stateData.state:void 0}function $StateRefDirective($state,$timeout){var allowedOptions=["location","inherit","reload"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(scope,element,attrs,uiSrefActive){var ref=parseStateRef(attrs.uiSref,$state.current.name),params=null,base=stateContext(element)||$state.$current,isForm="FORM"===element[0].nodeName,attr=isForm?"action":"href",nav=!0,options={relative:base,inherit:!0},optionsOverride=scope.$eval(attrs.uiSrefOpts)||{};angular.forEach(allowedOptions,function(option){option in optionsOverride&&(options[option]=optionsOverride[option])});var update=function(newVal){if(newVal&&(params=newVal),nav){var newHref=$state.href(ref.state,params,options),activeDirective=uiSrefActive[1]||uiSrefActive[0];return activeDirective&&activeDirective.$$setStateInfo(ref.state,params),null===newHref?(nav=!1,!1):void(element[0][attr]=newHref)}};ref.paramExpr&&(scope.$watch(ref.paramExpr,function(newVal){newVal!==params&&update(newVal)},!0),params=scope.$eval(ref.paramExpr)),update(),isForm||element.bind("click",function(e){var button=e.which||e.button;if(!(button>1||e.ctrlKey||e.metaKey||e.shiftKey||element.attr("target"))){var transition=$timeout(function(){$state.go(ref.state,params,options)});e.preventDefault(),e.preventDefault=function(){$timeout.cancel(transition)}}})}}}function $StateRefActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){function update(){isMatch()?$element.addClass(activeClass):$element.removeClass(activeClass)}function isMatch(){return"undefined"!=typeof $attrs.uiSrefActiveEq?$state.$current.self===state&&matchesParams():$state.includes(state.name)&&matchesParams()}function matchesParams(){return!params||equalForKeys(params,$stateParams)}var state,params,activeClass;activeClass=$interpolate($attrs.uiSrefActiveEq||$attrs.uiSrefActive||"",!1)($scope),this.$$setStateInfo=function(newState,newParams){state=$state.get(newState,stateContext($element)),params=newParams,update()},$scope.$on("$stateChangeSuccess",update)}]}}function $IsStateFilter($state){return function(state){return $state.is(state)}}function $IncludedByStateFilter($state){return function(state){return $state.includes(state)}}var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy;angular.module("ui.router.util",["ng"]),angular.module("ui.router.router",["ui.router.util"]),angular.module("ui.router.state",["ui.router.router","ui.router.util"]),angular.module("ui.router",["ui.router.state"]),angular.module("ui.router.compat",["ui.router"]),$Resolve.$inject=["$q","$injector"],angular.module("ui.router.util").service("$resolve",$Resolve),$TemplateFactory.$inject=["$http","$templateCache","$injector"],angular.module("ui.router.util").service("$templateFactory",$TemplateFactory),UrlMatcher.prototype.concat=function(pattern,config){return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch,config)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(path,searchParams){var m=this.regexp.exec(path);if(!m)return null;searchParams=searchParams||{};var i,cfg,param,params=this.parameters(),nTotal=params.length,nPath=this.segments.length-1,values={};if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(i=0;nPath>i;i++)param=params[i],cfg=this.params[param],values[param]=cfg.$value(m[i+1]);for(;nTotal>i;i++)param=params[i],cfg=this.params[param],values[param]=cfg.$value(searchParams[param]);return values},UrlMatcher.prototype.parameters=function(param){return isDefined(param)?this.params[param]||null:objectKeys(this.params)},UrlMatcher.prototype.validates=function(params){var isOptional,cfg,result=!0,self=this;return forEach(params,function(val,key){self.params[key]&&(cfg=self.params[key],isOptional=!val&&isDefined(cfg.value),result=result&&(isOptional||cfg.type.is(val)))}),result},UrlMatcher.prototype.format=function(values){var segments=this.segments,params=this.parameters();if(!values)return segments.join("").replace("//","/");var i,search,value,param,cfg,array,nPath=segments.length-1,nTotal=params.length,result=segments[0];if(!this.validates(values))return null;for(i=0;nPath>i;i++)param=params[i],value=values[param],cfg=this.params[param],(isDefined(value)||"/"!==segments[i]&&"/"!==segments[i+1])&&(null!=value&&(result+=encodeURIComponent(cfg.type.encode(value))),result+=segments[i+1]);for(;nTotal>i;i++)param=params[i],value=values[param],null!=value&&(array=isArray(value),array&&(value=value.map(encodeURIComponent).join("&"+param+"=")),result+=(search?"&":"?")+param+"="+(array?value:encodeURIComponent(value)),search=!0);return result},UrlMatcher.prototype.$types={},Type.prototype.is=function(){return!0},Type.prototype.encode=function(val){return val},Type.prototype.decode=function(val){return val},Type.prototype.equals=function(a,b){return a==b},Type.prototype.$subPattern=function(){var sub=this.pattern.toString();return sub.substr(1,sub.length-2)},Type.prototype.pattern=/.*/,angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),$UrlRouterProvider.$inject=["$locationProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider),$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.state").value("$stateParams",{}).provider("$state",$StateProvider),$ViewProvider.$inject=[],angular.module("ui.router.state").provider("$view",$ViewProvider),angular.module("ui.router.state").provider("$uiViewScroll",$ViewScrollProvider),$ViewDirective.$inject=["$state","$injector","$uiViewScroll"],$ViewDirectiveFill.$inject=["$compile","$controller","$state"],angular.module("ui.router.state").directive("uiView",$ViewDirective),angular.module("ui.router.state").directive("uiView",$ViewDirectiveFill),$StateRefDirective.$inject=["$state","$timeout"],$StateRefActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateRefActiveDirective).directive("uiSrefActiveEq",$StateRefActiveDirective),$IsStateFilter.$inject=["$state"],$IncludedByStateFilter.$inject=["$state"],angular.module("ui.router.state").filter("isState",$IsStateFilter).filter("includedByState",$IncludedByStateFilter)}(window,window.angular)}.call(global,module,void 0,void 0)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"/Users/willogden/Development/projects/go/src/github.com/willogden/rover/public/vendor/angular/angular.js":12}],12:[function(require,module){(function(global){__browserify_shim_require__=require,function(module,exports,require,define,browserify_shim__define__module__export__){!function(window,document,undefined){"use strict";function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments;for(message=prefix+template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1);return index+2<templateArgs.length?toDebugString(templateArgs[index+2]):match}),message=message+"\nhttp://errors.angularjs.org/1.3.5-build.3630+sha.30694c8/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(toDebugString(arguments[i]));return new ErrorConstructor(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return obj.nodeType===NODE_TYPE_ELEMENT&&length?!0:isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;length>key;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);return obj}function sortedKeys(obj){return Object.keys(obj).sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){for(var h=dst.$$hashKey,i=1,ii=arguments.length;ii>i;i++){var obj=arguments[i];if(obj)for(var keys=Object.keys(obj),j=0,jj=keys.length;jj>j;j++){var key=keys[j];dst[key]=obj[key]}}return setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),value}function copy(source,destination,stackSource,stackDest){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");if(stackSource=stackSource||[],stackDest=stackDest||[],isObject(source)){var index=stackSource.indexOf(source);if(-1!==index)return stackDest[index];stackSource.push(source),stackDest.push(destination)}var result;if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)result=copy(source[i],null,stackSource,stackDest),isObject(source[i])&&(stackSource.push(source[i]),stackDest.push(result)),destination.push(result)}else{var h=destination.$$hashKey;isArray(destination)?destination.length=0:forEach(destination,function(value,key){delete destination[key]});for(var key in source)source.hasOwnProperty(key)&&(result=copy(source[key],null,stackSource,stackDest),isObject(source[key])&&(stackSource.push(source[key]),stackDest.push(result)),destination[key]=result);setHashKey(destination,h)}}else if(destination=source,source)if(isArray(source))destination=copy(source,[],stackSource,stackDest);else if(isDate(source))destination=new Date(source.getTime());else if(isRegExp(source))destination=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]),destination.lastIndex=source.lastIndex;else if(isObject(source)){var emptyObject=Object.create(Object.getPrototypeOf(source));destination=copy(source,emptyObject,stackSource,stackDest)}return destination}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;ii>i;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)("$"!==key.charAt(0)||"$"!==key.charAt(1))&&(dst[key]=src[key])}return dst||src}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)?equals(o1.getTime(),o2.getTime()):!1;if(isRegExp(o1)&&isRegExp(o2))return o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return"undefined"==typeof obj?undefined:JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function fromJson(json){return isString(json)?JSON.parse(json):json}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var key_value,key,obj={};return forEach((keyValue||"").split("&"),function(keyValue){if(keyValue&&(key_value=keyValue.replace(/\+/g,"%20").split("="),key=tryDecodeURIComponent(key_value[0]),isDefined(key))){var val=isDefined(key_value[1])?tryDecodeURIComponent(key_value[1]):!0;hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val}}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function getNgAttribute(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(element=jqLite(element),i=0;ii>i;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.attr(attr)))return attr;return null}function angularInit(element,bootstrap){var appElement,module,config={};forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement&&(config.strictDi=null!==getNgAttribute(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config))}function bootstrap(element,modules,config){isObject(config)||(config={});var defaultConfig={strictDi:!1};config=extend(defaultConfig,config);var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),void(angular.resumeBootstrap=function(extraModules){forEach(extraModules,function(module){modules.push(module)}),doBootstrap()}))}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){return angular.element(rootElement).injector().get("$$testability")}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){var originalCleanData;bindJQueryFired||(jQuery=window.jQuery,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),originalCleanData=jQuery.cleanData,jQuery.cleanData=function(elems){var events;if(skipDestroyOnNextJQueryCleanData)skipDestroyOnNextJQueryCleanData=!1;else for(var elem,i=0;null!=(elem=elems[i]);i++)events=jQuery._data(elem,"events"),events&&events.$destroy&&jQuery(elem).triggerHandler("$destroy");originalCleanData(elems)}):jqLite=JQLite,angular.element=jqLite,bindJQueryFired=!0)}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockNodes(nodes){var node=nodes[0],endNode=nodes[nodes.length-1],blockNodes=[node];do{if(node=node.nextSibling,!node)break;blockNodes.push(node)}while(node!==endNode);return jqLite(blockNodes)}function createMap(){return Object.create(null)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),animation:invokeLater("$animateProvider","register"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this
}};return configFn&&config(configFn),moduleInstance})}})}function serializeObject(obj){var seen=[];return JSON.stringify(obj,function(key,val){if(val=toJsonReplacer(key,val),isObject(val)){if(seen.indexOf(val)>=0)return"<<already seen>>";seen.push(val)}return val})}function toDebugString(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?serializeObject(obj):obj}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},getTestability:getTestability,$$minErr:minErr,$$csp:csp,reloadWithDebugInfo:reloadWithDebugInfo}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$asyncCallback:$$AsyncCallbackProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],i=wrap[0];i--;)tmp=tmp.lastChild;nodes=concat(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}function jqLiteParseHTML(html,context){context=context||document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[]}function JQLite(element){if(element instanceof JQLite)return element;var argIsString;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,jqLiteParseHTML(element)):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){if(onlyDescendants||jqLiteRemoveData(element),element.querySelectorAll)for(var descendants=element.querySelectorAll("*"),i=0,l=descendants.length;l>i;i++)jqLiteRemoveData(descendants[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle)if(type)forEach(type.split(" "),function(type){if(isDefined(fn)){var listenerFns=events[type];if(arrayRemove(listenerFns||[],fn),listenerFns&&listenerFns.length>0)return}removeEventListenerFn(element,type,handle),delete events[type]});else for(type in events)"$destroy"!==type&&removeEventListenerFn(element,type,handle),delete events[type]}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];if(expandoStore){if(name)return void delete expandoStore.data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=undefined}}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={events:{},data:{},handle:undefined}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[key]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;length>i;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType==NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;ii>i;i++)if((value=jqLite.data(element,names[i]))!==undefined)return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteDocumentLoaded(action,win){win=win||window,"complete"===win.document.readyState?win.setTimeout(action):jqLite(win).on("load",action)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function getAliasedAttrName(element,name){var nodeName=element.nodeName;return("INPUT"===nodeName||"TEXTAREA"===nodeName)&&ALIASED_ATTR[name]}function createEventHandler(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){return event.immediatePropagationStopped===!0},eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;eventFnsLength>i;i++)event.isImmediatePropagationStopped()||eventFns[i].call(element,event)}};return eventHandler.elem=element,eventHandler}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;return key="function"==objType||"object"==objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function anonFn(fn){var fnText=fn.toString().replace(STRIP_COMMENTS,""),args=fnText.match(FN_ARGS);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function annotate(fn,strictDi,name){var $inject,fnText,argDecl,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||anonFn(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject}function createInjector(modulesToLoad,strictDi){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function enforceReturnValue(name,factory){return function(){var result=instanceInjector.invoke(factory,this,undefined,name);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}function factory(name,factoryFn,enforce){return provider(name,{$get:enforce!==!1?enforceReturnValue(name,factoryFn):factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val),!1)}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;ii>i;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}if(!loadedModules.get(module)){loadedModules.put(module,!0);try{isString(module)?(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var length,i,key,args=[],$inject=annotate(fn,strictDi,serviceName);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key))}return isArray(fn)&&(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals,serviceName){var instance=Object.create((isArray(Type)?Type[Type.length-1]:Type).prototype),returnedValue=invoke(Type,instance,locals,serviceName);return isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}strictDi=strictDi===!0;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(){throw $injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(servicename){var provider=providerInjector.get(servicename+providerSuffix);return instanceInjector.invoke(provider.$get,provider,undefined,servicename)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return Array.prototype.some.call(list,function(element){return"a"===nodeName_(element)?(result=element,!0):void 0}),result}function getYOffset(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0],style=$window.getComputedStyle(elem);offset="fixed"!==style.position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=getYOffset();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(){var elm,hash=$location.hash();hash?(elm=document.getElementById(hash))?scrollTo(elm):(elm=getFirstAnchor(document.getElementsByName(hash)))?scrollTo(elm):"top"===hash&&scrollTo(null):scrollTo(null)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){(newVal!==oldVal||""!==newVal)&&jqLiteDocumentLoaded(function(){$rootScope.$evalAsync(scroll)})}),scroll}]}function $$AsyncCallbackProvider(){this.$get=["$$rAF","$timeout",function($$rAF,$timeout){return $$rAF.supported?function(fn){return $$rAF(fn)}:function(fn){return $timeout(fn,0,!1)}}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function startPoller(interval,setTimeout){!function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)}()}function cacheStateAndFireUrlChange(){cacheState(),fireUrlChange()}function cacheState(){cachedState=window.history.state,cachedState=isUndefined(cachedState)?null:cachedState,equals(cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState}function fireUrlChange(){(lastBrowserUrl!==self.url()||lastHistoryState!==cachedState)&&(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollTimeout,pollFns=[];self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn};var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),reloadLocation=null;cacheState(),lastHistoryState=cachedState,self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?(sameBase||(reloadLocation=url),replace?location.replace(url):location.href=url):(history[replace?"replaceState":"pushState"](state,"",url),cacheState(),lastHistoryState=cachedState),self}return reloadLocation||location.href.replace(/%27/g,"'")},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1,lastCachedState=null;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),lastCookies[name]===undefined&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}value===undefined?rawDocument.cookie=encodeURIComponent(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=encodeURIComponent(name)+"="+encodeURIComponent(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}if(!isUndefined(value))return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}delete data[key],size--},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){function parseIsolateBindings(scope,directiveName){var LOCAL_REGEXP=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,bindings={};return forEach(scope,function(definition,scopeName){var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition);bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName}}),bindings}var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w\-]+)(?:\:([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=makeMap("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"EA",isObject(directive.scope)&&(directive.$$isolateBindings=parseIsolateBindings(directive.scope,directive.name)),directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$document,$sce,$animate,$$sanitizeUri){function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){node.nodeType==NODE_TYPE_TEXT&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){assertArg(scope,"scope"),options=options||{};var parentBoundTranscludeFn=options.parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(namespace=detectNamespaceForChildElements(futureParentElement));var $linkNode;if($linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function detectNamespaceForChildElements(parentElement){var node=parentElement&&parentElement[0];return node&&"foreignobject"!==nodeName_(node)&&node.toString().match(/SVG/)?"svg":"html"}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;ii>i;)node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn,nodeLinkFn.elementTranscludeOnThisElement):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){var boundTranscludeFn=function(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||(transcludedScope=scope.$new(!1,containingScope),transcludedScope.$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})};return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:addDirective(directives,directiveNormalize(nodeName_(node)),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;
attr=nAttrs[j],name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=snake_case(ngAttrName.substr(6),"-"));var directiveNName=ngAttrName.replace(/(Start|End)$/,"");directiveIsMultiElement(directiveNName)&&ngAttrName===directiveNName+"Start"&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,(isNgAttr||!attrs.hasOwnProperty(nName))&&(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}if(className=node.className,isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:addTextInterpolateDirective(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType==NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(directiveName,require,$element,elementControllers){var value,match,retrievalMethod="data",optional=!1,$searchElement=$element;if(isString(require)){if(match=require.match(REQUIRE_PREFIX_REGEXP),require=require.substring(match[0].length),match[3]&&(match[1]?match[3]=null:match[1]=match[3]),"^"===match[1]?retrievalMethod="inheritedData":"^^"===match[1]&&(retrievalMethod="inheritedData",$searchElement=$element.parent()),"?"===match[2]&&(optional=!0),value=null,elementControllers&&"data"===retrievalMethod&&(value=elementControllers[require])&&(value=value.instance),value=value||$searchElement[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",require,directiveName);return value||null}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(directiveName,require,$element,elementControllers))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn,futureParentElement){var transcludeControllers;return isScope(scope)||(futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild)}var i,ii,linkFn,controller,isolateScope,elementControllers,transcludeFn,$element,attrs;if(compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):($element=jqLite(linkNode),attrs=new Attributes($element,templateAttrs)),newIsolateScopeDirective&&(isolateScope=scope.$new(!0)),boundTranscludeFn&&(transcludeFn=controllersBoundTransclude,transcludeFn.$$boundTransclude=boundTranscludeFn),controllerDirectives&&(controllers={},elementControllers={},forEach(controllerDirectives,function(directive){var controllerInstance,locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn};controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),controllerInstance=$controller(controller,locals,!0,directive.controllerAs),elementControllers[directive.name]=controllerInstance,hasElementTranscludeDirective||$element.data("$"+directive.name+"Controller",controllerInstance.instance),controllers[directive.name]=controllerInstance})),newIsolateScopeDirective){compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0);var isolateScopeController=controllers&&controllers[newIsolateScopeDirective.name],isolateBindingContext=isolateScope;isolateScopeController&&isolateScopeController.identifier&&newIsolateScopeDirective.bindToController===!0&&(isolateBindingContext=isolateScopeController.instance),forEach(isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,attrName=definition.attrName,optional=definition.optional,mode=definition.mode;switch(mode){case"@":attrs.$observe(attrName,function(value){isolateBindingContext[scopeName]=value}),attrs.$$observers[attrName].$$scope=scope,attrs[attrName]&&(isolateBindingContext[scopeName]=$interpolate(attrs[attrName])(scope));break;case"=":if(optional&&!attrs[attrName])return;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=isolateBindingContext[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],newIsolateScopeDirective.name)},lastValue=isolateBindingContext[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,isolateBindingContext[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=isolateBindingContext[scopeName]):isolateBindingContext[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0;var unwatch;unwatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),isolateScope.$on("$destroy",unwatch);break;case"&":parentGet=$parse(attrs[attrName]),isolateBindingContext[scopeName]=function(locals){return parentGet(scope,locals)}}})}for(controllers&&(forEach(controllers,function(controller){controller()}),controllers=null),i=0,ii=preLinkFns.length;ii>i;i++)linkFn=preLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)linkFn=postLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}previousCompileContext=previousCompileContext||{};for(var newScopeDirective,controllers,directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));newIsolateScopeDirective&&markDirectivesAsIsolate(templateDirectives),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.elementTranscludeOnThisElement=hasElementTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectivesAsIsolate(directives){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:!0})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)if(directive=directives[i],directive.multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=extend({},origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest($sce.getTrustedResourceUrl(templateUrl)).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectivesAsIsolate(templateDirectives),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}}linkQueue=null}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",previousDirective.name,directive.name,what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"form"==tag&&"action"==attrNormalizedName||"img"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name,allOrNothing){var interpolateFn=$interpolate(value,!0);if(interpolateFn){if("multiple"===name&&"select"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");attr[name]&&(interpolateFn=$interpolate(attr[name],!0,getTrustedContext(node,name),ALL_OR_NOTHING_ATTRS[name]||allOrNothing),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)})))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),jqLite(newNode).data(jqLite(firstElementToRemove).data()),jQuery?(skipDestroyOnNextJQueryCleanData=!0,jQuery.cleanData([firstElementToRemove])):delete jqLite.cache[firstElementToRemove[jqLite.expando]];for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}var Attributes=function(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;l>i;i++)key=keys[i],this[key]=attributesToCopy[key]}else this.$attr={};this.$$element=element};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,node=this.$$element[0],booleanKey=getBooleanAttrName(node,key),aliasedKey=getAliasedAttrName(node,key),observer=key;if(booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),"a"===nodeName&&"href"===key||"img"===nodeName&&"src"===key)this[key]=value=$$sanitizeUri(value,"src"===key);else if("img"===nodeName&&"srcset"===key){for(var result="",trimmedSrcset=trim(value),srcPattern=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,pattern=/\s/.test(trimmedSrcset)?srcPattern:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;nbrUrisWith2parts>i;i++){var innerIdx=2*i;result+=$$sanitizeUri(trim(rawUris[innerIdx]),!0),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);result+=$$sanitizeUri(trim(lastTuple[0]),!0),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),this[key]=value=result}writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){!listeners.$$inter&&attrs.hasOwnProperty(key)&&fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){jqNodes=jqLite(jqNodes);var i=jqNodes.length;if(1>=i)return jqNodes;for(;i--;){var node=jqNodes[i];node.nodeType===NODE_TYPE_COMMENT&&splice.call(jqNodes,i,1)}return jqNodes}function $ControllerProvider(){var controllers={},globals=!1,CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.allowGlobals=function(){globals=!0},this.$get=["$injector","$window",function($injector,$window){function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=later===!0,ident&&isString(ident)&&(identifier=ident),isString(expression)&&(match=expression.match(CNTRL_REG),constructor=match[1],identifier=identifier||match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||(globals?getter($window,constructor,!0):undefined),assertArgFn(expression,constructor,!0)),later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;return instance=Object.create(controllerPrototype),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),extend(function(){return $injector.invoke(expression,instance,locals,constructor),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(){$log.error.apply($log,arguments)}}]}function defaultHttpResponseTransform(data,headers){if(isString(data)){data=data.replace(JSON_PROTECTION_PREFIX,"");var contentType=headers("Content-Type");(contentType&&0===contentType.indexOf(APPLICATION_JSON)&&data.trim()||JSON_START.test(data)&&JSON_END.test(data))&&(data=fromJson(data))}return data}function parseHeaders(headers){var key,val,i,parsed=createMap();return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,fns){return isFunction(fns)?fns(data,headers):(forEach(fns,function(fn){data=fn(data,headers)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var interceptorFactories=this.interceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response);return resp.data=response.data?transformData(response.data,response.headers,config.transformResponse):response.data,isSuccess(response.status)?resp:$q.reject(resp)}function mergeHeaders(config){function execHeaders(headers){var headerContent;forEach(headers,function(headerFn,header){isFunction(headerFn)&&(headerContent=headerFn(),null!=headerContent?headers[header]=headerContent:delete headers[header])})}var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return execHeaders(reqHeaders),reqHeaders}var config={method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse},headers=mergeHeaders(requestConfig);if(!angular.isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);extend(config,requestConfig),config.headers=headers,config.method=uppercase(config.method);var serverRequest=function(config){headers=config.headers;var reqData=transformData(config.data,headersGetter(headers),config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData,headers).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)
});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData,reqHeaders){function done(status,response,headersString,statusText){function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText)}cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())}function resolvePromise(response,status,headers,statusText){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache)if(cachedResp=cache.get(url),isDefined(cachedResp)){if(isPromiseLike(cachedResp))return cachedResp.then(removePendingReq,removePendingReq),cachedResp;isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK")}else cache.put(url,promise);if(isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$browser.cookies()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType)}return promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)||(value=[value]),forEach(value,function(v){isObject(v)&&(v=isDate(v)?v.toISOString():toJson(v)),parts.push(encodeUriQuery(key)+"="+encodeUriQuery(v))}))}),parts.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+parts.join("&")),url}var defaultCache=$cacheFactory("$http"),reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function createXhr(){return new window.XMLHttpRequest}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),rawDocument.body.appendChild(script),callback}return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){timeoutId!==undefined&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=noop})}else{var xhr=createXhr();xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText)};var requestError=function(){completeRequest(callback,-1,null,null,"")};if(xhr.onerror=requestError,xhr.onabort=requestError,withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function escape(ch){return"\\\\\\"+ch}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function parseStringifyInterceptor(value){try{return value=getValue(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,exp,index=0,expressions=[],parseFns=[],textLength=text.length,concat=[],expressionPositions=[];textLength>index;){if(-1==(startIndex=text.indexOf(startSymbol,index))||-1==(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),parseFns.push($parse(exp,parseStringifyInterceptor)),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}if(trustedContext&&concat.length>1)throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text);if(!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;ii>i;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return concat.join("")},getValue=function(value){return trustedContext?$sce.getTrusted(trustedContext,value):$sce.valueOf(value)},stringify=function(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=toJson(value)}return value};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;ii>i;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener,objectEquality){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);isFunction(listener)&&listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue},objectEquality)}})}}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q","$$q",function($rootScope,$window,$q,$$q){function interval(fn,delay,count,invokeApply){var setInterval=$window.setInterval,clearInterval=$window.clearInterval,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return count=isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=setInterval(function(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"}}}}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=int(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"";var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var appUrl,prevAppUrl,rewrittenUrl;return(appUrl=beginsWith(appBase,url))!==undefined?(prevAppUrl=appUrl,rewrittenUrl=(appUrl=beginsWith(basePrefix,appUrl))!==undefined?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):(appUrl=beginsWith(appBaseNoFile,url))!==undefined?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,hashPrefix){var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url),withoutHashUrl="#"==withoutBaseUrl.charAt(0)?beginsWith(hashPrefix,withoutBaseUrl):this.$$html5?withoutBaseUrl:"";if(!isString(withoutHashUrl))throw $locationMinErr("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',url,hashPrefix);parseAppUrl(withoutHashUrl,this),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url){return stripHash(appBase)==stripHash(url)?(this.$$parse(url),!0):!1}}function LocationHashbangInHtml5Url(appBase,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments);var appBaseNoFile=stripFile(appBase);this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),isBoolean(mode.rewriteLinks)&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function($rootScope,$browser,$sniffer,$rootElement){function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;$location=new LocationMode(appBase,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(html5Mode.rewriteLinks&&!event.ctrlKey&&!event.metaKey&&2!=event.which){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),window.angular["ff-684208-preventDefault"]=!0))}}),$location.absUrl()!=initialUrl&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){$rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),$rootScope.$$phase||$rootScope.$digest()}),$rootScope.$watch(function(){var oldUrl=$browser.url(),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=oldUrl!==$location.absUrl()||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))})),$location.$$replace=!1}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function isConstant(exp){return exp.constant}function setter(obj,path,setValue,fullExp){ensureSafeObject(obj,fullExp);for(var key,element=path.split("."),i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=ensureSafeObject(obj[key],fullExp);propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj}return key=ensureSafeMemberName(element.shift(),fullExp),ensureSafeObject(obj[key],fullExp),obj[key]=setValue,setValue}function isPossiblyDangerousMemberName(name){return"constructor"==name}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp,expensiveChecks){ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp);var eso=function(o){return ensureSafeObject(o,fullExp)},eso0=expensiveChecks||isPossiblyDangerousMemberName(key0)?eso:identity,eso1=expensiveChecks||isPossiblyDangerousMemberName(key1)?eso:identity,eso2=expensiveChecks||isPossiblyDangerousMemberName(key2)?eso:identity,eso3=expensiveChecks||isPossiblyDangerousMemberName(key3)?eso:identity,eso4=expensiveChecks||isPossiblyDangerousMemberName(key4)?eso:identity;return function(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=eso0(pathVal[key0]),key1?null==pathVal?undefined:(pathVal=eso1(pathVal[key1]),key2?null==pathVal?undefined:(pathVal=eso2(pathVal[key2]),key3?null==pathVal?undefined:(pathVal=eso3(pathVal[key3]),key4?null==pathVal?undefined:pathVal=eso4(pathVal[key4]):pathVal):pathVal):pathVal):pathVal)}}function getterFnWithEnsureSafeObject(fn,fullExpression){return function(s,l){return fn(s,l,ensureSafeObject,fullExpression)}}function getterFn(path,options,fullExp){var expensiveChecks=options.expensiveChecks,getterFnCache=expensiveChecks?getterFnCacheExpensive:getterFnCacheDefault,fn=getterFnCache[path];if(fn)return fn;var pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(options.csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp,expensiveChecks):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp,expensiveChecks)(scope,locals),locals=undefined,scope=val;while(pathKeysLength>i);return val};else{var code="";expensiveChecks&&(code+="s = eso(s, fe);\nl = eso(l, fe);\n");var needsEnsureSafeObject=expensiveChecks;forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp);var lookupJs=(index?"s":'((l&&l.hasOwnProperty("'+key+'"))?l:s)')+"."+key;(expensiveChecks||isPossiblyDangerousMemberName(key))&&(lookupJs="eso("+lookupJs+", fe)",needsEnsureSafeObject=!0),code+="if(s == null) return undefined;\ns="+lookupJs+";\n"}),code+="return s;";var evaledFnGetter=new Function("s","l","eso","fe",code);evaledFnGetter.toString=valueFn(code),needsEnsureSafeObject&&(evaledFnGetter=getterFnWithEnsureSafeObject(evaledFnGetter,fullExp)),fn=evaledFnGetter}return fn.sharedGetter=!0,fn.assign=function(self,value){return setter(self,path,value,path)},getterFnCache[path]=fn,fn}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var cacheDefault=createMap(),cacheExpensive=createMap();this.$get=["$filter","$sniffer",function($filter,$sniffer){function wrapSharedExpression(exp){var wrapped=exp;return exp.sharedGetter&&(wrapped=function(self,locals){return exp(self,locals)},wrapped.literal=exp.literal,wrapped.constant=exp.constant,wrapped.assign=exp.assign),wrapped}function collectExpressionInputs(inputs,list){for(var i=0,ii=inputs.length;ii>i;i++){var input=inputs[i];input.constant||(input.inputs?collectExpressionInputs(input.inputs,list):-1===list.indexOf(input)&&list.push(input))}return list}function expressionInputDirtyCheck(newValue,oldValueOfValue){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:"object"==typeof newValue&&(newValue=getValueOf(newValue),"object"==typeof newValue)?!1:newValue===oldValueOfValue||newValue!==newValue&&oldValueOfValue!==oldValueOfValue}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression){var lastResult,inputExpressions=parsedExpression.$$inputs||(parsedExpression.$$inputs=collectExpressionInputs(parsedExpression.inputs,[]));if(1===inputExpressions.length){var oldInputValue=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValue)||(lastResult=parsedExpression(scope),oldInputValue=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality)}for(var oldInputValueOfValues=[],i=0,ii=inputExpressions.length;ii>i;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;ii>i;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i])))&&(oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope)),lastResult},listener,objectEquality)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.apply(this,arguments),isDefined(value)&&scope.$$postDigest(function(){isDefined(lastValue)&&unwatch()})},objectEquality)}function oneTimeLiteralWatchDelegate(scope,listener,objectEquality,parsedExpression){function isAllDefined(value){var allDefined=!0;return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.call(this,value,old,scope),isAllDefined(value)&&scope.$$postDigest(function(){isAllDefined(lastValue)&&unwatch()})},objectEquality)}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(){isFunction(listener)&&listener.apply(this,arguments),unwatch()},objectEquality)}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;var watchDelegate=parsedExpression.$$watchDelegate,regularWatch=watchDelegate!==oneTimeLiteralWatchDelegate&&watchDelegate!==oneTimeWatchDelegate,fn=regularWatch?function(scope,locals){var value=parsedExpression(scope,locals);return interceptorFn(value,scope,locals)}:function(scope,locals){var value=parsedExpression(scope,locals),result=interceptorFn(value,scope,locals);return isDefined(value)?result:value};return parsedExpression.$$watchDelegate&&parsedExpression.$$watchDelegate!==inputsWatchDelegate?fn.$$watchDelegate=parsedExpression.$$watchDelegate:interceptorFn.$stateful||(fn.$$watchDelegate=inputsWatchDelegate,fn.inputs=[parsedExpression]),fn}var $parseOptions={csp:$sniffer.csp,expensiveChecks:!1},$parseOptionsExpensive={csp:$sniffer.csp,expensiveChecks:!0};return function(exp,interceptorFn,expensiveChecks){var parsedExpression,oneTime,cacheKey;switch(typeof exp){case"string":cacheKey=exp=exp.trim();var cache=expensiveChecks?cacheExpensive:cacheDefault;if(parsedExpression=cache[cacheKey],!parsedExpression){":"===exp.charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2));var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);parsedExpression=parser.parse(exp),parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:oneTime?(parsedExpression=wrapSharedExpression(parsedExpression),parsedExpression.$$watchDelegate=parsedExpression.literal?oneTimeLiteralWatchDelegate:oneTimeWatchDelegate):parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),cache[cacheKey]=parsedExpression}return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return addInterceptor(noop,interceptorFn)}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function $$QProvider(){this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function callOnce(self,resolveFn,rejectFn){function wrap(fn){return function(value){called||(called=!0,fn.call(self,value))}}var called=!1;return[wrap(resolveFn),wrap(rejectFn)]}function Promise(){this.$$state={status:0}}function simpleBind(context,fn){return function(value){fn.call(context,value)}}function processQueue(state){var fn,promise,pending;pending=state.pending,state.processScheduled=!1,state.pending=undefined;for(var i=0,ii=pending.length;ii>i;++i){promise=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?promise.resolve(fn(state.value)):1===state.status?promise.resolve(state.value):promise.reject(state.value)}catch(e){promise.reject(e),exceptionHandler(e)}}}function scheduleProcessQueue(state){!state.processScheduled&&state.pending&&(state.processScheduled=!0,nextTick(function(){processQueue(state)}))}function Deferred(){this.promise=new Promise,this.resolve=simpleBind(this,this.resolve),this.reject=simpleBind(this,this.reject),this.notify=simpleBind(this,this.notify)}function all(promises){var deferred=new Deferred,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise
}var $qMinErr=minErr("$q",TypeError),defer=function(){return new Deferred};Promise.prototype={then:function(onFulfilled,onRejected,progressBack){var result=new Deferred;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback,progressBack){return this.then(function(value){return handleCallback(value,!0,callback)},function(error){return handleCallback(error,!1,callback)},progressBack)}},Deferred.prototype={resolve:function(val){this.promise.$$state.status||(val===this.promise?this.$$reject($qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):this.$$resolve(val))},$$resolve:function(val){var then,fns;fns=callOnce(this,this.$$resolve,this.$$reject);try{(isObject(val)||isFunction(val))&&(then=val&&val.then),isFunction(then)?(this.promise.$$state.status=-1,then.call(val,fns[0],fns[1],this.notify)):(this.promise.$$state.value=val,this.promise.$$state.status=1,scheduleProcessQueue(this.promise.$$state))}catch(e){fns[1](e),exceptionHandler(e)}},reject:function(reason){this.promise.$$state.status||this.$$reject(reason)},$$reject:function(reason){this.promise.$$state.value=reason,this.promise.$$state.status=2,scheduleProcessQueue(this.promise.$$state)},notify:function(progress){var callbacks=this.promise.$$state.pending;this.promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;ii>i;i++){result=callbacks[i][0],callback=callbacks[i][3];try{result.notify(isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}};var reject=function(reason){var result=new Deferred;return result.reject(reason),result.promise},makePromise=function(value,resolved){var result=new Deferred;return resolved?result.resolve(value):result.reject(value),result.promise},handleCallback=function(value,isResolved,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)},when=function(value,callback,errback,progressBack){var result=new Deferred;return result.resolve(value),result.promise.then(callback,errback,progressBack)},$Q=function Q(resolver){function resolveFn(value){deferred.resolve(value)}function rejectFn(reason){deferred.reject(reason)}if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);if(!(this instanceof Q))return new Q(resolver);var deferred=new Deferred;return resolver(resolveFn,rejectFn),deferred.promise};return $Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.all=all,$Q}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame||$window.mozRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.mozCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings=null}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}function scheduleApplyAsync(){null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)}))}Scope.prototype={constructor:Scope,$new:function(isolate,parent){function destroyChild(){child.$$destroyed=!0}var child;return parent=parent||this,isolate?(child=new Scope,child.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=nextUid(),this.$$ChildScope=null},this.$$ChildScope.prototype=this),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!=this)&&child.$on("$destroy",destroyChild),child},$watch:function(watchExp,listener,objectEquality){var get=$parse(watchExp);if(get.$$watchDelegate)return get.$$watchDelegate(this,listener,objectEquality,get);var scope=this,array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};return lastDirtyWatch=null,isFunction(listener)||(watcher.fn=noop),array||(array=scope.$$watchers=[]),array.unshift(watcher),function(){arrayRemove(array,watcher),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){function watchGroupAction(){changeReactionScheduled=!1,firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}return 1===watchExpressions.length?this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)}):(forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value,oldValue){newValues[i]=value,oldValues[i]=oldValue,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()})},$watchCollection:function(obj,listener){function $watchCollectionInterceptor(_value){newValue=_value;var newLength,key,bothNaN,newItem,oldItem;if(!isUndefined(newValue)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)oldItem=oldValue[i],newItem=newValue[i],bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)newValue.hasOwnProperty(key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?(bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[key]=newItem)):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)newValue.hasOwnProperty(key)||(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}$watchCollectionInterceptor.$stateful=!0;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch(changeDetector,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,length,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if((value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;if(this.$broadcast("$destroy"),this.$$destroyed=!0,this!==$rootScope){for(var eventName in this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop},this.$$listeners={},this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()}),asyncQueue.push({scope:this,expression:expr})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){function $applyAsyncExpression(){scope.$eval(expr)}var scope=this;expr&&applyAsyncQueue.push($applyAsyncExpression),scheduleApplyAsync()},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);-1!==indexOfListener&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event.currentScope=null,event;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name){var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!target.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[];return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||trustedValue===undefined||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||maybeTrusted===undefined||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&8>msie)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=int((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},vendorRegex=/^(Moz|webkit|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(document.body.style.webkitTransition),animations=isString(document.body.style.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hasEvent:function(event){if("input"==event&&9==msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android}}]}function $TemplateRequestProvider(){this.$get=["$templateCache","$http","$q",function($templateCache,$http,$q){function handleRequestFn(tpl,ignoreRequestError){function handleError(){if(self.totalPendingRequests--,!ignoreRequestError)throw $compileMinErr("tpload","Failed to load template: {0}",tpl);return $q.reject()}var self=handleRequestFn;self.totalPendingRequests++;var transformResponse=$http.defaults&&$http.defaults.transformResponse;if(isArray(transformResponse)){var original=transformResponse;transformResponse=[];for(var i=0;i<original.length;++i){var transformer=original[i];transformer!==defaultHttpResponseTransform&&transformResponse.push(transformer)}}else transformResponse===defaultHttpResponseTransform&&(transformResponse=null);var httpOptions={cache:$templateCache,transformResponse:transformResponse};return $http.get(tpl,httpOptions).then(function(response){var html=response.data;return self.totalPendingRequests--,$templateCache.put(tpl,html),html},handleError)}return handleRequestFn.totalPendingRequests=0,handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={};return testability.findBindings=function(element,expression,opt_exactMatch){var bindings=element.getElementsByClassName("ng-binding"),matches=[];return forEach(bindings,function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){if(opt_exactMatch){var matcher=new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)");matcher.test(bindingName)&&matches.push(binding)}else-1!=bindingName.indexOf(expression)&&matches.push(binding)})}),matches},testability.findModels=function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var attributeEquals=opt_exactMatch?"=":"*=",selector="["+prefixes[p]+"model"+attributeEquals+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},testability.getLocation=function(){return $location.url()},testability.setLocation=function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},testability.whenStable=function(callback){$browser.notifyWhenNoOutstandingRequests(callback)},testability}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var timeoutId,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArray(array))return array;var comparatorType=typeof comparator,predicates=[];predicates.check=function(value,index){for(var j=0;j<predicates.length;j++)if(!predicates[j](value,index))return!1;return!0},"function"!==comparatorType&&(comparator="boolean"===comparatorType&&comparator?function(obj,text){return angular.equals(obj,text)}:function(obj,text){if(obj&&text&&"object"==typeof obj&&"object"==typeof text){for(var objKey in obj)if("$"!==objKey.charAt(0)&&hasOwnProperty.call(obj,objKey)&&comparator(obj[objKey],text[objKey]))return!0;return!1}return text=(""+text).toLowerCase(),(""+obj).toLowerCase().indexOf(text)>-1});var search=function(obj,text){if("string"==typeof text&&"!"===text.charAt(0))return!search(obj,text.substr(1));switch(typeof obj){case"boolean":case"number":case"string":return comparator(obj,text);case"object":switch(typeof text){case"object":return comparator(obj,text);default:for(var objKey in obj)if("$"!==objKey.charAt(0)&&search(obj[objKey],text))return!0}return!1;case"array":for(var i=0;i<obj.length;i++)if(search(obj[i],text))return!0;return!1;default:return!1}};switch(typeof expression){case"boolean":case"number":case"string":expression={$:expression};case"object":for(var key in expression)!function(path){"undefined"!=typeof expression[path]&&predicates.push(function(value){return search("$"==path?value:value&&value[path],expression[path])})}(key);break;case"function":predicates.push(expression);break;default:return array}for(var filtered=[],j=0;j<array.length;j++){var value=array[j];predicates.check(value,j)&&filtered.push(value)}return filtered}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac),null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(!isFinite(number)||isObject(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?(numStr="0",number=0):(formatedText=numStr,hasExponent=!0)}if(hasExponent)fractionSize>0&&number>-1&&1>number&&(formatedText=number.toFixed(fractionSize));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac)),number=+(Math.round(+(number.toString()+"e"+fractionSize)).toString()+"e"+-fractionSize),0===number&&(isNegative=!1);var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var i,pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group)for(pos=whole.length-lgroup,i=0;pos>i;i++)(pos-i)%group===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(i=pos;i<whole.length;i++)(whole.length-i)%lgroup===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return parts.push(isNegative?pattern.negPre:pattern.posPre,formatedText,isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(4>=dayOfWeekOnFirst?5:12)-dayOfWeekOnFirst)}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay()))}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear()),thisThurs=getThursdayThisWeek(date),diff=+thisThurs-+firstThurs,result=1+Math.round(diff/6048e5);return padNumber(result,size)}}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),dateSetter.call(date,int(match[1]),int(match[2])-1,int(match[3]));var h=int(match[4]||0)-tzHour,m=int(match[5]||0)-tzMin,s=int(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;
return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);return timezone&&"UTC"===timezone&&(date=new Date(date.getTime()),date.setMinutes(date.getMinutes()+date.getTimezoneOffset())),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object){return toJson(object,!0)}}function limitToFilter(){return function(input,limit){if(isNumber(input)&&(input=input.toString()),!isArray(input)&&!isString(input))return input;if(limit=1/0===Math.abs(Number(limit))?Number(limit):int(limit),isString(input))return limit?limit>=0?input.slice(0,limit):input.slice(limit,input.length):"";var i,n,out=[];for(limit>input.length?limit=input.length:limit<-input.length&&(limit=-input.length),limit>0?(i=0,n=limit):(i=input.length+limit,n=input.length);n>i;i++)out.push(input[i]);return out}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;i<sortPredicate.length;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return descending?function(a,b){return comp(b,a)}:comp}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1==t2?(isDate(v1)&&isDate(v2)&&(v1=v1.valueOf(),v2=v2.valueOf()),"string"==t1&&(v1=v1.toLowerCase(),v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}return isArrayLike(array)?(sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],0===sortPredicate.length&&(sortPredicate=["+"]),sortPredicate=sortPredicate.map(function(predicate){var descending=!1,get=predicate||identity;if(isString(predicate)){if(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),""===predicate)return reverseComparator(function(a,b){return compare(a,b)},descending);if(get=$parse(predicate),get.constant){var key=get();return reverseComparator(function(a,b){return compare(a[key],b[key])},descending)}}return reverseComparator(function(a,b){return compare(get(a),get(b))},descending)}),slice.call(array).sort(reverseComparator(comparator,reverseOrder))):array}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function nullFormRenameControl(control,name){control.$name=name}function FormController(element,attrs,$scope,$animate,$interpolate){var form=this,controls=[],parentForm=form.$$parentForm=element.parent().controller("form")||nullFormCtrl;form.$error={},form.$$success={},form.$pending=undefined,form.$name=$interpolate(attrs.name||attrs.ngForm||"")($scope),form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,form.$submitted=!1,parentForm.$addControl(form),form.$rollbackViewValue=function(){forEach(controls,function(control){control.$rollbackViewValue()})},form.$commitViewValue=function(){forEach(controls,function(control){control.$commitViewValue()})},form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control)},form.$$renameControl=function(control,newName){var oldName=control.$name;form[oldName]===control&&delete form[oldName],form[newName]=control,control.$name=newName},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(form.$pending,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$error,function(value,name){form.$setValidity(name,null,control)}),arrayRemove(controls,control)},addSetValidityMethod({ctrl:this,$element:element,set:function(object,property,control){var list=object[property];if(list){var index=list.indexOf(control);-1===index&&list.push(control)}else object[property]=[control]},unset:function(object,property,control){var list=object[property];list&&(arrayRemove(list,control),0===list.length&&delete object[property])},parentForm:parentForm,$animate:$animate}),form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()},form.$setPristine=function(){$animate.setClass(element,PRISTINE_CLASS,DIRTY_CLASS+" "+SUBMITTED_CLASS),form.$dirty=!1,form.$pristine=!0,form.$submitted=!1,forEach(controls,function(control){control.$setPristine()})},form.$setUntouched=function(){forEach(controls,function(control){control.$setUntouched()})},form.$setSubmitted=function(){$animate.addClass(element,SUBMITTED_CLASS),form.$submitted=!0,parentForm.$setSubmitted()}}function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var placeholder=element[0].placeholder,noevent={},type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(ev){if(!composing){var value=element.val(),event=ev&&ev.type;if(msie&&"input"===(ev||noevent).type&&element[0].placeholder!==placeholder)return void(placeholder=element[0].placeholder);"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(ev){timeout||(timeout=$browser.defer(function(){listener(ev),timeout=null}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener(event)}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),ctrl.$render=function(){element.val(ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)}}function weekParser(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return 0/0}function createDateParser(regexp,mapping){return function(iso,date){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'==iso.charAt(0)&&'"'==iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso))return parts.shift(),map=date?{yyyy:date.getFullYear(),MM:date.getMonth()+1,dd:date.getDate(),HH:date.getHours(),mm:date.getMinutes(),ss:date.getSeconds(),sss:date.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)}),new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0)}return 0/0}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter){function isValidDate(value){return value&&!(value.getTime&&value.getTime()!==value.getTime())}function parseObservedDateValue(val){return isDefined(val)?isDate(val)?val:parseDate(val):undefined}badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var previousDate,timezone=ctrl&&ctrl.$options&&ctrl.$options.timezone;if(ctrl.$$parserName=type,ctrl.$parsers.push(function(value){if(ctrl.$isEmpty(value))return null;if(regexp.test(value)){var parsedDate=parseDate(value,previousDate);return"UTC"===timezone&&parsedDate.setMinutes(parsedDate.getMinutes()-parsedDate.getTimezoneOffset()),parsedDate}return undefined}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw $ngModelMinErr("datefmt","Expected `{0}` to be a date",value);if(isValidDate(value)){if(previousDate=value,previousDate&&"UTC"===timezone){var timezoneOffset=6e4*previousDate.getTimezoneOffset();previousDate=new Date(previousDate.getTime()+timezoneOffset)}return $filter("date")(value,format,timezone)}return previousDate=null,""}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(minVal)||parseDate(value)>=minVal},attr.$observe("min",function(val){minVal=parseObservedDateValue(val),ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(maxVal)||parseDate(value)<=maxVal},attr.$observe("max",function(val){maxVal=parseObservedDateValue(val),ctrl.$validate()})}}}function badInputChecker(scope,element,attr,ctrl){var node=element[0],nativeValidation=ctrl.$$hasNativeValidators=isObject(node.validity);nativeValidation&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};return validity.badInput&&!validity.typeMismatch?undefined:value})}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$$parserName="number",ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):undefined}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw $ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value}),attr.min||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return ctrl.$isEmpty(value)||isUndefined(minVal)||value>=minVal},attr.$observe("min",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val,10)),minVal=isNumber(val)&&!isNaN(val)?val:undefined,ctrl.$validate()})}if(attr.max||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return ctrl.$isEmpty(value)||isUndefined(maxVal)||maxVal>=value},attr.$observe("max",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val,10)),maxVal=isNumber(val)&&!isNaN(val)?val:undefined,ctrl.$validate()})}}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="url",ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="email",ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid());var listener=function(ev){element[0].checked&&ctrl.$setViewValue(attr.value,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(parseFn=$parse(expression),!parseFn.constant)throw minErr("ngModel")("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}function checkboxInputType(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1),listener=function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value===!1},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function addSetValidityMethod(context){function setValidity(validationErrorKey,state,options){state===undefined?createAndSet("$pending",validationErrorKey,options):unsetAndCleanup("$pending",validationErrorKey,options),isBoolean(state)?state?(unset(ctrl.$error,validationErrorKey,options),set(ctrl.$$success,validationErrorKey,options)):(set(ctrl.$error,validationErrorKey,options),unset(ctrl.$$success,validationErrorKey,options)):(unset(ctrl.$error,validationErrorKey,options),unset(ctrl.$$success,validationErrorKey,options)),ctrl.$pending?(cachedToggleClass(PENDING_CLASS,!0),ctrl.$valid=ctrl.$invalid=undefined,toggleValidationCss("",null)):(cachedToggleClass(PENDING_CLASS,!1),ctrl.$valid=isObjectEmpty(ctrl.$error),ctrl.$invalid=!ctrl.$valid,toggleValidationCss("",ctrl.$valid));var combinedState;combinedState=ctrl.$pending&&ctrl.$pending[validationErrorKey]?undefined:ctrl.$error[validationErrorKey]?!1:ctrl.$$success[validationErrorKey]?!0:null,toggleValidationCss(validationErrorKey,combinedState),parentForm.$setValidity(validationErrorKey,combinedState,ctrl)}function createAndSet(name,value,options){ctrl[name]||(ctrl[name]={}),set(ctrl[name],value,options)}function unsetAndCleanup(name,value,options){ctrl[name]&&unset(ctrl[name],value,options),isObjectEmpty(ctrl[name])&&(ctrl[name]=undefined)}function cachedToggleClass(className,switchValue){switchValue&&!classCache[className]?($animate.addClass($element,className),classCache[className]=!0):!switchValue&&classCache[className]&&($animate.removeClass($element,className),classCache[className]=!1)}function toggleValidationCss(validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(VALID_CLASS+validationErrorKey,isValid===!0),cachedToggleClass(INVALID_CLASS+validationErrorKey,isValid===!1)}var ctrl=context.ctrl,$element=context.$element,classCache={},set=context.set,unset=context.unset,parentForm=context.parentForm,$animate=context.$animate;classCache[INVALID_CLASS]=!(classCache[VALID_CLASS]=$element.hasClass(VALID_CLASS)),ctrl.$setValidity=setValidity}function isObjectEmpty(obj){if(obj)for(var prop in obj)return!1;return!0}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){if(isArray(classVal))return classVal;if(isString(classVal))return classVal.split(" ");if(isObject(classVal)){var classes=[];return forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes}return classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||{},classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toAdd=digestClassCounts(toAdd,1),toRemove=digestClassCounts(toRemove,-1),toAdd&&toAdd.length&&$animate.addClass(element,toAdd),toRemove&&toRemove.length&&$animate.removeClass(element,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}var REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;msie=document.documentMode,noop.$inject=[],identity.$inject=[];var skipDestroyOnNextJQueryCleanData,isArray=Array.isArray,trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},csp=function(){if(isDefined(csp.isActive_))return csp.isActive_;var active=!(!document.querySelector("[ng-csp]")&&!document.querySelector("[data-ng-csp]"));if(!active)try{new Function("")}catch(e){active=!0}return csp.isActive_=active},ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"],SNAKE_CASE_REGEXP=/[A-Z]/g,bindJQueryFired=!1,NODE_TYPE_ELEMENT=1,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11,version={full:"1.3.5-build.3630+sha.30694c8",major:1,minor:3,dot:5,codeName:"snapshot"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=function(element,type,fn){element.addEventListener(type,fn,!1)},removeEventListenerFn=function(element,type,fn){element.removeEventListener(type,fn,!1)};JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};forEach({data:jqLiteData,removeData:jqLiteRemoveData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){return name=camelCase(name),isDefined(value)?void(element.style[name]=value):element.style[name]},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}return getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){return isUndefined(value)?element.innerHTML:(jqLiteDealoc(element,!0),void(element.innerHTML=value))},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)===undefined){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=value===undefined?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function jqLiteOn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=createEventHandler(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length;i--;){type=types[i];var eventFns=events[type];eventFns||(events[type]=[],"mouseenter"===type||"mouseleave"===type?jqLiteOn(element,MOUSE_EVENT_MAP[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!target.contains(related))&&handle(event,type)}):"$destroy"!==type&&addEventListenerFn(element,type,handle),eventFns=events[type]),eventFns.push(fn)}}},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT){node=new JQLite(node);for(var i=0,ii=node.length;ii>i;i++){var child=node[i];element.appendChild(child)}}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode).eq(0).clone()[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;newElement=new JQLite(newElement);for(var i=0,ii=newElement.length;ii>i;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;ii>i;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");createInjector.$$annotate=annotate;var $animateMinErr=minErr("$animate"),$AnimateProvider=["$provide",function($provide){this.$$selectors={},this.register=function(name,factory){var key=name+"-animation";if(name&&"."!=name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);this.$$selectors[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){return 1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null),this.$$classNameFilter},this.$get=["$$q","$$asyncCallback","$rootScope",function($$q,$$asyncCallback,$rootScope){function runAnimationPostDigest(fn){var cancelFn,defer=$$q.defer();return defer.promise.$$cancelFn=function(){cancelFn&&cancelFn()},$rootScope.$$postDigest(function(){cancelFn=fn(function(){defer.resolve()})}),defer.promise}function resolveElementClasses(element,classes){var toAdd=[],toRemove=[],hasClasses=createMap();return forEach((element.attr("class")||"").split(/\s+/),function(className){hasClasses[className]=!0}),forEach(classes,function(status,className){var hasClass=hasClasses[className];status===!1&&hasClass?toRemove.push(className):status!==!0||hasClass||toAdd.push(className)}),toAdd.length+toRemove.length>0&&[toAdd.length?toAdd:null,toRemove.length?toRemove:null]}function cachedClassManipulation(cache,classes,op){for(var i=0,ii=classes.length;ii>i;++i){var className=classes[i];cache[className]=op}}function asyncPromise(){return currentDefer||(currentDefer=$$q.defer(),$$asyncCallback(function(){currentDefer.resolve(),currentDefer=null})),currentDefer.promise}function applyStyles(element,options){if(angular.isObject(options)){var styles=extend(options.from||{},options.to||{});element.css(styles)}}var currentDefer;return{animate:function(element,from,to){return applyStyles(element,{from:from,to:to}),asyncPromise()},enter:function(element,parent,after,options){return applyStyles(element,options),after?after.after(element):parent.prepend(element),asyncPromise()},leave:function(element){return element.remove(),asyncPromise()},move:function(element,parent,after,options){return this.enter(element,parent,after,options)},addClass:function(element,className,options){return this.setClass(element,className,[],options)},$$addClassImmediately:function(element,className,options){return element=jqLite(element),className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteAddClass(element,className)}),applyStyles(element,options),asyncPromise()},removeClass:function(element,className,options){return this.setClass(element,[],className,options)},$$removeClassImmediately:function(element,className,options){return element=jqLite(element),className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteRemoveClass(element,className)}),applyStyles(element,options),asyncPromise()},setClass:function(element,add,remove,options){var self=this,STORAGE_KEY="$$animateClasses",createdCache=!1;element=jqLite(element);var cache=element.data(STORAGE_KEY);cache?options&&cache.options&&(cache.options=angular.extend(cache.options||{},options)):(cache={classes:{},options:options},createdCache=!0);var classes=cache.classes;return add=isArray(add)?add:add.split(" "),remove=isArray(remove)?remove:remove.split(" "),cachedClassManipulation(classes,add,!0),cachedClassManipulation(classes,remove,!1),createdCache&&(cache.promise=runAnimationPostDigest(function(done){var cache=element.data(STORAGE_KEY);if(element.removeData(STORAGE_KEY),cache){var classes=resolveElementClasses(element,cache.classes);classes&&self.$$setClassImmediately(element,classes[0],classes[1],cache.options)}done()}),element.data(STORAGE_KEY,cache)),cache.promise},$$setClassImmediately:function(element,add,remove,options){return add&&this.$$addClassImmediately(element,add),remove&&this.$$removeClassImmediately(element,remove),applyStyles(element,options),asyncPromise()
},enabled:noop,cancel:noop}}]}],$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^((?:x|data)[\:\-_])/i,APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\s*(\[|\{[^\{])/,JSON_END=/[\}\]]\s*$/,JSON_PROTECTION_PREFIX=/^\)\]\}',?\n/,$interpolateMinErr=minErr("$interpolate"),PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),locationPrototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");search=copy(search,{}),forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this}});var $parseMinErr=minErr("$parse"),CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,CONSTANTS=createMap();forEach({"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:function(){}},function(constantGetter,name){constantGetter.constant=constantGetter.literal=constantGetter.sharedGetter=!0,CONSTANTS[name]=constantGetter}),CONSTANTS["this"]=function(self){return self},CONSTANTS["this"].sharedGetter=!0;var OPERATORS=extend(createMap(),{"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"!":function(self,locals,a){return!a(self,locals)},"=":!0,"|":!0}),ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(ch))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return-1!==chars.indexOf(ch)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||""===ch||" "===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){for(var start=this.index;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(!this.isIdent(ch)&&!this.isNumber(ch))break;this.index++}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,constant:!0,value:string});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options};Parser.ZERO=extend(function(){return 0},{sharedGetter:!0,constant:!0}),Parser.prototype={constructor:Parser,parse:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value},primary:function(){var primary;this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());for(var next,context;next=this.expect("(","[",".");)"("===next.text?(primary=this.functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=this.objectIndex(primary)):"."===next.text?(context=primary,primary=this.fieldAccess(primary)):this.throwError("IMPOSSIBLE");return primary},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},unaryFn:function(op,right){var fn=OPERATORS[op];return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant,inputs:[right]})},binaryFn:function(left,op,right,isBranching){var fn=OPERATORS[op];return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant,inputs:!isBranching&&[left,right]})},identifier:function(){for(var id=this.consume().text;this.peek(".")&&this.peekAhead(1).identifier&&!this.peekAhead(2,"(");)id+=this.consume().text+this.consume().text;return CONSTANTS[id]||getterFn(id,this.options,this.text)},constant:function(){var value=this.consume().value;return extend(function(){return value},{constant:!0,literal:!0})},statements:function(){for(var statements=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&statements.push(this.filterChain()),!this.expect(";"))return 1===statements.length?statements[0]:function(self,locals){for(var value,i=0,ii=statements.length;ii>i;i++)value=statements[i](self,locals);return value}},filterChain:function(){for(var token,left=this.expression();token=this.expect("|");)left=this.filter(left);return left},filter:function(inputFn){var argsFn,args,fn=this.$filter(this.consume().text);if(this.peek(":"))for(argsFn=[],args=[];this.expect(":");)argsFn.push(this.expression());var inputs=[inputFn].concat(argsFn||[]);return extend(function(self,locals){var input=inputFn(self,locals);if(args){args[0]=input;for(var i=argsFn.length;i--;)args[i+1]=argsFn[i](self,locals);return fn.apply(undefined,args)}return fn(input)},{constant:!fn.$stateful&&inputs.every(isConstant),inputs:!fn.$stateful&&inputs})},expression:function(){return this.assignment()},assignment:function(){var right,token,left=this.ternary();return(token=this.expect("="))?(left.assign||this.throwError("implies assignment but ["+this.text.substring(0,token.index)+"] can not be assigned to",token),right=this.ternary(),extend(function(scope,locals){return left.assign(scope,right(scope,locals),locals)},{inputs:[left,right]})):left},ternary:function(){var middle,token,left=this.logicalOR();if((token=this.expect("?"))&&(middle=this.assignment(),this.consume(":"))){var right=this.assignment();return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})}return left},logicalOR:function(){for(var token,left=this.logicalAND();token=this.expect("||");)left=this.binaryFn(left,token.text,this.logicalAND(),!0);return left},logicalAND:function(){var token,left=this.equality();return(token=this.expect("&&"))&&(left=this.binaryFn(left,token.text,this.logicalAND(),!0)),left},equality:function(){var token,left=this.relational();return(token=this.expect("==","!=","===","!=="))&&(left=this.binaryFn(left,token.text,this.equality())),left},relational:function(){var token,left=this.additive();return(token=this.expect("<",">","<=",">="))&&(left=this.binaryFn(left,token.text,this.relational())),left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left=this.binaryFn(left,token.text,this.multiplicative());return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left=this.binaryFn(left,token.text,this.unary());return left},unary:function(){var token;return this.expect("+")?this.primary():(token=this.expect("-"))?this.binaryFn(Parser.ZERO,token.text,this.unary()):(token=this.expect("!"))?this.unaryFn(token.text,this.unary()):this.primary()},fieldAccess:function(object){var expression=this.text,field=this.consume().text,getter=getterFn(field,this.options,expression);return extend(function(scope,locals,self){return getter(self||object(scope,locals))},{assign:function(scope,value,locals){var o=object(scope,locals);return o||object.assign(scope,o={}),setter(o,field,value,expression)}})},objectIndex:function(obj){var expression=this.text,indexFn=this.expression();return this.consume("]"),extend(function(self,locals){var v,o=obj(self,locals),i=indexFn(self,locals);return ensureSafeMemberName(i,expression),o?v=ensureSafeObject(o[i],expression):undefined},{assign:function(self,value,locals){var key=ensureSafeMemberName(indexFn(self,locals),expression),o=ensureSafeObject(obj(self,locals),expression);return o||obj.assign(self,o={}),o[key]=value}})},functionCall:function(fnGetter,contextGetter){var argsFn=[];if(")"!==this.peekToken().text)do argsFn.push(this.expression());while(this.expect(","));this.consume(")");var expressionText=this.text,args=argsFn.length?[]:null;return function(scope,locals){var context=contextGetter?contextGetter(scope,locals):scope,fn=fnGetter(scope,locals,context)||noop;if(args)for(var i=argsFn.length;i--;)args[i]=ensureSafeObject(argsFn[i](scope,locals),expressionText);ensureSafeObject(context,expressionText),ensureSafeFunction(fn,expressionText);var v=fn.apply?fn.apply(context,args):fn(args[0],args[1],args[2],args[3],args[4]);return ensureSafeObject(v,expressionText)}},arrayDeclaration:function(){var elementFns=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elementFns.push(this.expression())}while(this.expect(","));return this.consume("]"),extend(function(self,locals){for(var array=[],i=0,ii=elementFns.length;ii>i;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:elementFns.every(isConstant),inputs:elementFns})},object:function(){var keys=[],valueFns=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var token=this.consume();token.constant?keys.push(token.value):token.identifier?keys.push(token.text):this.throwError("invalid key",token),this.consume(":"),valueFns.push(this.expression())}while(this.expect(","));return this.consume("}"),extend(function(self,locals){for(var object={},i=0,ii=valueFns.length;ii>i;i++)object[keys[i]]=valueFns[i](self,locals);return object},{literal:!0,constant:valueFns.every(isConstant),inputs:valueFns})}};var getterFnCacheDefault=createMap(),getterFnCacheExpensive=createMap(),objectValueOf=Object.prototype.valueOf,$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$compileMinErr=minErr("$compile"),urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href);$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1)},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZEw']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|w+))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return attr.href||attr.xlinkHref||attr.name?void 0:function(scope,element){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:function(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}}}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"==attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return void attr.$set("ngPattern",new RegExp(match[1],match[2]))}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$$renameControl:nullFormRenameControl,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop},SUBMITTED_CLASS="ng-submitted";FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:isNgForm?"EAC":"E",controller:FormController,compile:function(formElement){return formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS),{pre:function(scope,formElement,attr,controller){if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};addEventListenerFn(formElement[0],"submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",handleFormSubmission)},0,!1)})}var parentFormCtrl=controller.$$parentForm,alias=controller.$name;alias&&(setter(scope,alias,controller,alias),attr.$observe(attr.name?"name":"ngForm",function(newValue){alias!==newValue&&(setter(scope,alias,undefined,alias),alias=newValue,setter(scope,alias,controller,alias),parentFormCtrl.$$renameControl(controller,alias))})),formElement.on("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&setter(scope,alias,undefined,alias),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),ISO_DATE_REGEXP=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,DATE_REGEXP=/^(\d{4})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/,$ngModelMinErr=new minErr("ngModel"),inputType={text:textInputType,date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,weekParser,"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){ctrls[0]&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}],VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",UNTOUCHED_CLASS="ng-untouched",TOUCHED_CLASS="ng-touched",PENDING_CLASS="ng-pending",NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$rootScope,$q,$interpolate){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=undefined,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=undefined,this.$name=$interpolate($attr.name||"",!1)($scope);var parsedNgModel=$parse($attr.ngModel),parsedNgModelAssign=parsedNgModel.assign,ngModelGet=parsedNgModel,ngModelSet=parsedNgModelAssign,pendingDebounce=null,ctrl=this;this.$$setOptions=function(options){if(ctrl.$options=options,options&&options.getterSetter){var invokeModelGetter=$parse($attr.ngModel+"()"),invokeModelSetter=$parse($attr.ngModel+"($$$p)");ngModelGet=function($scope){var modelValue=parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},ngModelSet=function($scope){isFunction(parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:ctrl.$modelValue}):parsedNgModelAssign($scope,ctrl.$modelValue)}}else if(!parsedNgModel.assign)throw $ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element))},this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var parentForm=$element.inheritedData("$formController")||nullFormCtrl,currentValidationRunId=0;addSetValidityMethod({ctrl:this,$element:$element,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]},parentForm:parentForm,$animate:$animate}),this.$setPristine=function(){ctrl.$dirty=!1,ctrl.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setDirty=function(){ctrl.$dirty=!0,ctrl.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),parentForm.$setDirty()},this.$setUntouched=function(){ctrl.$touched=!1,ctrl.$untouched=!0,$animate.setClass($element,UNTOUCHED_CLASS,TOUCHED_CLASS)},this.$setTouched=function(){ctrl.$touched=!0,ctrl.$untouched=!1,$animate.setClass($element,TOUCHED_CLASS,UNTOUCHED_CLASS)},this.$rollbackViewValue=function(){$timeout.cancel(pendingDebounce),ctrl.$viewValue=ctrl.$$lastCommittedViewValue,ctrl.$render()},this.$validate=function(){if(!isNumber(ctrl.$modelValue)||!isNaN(ctrl.$modelValue)){var viewValue=ctrl.$$lastCommittedViewValue,modelValue=ctrl.$$rawModelValue,parserName=ctrl.$$parserName||"parse",parserValid=ctrl.$error[parserName]?!1:undefined,prevValid=ctrl.$valid,prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$runValidators(parserValid,modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(ctrl.$modelValue=allValid?modelValue:undefined,ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope())})}},this.$$runValidators=function(parseValid,modelValue,viewValue,doneCallback){function processParseErrors(parseValid){var errorKey=ctrl.$$parserName||"parse";if(parseValid===undefined)setValidity(errorKey,null);else if(setValidity(errorKey,parseValid),!parseValid)return forEach(ctrl.$validators,function(v,name){setValidity(name,null)}),forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1;return!0}function processSyncValidators(){var syncValidatorsValid=!0;return forEach(ctrl.$validators,function(validator,name){var result=validator(modelValue,viewValue);syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),syncValidatorsValid?!0:(forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1)}function processAsyncValidators(){var validatorPromises=[],allValid=!0;forEach(ctrl.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw $ngModelMinErr("$asyncValidators","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,undefined),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)}function setValidity(name,isValid){localValidationRunId===currentValidationRunId&&ctrl.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===currentValidationRunId&&doneCallback(allValid)}currentValidationRunId++;var localValidationRunId=currentValidationRunId;return processParseErrors(parseValid)&&processSyncValidators()?void processAsyncValidators():void validationDone(!1)},this.$commitViewValue=function(){var viewValue=ctrl.$viewValue;$timeout.cancel(pendingDebounce),(ctrl.$$lastCommittedViewValue!==viewValue||""===viewValue&&ctrl.$$hasNativeValidators)&&(ctrl.$$lastCommittedViewValue=viewValue,ctrl.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function writeToModelIfNeeded(){ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope()}var viewValue=ctrl.$$lastCommittedViewValue,modelValue=viewValue,parserValid=isUndefined(modelValue)?undefined:!0;if(parserValid)for(var i=0;i<ctrl.$parsers.length;i++)if(modelValue=ctrl.$parsers[i](modelValue),isUndefined(modelValue)){parserValid=!1;break}isNumber(ctrl.$modelValue)&&isNaN(ctrl.$modelValue)&&(ctrl.$modelValue=ngModelGet($scope));var prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$rawModelValue=modelValue,allowInvalid&&(ctrl.$modelValue=modelValue,writeToModelIfNeeded()),ctrl.$$runValidators(parserValid,modelValue,viewValue,function(allValid){allowInvalid||(ctrl.$modelValue=allValid?modelValue:undefined,writeToModelIfNeeded())})},this.$$writeModelToScope=function(){ngModelSet($scope,ctrl.$modelValue),forEach(ctrl.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}})},this.$setViewValue=function(value,trigger){ctrl.$viewValue=value,(!ctrl.$options||ctrl.$options.updateOnDefault)&&ctrl.$$debounceViewValueCommit(trigger)},this.$$debounceViewValueCommit=function(trigger){var debounce,debounceDelay=0,options=ctrl.$options;options&&isDefined(options.debounce)&&(debounce=options.debounce,isNumber(debounce)?debounceDelay=debounce:isNumber(debounce[trigger])?debounceDelay=debounce[trigger]:isNumber(debounce["default"])&&(debounceDelay=debounce["default"])),$timeout.cancel(pendingDebounce),debounceDelay?pendingDebounce=$timeout(function(){ctrl.$commitViewValue()},debounceDelay):$rootScope.$$phase?ctrl.$commitViewValue():$scope.$apply(function(){ctrl.$commitViewValue()})},$scope.$watch(function(){var modelValue=ngModelGet($scope);if(modelValue!==ctrl.$modelValue){ctrl.$modelValue=ctrl.$$rawModelValue=modelValue;for(var formatters=ctrl.$formatters,idx=formatters.length,viewValue=modelValue;idx--;)viewValue=formatters[idx](viewValue);ctrl.$viewValue!==viewValue&&(ctrl.$viewValue=ctrl.$$lastCommittedViewValue=viewValue,ctrl.$render(),ctrl.$$runValidators(undefined,modelValue,viewValue,noop))}return modelValue})}],ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass(UNTOUCHED_CLASS).addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;modelCtrl.$$setOptions(ctrls[2]&&ctrls[2].$options),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&formCtrl.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){formCtrl.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];modelCtrl.$options&&modelCtrl.$options.updateOn&&element.on(modelCtrl.$options.updateOn,function(ev){modelCtrl.$$debounceViewValueCommit(ev&&ev.type)}),element.on("blur",function(){modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(modelCtrl.$setTouched):scope.$apply(modelCtrl.$setTouched))})}}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),requiredDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(attr.required=!0,ctrl.$validators.required=function(modelValue,viewValue){return!attr.required||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(){ctrl.$validate()}))}}},patternDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var regexp,patternExp=attr.ngPattern||attr.pattern;attr.$observe("pattern",function(regex){if(isString(regex)&&regex.length>0&&(regex=new RegExp("^"+regex+"$")),regex&&!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));regexp=regex||undefined,ctrl.$validate()}),ctrl.$validators.pattern=function(value){return ctrl.$isEmpty(value)||isUndefined(regexp)||regexp.test(value)}}}}},maxlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=-1;attr.$observe("maxlength",function(value){var intVal=int(value);maxlength=isNaN(intVal)?-1:intVal,ctrl.$validate()}),ctrl.$validators.maxlength=function(modelValue,viewValue){return 0>maxlength||ctrl.$isEmpty(modelValue)||viewValue.length<=maxlength}}}}},minlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=0;attr.$observe("minlength",function(value){minlength=int(value)||0,ctrl.$validate()}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlength}}}}},ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=element.attr(attr.$attr.ngList)||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList,parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];
return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(ngList):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngModelOptionsDirective=function(){return{restrict:"A",controller:["$scope","$attrs",function($scope,$attrs){var that=this;this.$options=$scope.$eval($attrs.ngModelOptions),this.$options.updateOn!==undefined?(this.$options.updateOnDefault=!1,this.$options.updateOn=trim(this.$options.updateOn.replace(DEFAULT_REGEXP,function(){return that.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=value===undefined?"":value})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=value===undefined?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(value){return(value||"").toString()});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){element.html($sce.getTrustedHtml(ngBindHtmlGetter(scope))||"")})}}}}],ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName],null,!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate",function($animate){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).then(function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate","$sce",function($templateRequest,$anchorScroll,$animate,$sce){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).then(function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch($sce.parseAsResourceUrl(srcExp),function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).then(afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){return/SVG/.test($element[0].toString())?($element.empty(),void $compile(jqLiteBuildFragment(ctrl.template,document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element})):($element.html(ctrl.template),void $compile($element.contents())(scope))}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(scope,element,attr){function updateElementText(newText){element.text(newText||"")}var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNaN(count);countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),count===lastCount||countIsNaN&&isNaN(lastCount)||(watchRemover(),watchRemover=scope.$watch(whensExpFns[count],updateElementText),lastCount=count)})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0===(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=document.createComment(" end ngRepeat: "+expression+" "),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(match=lhs.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);var trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,hashFnLocals={$id:hashKey};return trackByExp?trackByExpGetter=$parse(trackByExp):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),function($scope,$element,$attr,ctrl,$transclude){trackByExpGetter&&(trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)});var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(var itemKey in collection)collection.hasOwnProperty(itemKey)&&"$"!=itemKey.charAt(0)&&collectionKeys.push(itemKey);collectionKeys.sort()}for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:undefined,clone:undefined},nextBlockMap[trackById]=!0}for(var blockKey in lastBlockMap){if(block=lastBlockMap[blockKey],elementsToRemove=getBlockNodes(block.clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;length>index;index++)elementsToRemove[index][NG_REMOVED]=!0;block.scope.$destroy()}for(index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.scope){nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockNodes(block.clone),null,jqLite(previousNode)),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,jqLite(previousNode)),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)});lastBlockMap=nextBlockMap})}}}}],NG_HIDE_CLASS="ng-hide",NG_HIDE_IN_PROGRESS_CLASS="ng-hide-animate",ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(){array.splice(index,1)}};scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousLeaveAnimations.length;ii>i;++i)$animate.cancel(previousLeaveAnimations[i]);for(previousLeaveAnimations.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy();var promise=previousLeaveAnimations[i]=$animate.leave(selected);promise.then(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=document.createComment(" end ngSwitchWhen: ");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({restrict:"EAC",link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsMinErr=minErr("ngOptions"),ngOptionsDirective=valueFn({restrict:"A",terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,nullModelCtrl={$setViewValue:noop};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var nullOption,unknownOption,self=this,optionsMap={},ngModelCtrl=nullModelCtrl;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value,element){assertNotHasOwnProperty(value,'"option value"'),optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove()),element&&element[0].hasAttribute("selected")&&(element[0].selected=!0)},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue==value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function setupAsSingle(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.on("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function setupAsMultiple(scope,selectElement,ctrl){var lastView;ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function(){equals(lastView,ctrl.$viewValue)||(lastView=shallowCopy(ctrl.$viewValue),ctrl.$render())}),selectElement.on("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function setupAsOptions(scope,selectElement,ctrl){function callExpression(exprFn,key,value){return locals[valueName]=value,keyName&&(locals[keyName]=key),exprFn(scope,locals)}function selectionChanged(){scope.$apply(function(){var viewValue,collection=valuesFn(scope)||[];if(multiple)viewValue=[],forEach(selectElement.val(),function(selectedKey){selectedKey=trackFn?trackKeysCache[selectedKey]:selectedKey,viewValue.push(getViewValue(selectedKey,collection[selectedKey]))});else{var selectedKey=trackFn?trackKeysCache[selectElement.val()]:selectElement.val();viewValue=getViewValue(selectedKey,collection[selectedKey])}ctrl.$setViewValue(viewValue),render()})}function getViewValue(key,value){if("?"===key)return undefined;if(""===key)return null;var viewValueFn=selectAsFn?selectAsFn:valueFn;return callExpression(viewValueFn,key,value)}function getLabels(){var toDisplay,values=valuesFn(scope);if(values&&isArray(values)){toDisplay=new Array(values.length);for(var i=0,ii=values.length;ii>i;i++)toDisplay[i]=callExpression(displayFn,i,values[i]);return toDisplay}if(values){toDisplay={};for(var prop in values)values.hasOwnProperty(prop)&&(toDisplay[prop]=callExpression(displayFn,prop,values[prop]))}return toDisplay}function createIsSelectedFn(viewValue){var selectedSet;if(multiple)if(trackFn&&isArray(viewValue)){selectedSet=new HashMap([]);for(var trackIndex=0;trackIndex<viewValue.length;trackIndex++)selectedSet.put(callExpression(trackFn,null,viewValue[trackIndex]),!0)}else selectedSet=new HashMap(viewValue);else trackFn&&(viewValue=callExpression(trackFn,null,viewValue));return function(key,value){var compareValueFn;return compareValueFn=trackFn?trackFn:selectAsFn?selectAsFn:valueFn,multiple?isDefined(selectedSet.remove(callExpression(compareValueFn,key,value))):viewValue===callExpression(compareValueFn,key,value)}}function scheduleRendering(){renderScheduled||(scope.$$postDigest(render),renderScheduled=!0)}function updateLabelMap(labelMap,label,added){labelMap[label]=labelMap[label]||0,labelMap[label]+=added?1:-1}function render(){renderScheduled=!1;var optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,key,value,groupLength,length,groupIndex,index,selected,lastElement,element,label,optionId,optionGroups={"":[]},optionGroupNames=[""],viewValue=ctrl.$viewValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,labelMap={},isSelected=createIsSelectedFn(viewValue),anySelected=!1;for(trackKeysCache={},index=0;length=keys.length,length>index;index++)key=index,keyName&&(key=keys[index],"$"===key.charAt(0))||(value=values[key],optionGroupName=callExpression(groupByFn,key,value)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),selected=isSelected(key,value),anySelected=anySelected||selected,label=callExpression(displayFn,key,value),label=isDefined(label)?label:"",optionId=trackFn?trackFn(scope,locals):keyName?keys[index]:index,trackFn&&(trackKeysCache[optionId]=key),optionGroup.push({id:optionId,label:label,selected:selected}));for(multiple||(nullOption||null===viewValue?optionGroups[""].unshift({id:"",label:"",selected:!anySelected}):anySelected||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],optionGroup=optionGroups[optionGroupName],optionGroupsCache.length<=groupIndex?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&(updateLabelMap(labelMap,existingOption.label,!1),updateLabelMap(labelMap,option.label,!0),lastElement.text(existingOption.label=option.label),lastElement.prop("label",existingOption.label)),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),lastElement[0].selected!==option.selected&&(lastElement.prop("selected",existingOption.selected=option.selected),msie&&lastElement.prop("selected",existingOption.selected))):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).prop("selected",option.selected).attr("selected",option.selected).prop("label",option.label).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),updateLabelMap(labelMap,option.label,!0),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)option=existingOptions.pop(),updateLabelMap(labelMap,option.label,!1),option.element.remove()}for(;optionGroupsCache.length>groupIndex;){for(optionGroup=optionGroupsCache.pop(),index=1;index<optionGroup.length;++index)updateLabelMap(labelMap,optionGroup[index].label,!1);optionGroup[0].element.remove()}forEach(labelMap,function(count,label){count>0?selectCtrl.addOption(label):0>count&&selectCtrl.removeOption(label)})}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],selectAs=/ as /.test(match[0])&&match[1],selectAsFn=selectAs?$parse(selectAs):null,keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),track=match[8],trackFn=track?$parse(match[8]):null,trackKeysCache={},optionGroupsCache=[[{element:selectElement,label:""}]],locals={};nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.empty(),selectElement.on("change",selectionChanged),ctrl.$render=render,scope.$watchCollection(valuesFn,scheduleRendering),scope.$watchCollection(getLabels,scheduleRendering),multiple&&scope.$watchCollection(function(){return ctrl.$modelValue},scheduleRendering)}if(ctrls[1]){for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,renderScheduled=!1,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=nullOption=children.eq(i);break}selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}),optionsExp?setupAsOptions(scope,element,ngModelCtrl):multiple?setupAsMultiple(scope,element,ngModelCtrl):setupAsSingle(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound||(selectCtrl=nullSelectCtrl),interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),oldVal!==newVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal,element)}):selectCtrl.addOption(attr.value,element),element.on("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!1});return window.angular.bootstrap?void console.log("WARNING: Tried to load angular more than once."):(bindJQuery(),publishExternalAPI(angular),void jqLite(document).ready(function(){angularInit(document,bootstrap)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}</style>'),browserify_shim__define__module__export__("undefined"!=typeof angular?angular:window.angular)}.call(global,void 0,void 0,void 0,void 0,function(ex){module.exports=ex})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(require,module){(function(global){require("/Users/willogden/Development/projects/go/src/github.com/willogden/rover/public/vendor/angular/angular.js"),require("/Users/willogden/Development/projects/go/src/github.com/willogden/rover/public/vendor/famous/dist/famous-global.js"),__browserify_shim_require__=require,function(){"use strict";var ngFameApp=angular.module("famous.angular",[]);ngFameApp.provider("$famous",function(){var _modules={"famous/core/Context":famous.core.Context,"famous/core/ElementAllocator":famous.core.ElementAllocator,"famous/core/Engine":famous.core.Engine,"famous/core/Entity":famous.core.Entity,"famous/core/EventEmitter":famous.core.EventEmitter,"famous/core/EventHandler":famous.core.EventHandler,"famous/core/Group":famous.core.Group,"famous/core/Modifier":famous.core.Modifier,"famous/core/OptionsManager":famous.core.OptionsManager,"famous/core/RenderNode":famous.core.RenderNode,"famous/core/Scene":famous.core.Scene,"famous/core/SpecParser":famous.core.SpecParser,"famous/core/Surface":famous.core.Surface,"famous/core/Transform":famous.core.Transform,"famous/core/View":famous.core.View,"famous/core/ViewSequence":famous.core.ViewSequence,"famous/events/EventArbiter":famous.events.EventArbiter,"famous/events/EventFilter":famous.events.EventFilter,"famous/events/EventMapper":famous.events.EventMapper,"famous/inputs/FastClick":famous.inputs.FastClick,"famous/inputs/GenericSync":famous.inputs.GenericSync,"famous/inputs/MouseSync":famous.inputs.MouseSync,"famous/inputs/PinchSync":famous.inputs.PinchSync,"famous/inputs/RotateSync":famous.inputs.RotateSync,"famous/inputs/ScaleSync":famous.inputs.ScaleSync,"famous/inputs/ScrollSync":famous.inputs.ScrollSync,"famous/inputs/TouchSync":famous.inputs.TouchSync,"famous/inputs/TouchTracker":famous.inputs.TouchTracker,"famous/inputs/TwoFingerSync":famous.inputs.TwoFingerSync,"famous/math/Matrix":famous.math.Matrix,"famous/math/Quaternion":famous.math.Quaternion,"famous/math/Random":famous.math.Random,"famous/math/Utilities":famous.math.Utilities,"famous/math/Vector":famous.math.Vector,"famous/modifiers/Draggable":famous.modifiers.Draggable,"famous/modifiers/Fader":famous.modifiers.Fader,"famous/modifiers/ModifierChain":famous.modifiers.ModifierChain,"famous/modifiers/StateModifier":famous.modifiers.StateModifier,"famous/surfaces/CanvasSurface":famous.surfaces.CanvasSurface,"famous/surfaces/ContainerSurface":famous.surfaces.ContainerSurface,"famous/surfaces/FormContainerSurface":famous.surfaces.FormContainerSurface,"famous/surfaces/ImageSurface":famous.surfaces.ImageSurface,"famous/surfaces/InputSurface":famous.surfaces.InputSurface,"famous/surfaces/SubmitInputSurface":famous.surfaces.SubmitInputSurface,"famous/surfaces/TextareaSurface":famous.surfaces.TextareaSurface,"famous/surfaces/VideoSurface":famous.surfaces.VideoSurface,"famous/transitions/CachedMap":famous.transitions.CachedMap,"famous/transitions/Easing":famous.transitions.Easing,"famous/transitions/MultipleTransition":famous.transitions.MultipleTransition,"famous/transitions/SnapTransition":famous.transitions.SnapTransition,"famous/transitions/SpringTransition":famous.transitions.SpringTransition,"famous/transitions/Transitionable":famous.transitions.Transitionable,"famous/transitions/TransitionableTransform":famous.transitions.TransitionableTransform,"famous/transitions/TweenTransition":famous.transitions.TweenTransition,"famous/transitions/WallTransition":famous.transitions.WallTransition,"famous/utilities/KeyCodes":famous.utilities.KeyCodes,"famous/utilities/Timer":famous.utilities.Timer,"famous/utilities/Utility":famous.utilities.Utility,"famous/views/Deck":famous.views.Deck,"famous/views/EdgeSwapper":famous.views.EdgeSwapper,"famous/views/FlexibleLayout":famous.views.FlexibleLayout,"famous/views/Flipper":famous.views.Flipper,"famous/views/GridLayout":famous.views.GridLayout,"famous/views/HeaderFooterLayout":famous.views.HeaderFooterLayout,"famous/views/Lightbox":famous.views.Lightbox,"famous/views/RenderController":famous.views.RenderController,"famous/views/ScrollContainer":famous.views.ScrollContainer,"famous/views/Scroller":famous.views.Scroller,"famous/views/Scrollview":famous.views.Scrollview,"famous/views/SequentialLayout":famous.views.SequentialLayout,"famous/widgets/NavigationBar":famous.widgets.NavigationBar,"famous/widgets/Slider":famous.widgets.Slider,"famous/widgets/TabBar":famous.widgets.TabBar,"famous/widgets/ToggleButton":famous.widgets.ToggleButton,"famous/physics/PhysicsEngine":famous.physics.PhysicsEngine,"famous/physics/bodies/Body":famous.physics.bodies.Body,"famous/physics/bodies/Circle":famous.physics.bodies.Circle,"famous/physics/bodies/Particle":famous.physics.bodies.Particle,"famous/physics/bodies/Rectangle":famous.physics.bodies.Rectangle,"famous/physics/constraints/Collision":famous.physics.constraints.Collision,"famous/physics/constraints/Constraint":famous.physics.constraints.Constraint,"famous/physics/constraints/Curve":famous.physics.constraints.Curve,"famous/physics/constraints/Distance":famous.physics.constraints.Distance,"famous/physics/constraints/Snap":famous.physics.constraints.Snap,"famous/physics/constraints/Surface":famous.physics.constraints.Surface,"famous/physics/constraints/Wall":famous.physics.constraints.Wall,"famous/physics/constraints/Walls":famous.physics.constraints.Walls,"famous/physics/forces/Drag":famous.physics.forces.Drag,"famous/physics/forces/Force":famous.physics.forces.Force,"famous/physics/forces/Repulsion":famous.physics.forces.Repulsion,"famous/physics/forces/RotationalDrag":famous.physics.forces.RotationalDrag,"famous/physics/forces/RotationalSpring":famous.physics.forces.RotationalSpring,"famous/physics/forces/Spring":famous.physics.forces.Spring,"famous/physics/forces/VectorField":famous.physics.forces.VectorField,"famous/physics/integrators/SymplecticEuler":famous.physics.integrators.SymplecticEuler};
this.registerModule=function(key,module){_modules[key]=module},_modules.getIsolate=function(scope){return scope&&"isolate"in scope?scope.isolate[scope.$id]:{}},_modules.find=function(selector){var elems=angular.element(window.document.querySelectorAll(selector)),scopes=function(elems){var _s=[];return angular.forEach(elems,function(elem,i){_s[i]=angular.element(elem).scope()}),_s}(elems),isolates=function(scopes){var _s=[];return angular.forEach(scopes,function(scope,i){_s[i]=_modules.getIsolate(scope)}),_s}(scopes);return isolates};var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,IS_A_SURFACE=/^FA\-.*SURFACE/,IS_FA=/^FA\-.*/;window.$famousUtil=_modules.util={isASurface:function(element){return IS_A_SURFACE.test(element[0].tagName)},isFaElement:function(element){if(IS_FA.test(element[0].tagName))return!0;var ret=!1;return angular.forEach(element[0].attributes,function(attr){ret=ret||IS_FA.test(attr)}),ret},camelCase:function(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")},directiveNormalize:function(name){return _modules.util.camelCase(name.replace(PREFIX_REGEXP,""))}},this.$get=function(){return _modules}}),angular.module("famous.angular").config(["$provide",function($provide){$provide.decorator("$animate",["$delegate","$rootScope","$famous","$parse","$famousDecorator",function($delegate,$rootScope,$famous,$parse,$famousDecorator){var Timer=$famous["famous/utilities/Timer"],FA_ANIMATION_ACTIVE="$$faAnimationActive",_lastKnownParent={},_getIsolate=function(scope){var isolate=$famous.getIsolate(scope);return!isolate&&scope&&(isolate=$famousDecorator.$$getIsolateById(_lastKnownParent[scope.$id])),isolate},animationHandlers={enabled:$delegate.enabled};return angular.forEach(["addClass","removeClass"],function(classManipulator){var originalManipulator=angular.element.prototype[classManipulator];angular.element.prototype[classManipulator]=function(className){return originalManipulator.apply(this,arguments),$famous.util.isASurface(this)&&"string"==typeof className&&""!==className.trim()&&_getIsolate(this.scope()).renderNode[classManipulator](className),this},animationHandlers[classManipulator]=function(element,className,done){if($delegate[classManipulator](element,className,done),$famous.util.isFaElement(element)){var isolate=_getIsolate(element.scope());if($famous.util.isASurface(element)){var surface=isolate.renderNode;angular.forEach(className.split(" "),function(splitClassName){"ng-hide"===splitClassName?"addClass"===classManipulator?isolate.hide():"removeClass"===classManipulator&&isolate.show():surface[classManipulator](splitClassName)})}else angular.forEach(className.split(" "),function(splitClassName){"ng-hide"===splitClassName&&("addClass"===classManipulator?isolate.hide():"removeClass"===classManipulator&&isolate.show())})}}}),animationHandlers.setClass=function(element,add,remove,done){if($delegate.setClass(element,add,remove,done),$famous.util.isASurface(element)){var surface=_getIsolate(element.scope()).renderNode;angular.forEach(add.split(" "),function(className){surface.addClass(className)}),angular.forEach(remove.split(" "),function(className){surface.removeClass(className)})}},angular.forEach(["enter","leave","move"],function(operation){var capitalizedOperation=operation[0].toUpperCase()+operation.slice(1);animationHandlers[operation]=function(element){var self=this,selfArgs=arguments,delegateFirst="enter"===operation,elemScope=element.scope();elemScope&&elemScope.$parent&&(_lastKnownParent[elemScope.$id]=elemScope.$parent.$id);var isolate=_getIsolate(elemScope);delegateFirst===!0&&$delegate[operation].apply(this,arguments),element.data(FA_ANIMATION_ACTIVE)===!0&&isolate&&isolate.$$animateHaltHandler&&isolate.$$animateHaltHandler(element.scope()),element.data(FA_ANIMATION_ACTIVE,!0);var doneCallback=function(){elemScope&&elemScope.$id;if("leave"===operation&&$famous.util.isFaElement(element)){var isolate=_getIsolate(elemScope);isolate&&isolate.id&&isolate.hide()}element.data(FA_ANIMATION_ACTIVE)!==!1&&(element.data(FA_ANIMATION_ACTIVE,!1),delegateFirst===!1&&$delegate[operation].apply(self,selfArgs))};$rootScope.$$postDigest(function(){var animationHandler,elemScope=element.scope(),isolate=_getIsolate(elemScope);if(isolate&&(animationHandler=isolate["$$animate"+capitalizedOperation+"Handler"]),void 0===animationHandler)return void doneCallback();var animationDuration=animationHandler(elemScope,{$done:doneCallback});"number"==typeof animationDuration&&Timer.setTimeout(doneCallback,animationDuration)})}}),animationHandlers}])}]),angular.module("famous.angular").factory("$famousDecorator",["$famous",function($famous){var _roles={child:{},parent:{},renderable:function(isolate){var RenderNode=$famous["famous/core/RenderNode"];isolate.renderGate=new RenderNode,isolate.emptyNode=new RenderNode,isolate.show=function(){isolate.renderGate&&isolate.renderGate.set(isolate.renderNode)},isolate.hide=function(){isolate.renderGate.set(isolate.emptyNode)}}},_isolateStore={};return{addRole:function(role,isolate){_roles[role](isolate)},ensureIsolate:function(scope,element){if(element){var SPECIAL_CASE_LIST=["fa-edge-swapper","fa-render-controller","fa-deck","fa-light-box"],special=!1;angular.forEach(SPECIAL_CASE_LIST,function(specialCase){return specialCase.toUpperCase()===element[0].tagName?void(special=!0):void 0!==element[0].attributes[specialCase]?void(special=!0):void 0}),special&&(scope=scope.$parent)}scope.isolate=scope.isolate||{},scope.isolate[scope.$id]=scope.isolate[scope.$id]||{};var isolate=scope.isolate[scope.$id];isolate.id=scope.$id;var i=scope.$eval("$index");return i&&"$index"!==i&&!isolate.index&&(isolate.index=i),_isolateStore[isolate.id]=isolate,isolate},$$getIsolateById:function(id){return _isolateStore[id]},registerChild:function(scope,element,isolate,unregisterCallback){scope.$emit("registerChild",isolate),element.one("$destroy",function(){"removeMethod"in isolate&&isolate.removeMethod(isolate.id),isolate&&isolate.hide&&isolate.hide(),unregisterCallback&&unregisterCallback()})},sequenceWith:function(scope,addMethod,removeMethod,updateMethod){scope.$on("registerChild",function(evt,isolate){if(evt.targetScope.$id!==scope.$id){var parentIsolate=$famous.getIsolate(scope);isolate.$parent=parentIsolate,parentIsolate.$children=parentIsolate.$children||[],parentIsolate.$children.push(isolate),addMethod(isolate),evt.stopPropagation(),removeMethod&&(isolate.removeMethod=removeMethod),updateMethod&&(isolate.updateMethod=updateMethod)}})}}}]),angular.module("famous.angular").service("$famousPipe",function(){function bulkUpdatePipes(pipes,targets,method){pipes instanceof Array||(pipes=[pipes]),targets instanceof Array||(targets=[targets]);for(var i=0;i<pipes.length;i++)for(var j=0;j<targets.length;j++)void 0!==targets[j]&&void 0!==pipes[i]&&targets[j][method](pipes[i])}this.unpipesFromTargets=function(pipes,targets){bulkUpdatePipes(pipes,targets,"unpipe")},this.pipesToTargets=function(pipes,targets){bulkUpdatePipes(pipes,targets,"pipe")}}),angular.module("famous.angular").factory("$timeline",function(){var add=function(a,b){return"number"==typeof a?a+b:a.map(function(x,i){return x+b[i]})},subtract=function(a,b){return"number"==typeof a?a-b:a.map(function(x,i){return x-b[i]})},multiply=function(A,b){return"number"==typeof A?A*b:A.map(function(x){return x*b})},scale=function(f,x1,x2,y1,y2){return function(x){var yTranslate=y1,xTranslate=-x1,xScale=1/(x2-x1),yScale=subtract(y2,y1);return add(multiply(yScale,f(xScale*(x+xTranslate))),yTranslate)}};return function(points){var linear=function(x){return x};return function(x){if(x<points[0][0])return points[0][1];for(var i=0;i<points.length-1;i++)if(points[i][0]<=x&&x<points[i+1][0]){var f=scale(points[i][2]||linear,points[i][0],points[i+1][0],points[i][1],points[i+1][1]);return f(x)}return points[points.length-1][1]}}}),angular.module("famous.angular").directive("faAnimateEnter",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);isolate.$$animateEnterHandler=$parse(attrs.faAnimateEnter),attrs.$observe("faAnimateEnter",function(){isolate.$$animateEnterHandler=$parse(attrs.faAnimateEnter)})}}}}}]),angular.module("famous.angular").directive("faAnimateHalt",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);isolate.$$animateHaltHandler=$parse(attrs.faAnimateHalt),attrs.$observe("faAnimateHalt",function(){isolate.$$animateHaltHandler=$parse(attrs.faAnimateHalt)})}}}}}]),angular.module("famous.angular").directive("faAnimateLeave",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);isolate.$$animateLeaveHandler=$parse(attrs.faAnimateLeave),attrs.$observe("faAnimateLeave",function(){isolate.$$animateLeaveHandler=$parse(attrs.faAnimateLeave)})}}}}}]),angular.module("famous.angular").directive("faAnimateMove",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);isolate.$$animateMoveHandler=$parse(attrs.faAnimateMove),attrs.$observe("faAnimateMove",function(){isolate.$$animateMoveHandler=$parse(attrs.faAnimateMove)})}}}}}]),angular.module("famous.angular").directive("faAnimation",["$famous","$famousDecorator",function($famous,famousDecorator){return{restrict:"EA",scope:!0,compile:function(){var Transform=$famous["famous/core/Transform"],Transitionable=$famous["famous/transitions/Transitionable"],Easing=$famous["famous/transitions/Easing"];return{pre:function(scope){famousDecorator.ensureIsolate(scope)},post:function(scope,element,attrs){var isolate=famousDecorator.ensureIsolate(scope);setTimeout(function(){isolate.timeline=scope.$eval(attrs.timeline),isolate._trans=new Transitionable(0),isolate.play=function(callback){var transition={duration:scope.$eval(attrs.duration),curve:scope.$eval(attrs.curve)||"linear"};isolate._trans.set(1,transition,function(){callback&&callback(),attrs.loop&&setTimeout(function(){isolate.replay(callback)},0)})},isolate.reset=function(){isolate._trans.set(0)},isolate.replay=function(callback){isolate.reset(),isolate.play(callback)};var _disengage=null;attrs.event&&(_disengage&&_disengage(),_disengage=scope.$on(attrs.event,function(evt,data){var callback=data&&data.callback?data.callback:void 0;isolate.replay(callback)}));attrs.id;if(void 0===isolate.timeline&&(isolate.timeline=isolate._trans.get.bind(isolate._trans),attrs.autoplay&&isolate.play()),!isolate.timeline instanceof Function)throw new Error("timeline must be a reference to a function or duration must be provided");for(var animates=element[0].querySelectorAll("animate"),declarations={},i=0;i<animates.length;i++)!function(){var animate=animates[i];if(animate.attributes.targetmodselector){var modElements=angular.element(element[0].parentNode)[0].querySelectorAll(animate.attributes.targetmodselector.value);angular.forEach(modElements,function(modElement){var modScope=angular.element(modElement).scope(),modifier=modScope.isolate[modScope.$id].modifier,getTransform=modScope.isolate[modScope.$id].getTransform,curve=animate.attributes.curve&&"linear"!==animate.attributes.curve.value?Easing[animate.attributes.curve.value]:function(j){return j};if(animate.attributes.field){var field=animate.attributes.field.value,lowerBound=animate.attributes.timelinelowerbound?parseFloat(animate.attributes.timelinelowerbound.value):0,upperBound=animate.attributes.timelineupperbound?parseFloat(animate.attributes.timelineupperbound.value):1;if(!animate.attributes.startvalue)throw new Error("you must provide a start value for the animation");var startValue=scope.$eval(animate.attributes.startvalue.value);if(!animate.attributes.endvalue)throw new Error("you must provide an end value for the animation");var endValue=scope.$eval(animate.attributes.endValue.value),modDecs=declarations[modScope.$id]=declarations[modScope.$id]||{},segments=modDecs[field]=modDecs[field]||[];segments.push({field:field,lowerBound:lowerBound,upperBound:upperBound,startValue:startValue,endValue:endValue,curve:curve}),segments.sort(function(a,b){return a.lowerBound-b.lowerBound});for(var j=1;j<segments.length;j++)for(var lower=segments[j].lowerBound,k=0;j>k;k++)if(lower<segments[k].upperBound)throw new Error("Animate segments have overlappingdomains for the same field ("+field+").At any point in the timeline, only one <animate>can affect a given field on the same modifier.");var transformFunction=function(){for(var x=isolate.timeline()||0,relevantIndex=0,relevantSegment=segments[relevantIndex],j=0;j<segments.length;j++){if(x>=segments[j].lowerBound&&x<=segments[j].upperBound){relevantSegment=segments[j];break}if(j===segments.length-1){relevantSegment=segments[j];break}if(x>=segments[j].upperBound&&x<segments[j+1].lowerBound){relevantSegment=segments[j];break}}if(x<=relevantSegment.lowerBound)return relevantSegment.startValue;if(x>=relevantSegment.upperBound)return relevantSegment.endValue;var subDomain=relevantSegment.upperBound-relevantSegment.lowerBound,normalizedX=(x-relevantSegment.lowerBound)/subDomain;if(Array.isArray(relevantSegment.startValue)){for(var ret=[],k=0;k<relevantSegment.startValue.length;k++)ret.push(relevantSegment.startValue[k]+relevantSegment.curve(normalizedX)*(relevantSegment.endValue[k]-relevantSegment.startValue[k]));return ret}return relevantSegment.startValue+relevantSegment.curve(normalizedX)*(relevantSegment.endValue-relevantSegment.startValue)},transformComponents=modDecs.transformComponents=modDecs.transformComponents||[];"opacity"===field?modifier.opacityFrom(function(){return transformFunction()}):"origin"===field?modifier.originFrom(function(){return transformFunction()}):"size"===field?modifier.sizeFrom(function(){return transformFunction()}):(transformComponents.push({field:field,fn:transformFunction}),modifier.transformFrom(function(){for(var usedFields={},mult=getTransform&&getTransform()?[getTransform()]:[],j=0;j<transformComponents.length;j++)!function(){var f=transformComponents[j].field;if(!usedFields[f]){var transVal=transformComponents[j].fn();mult.push(Array.isArray(transVal)?Transform[f].apply(this,transVal):Transform[f](transVal)),usedFields[f]=!0}}();return 1===mult.length?mult[0]:Transform.multiply.apply(this,mult)}))}})}}()},1)}}}}}]),angular.module("famous.angular").directive("faApp",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:'<div style="display: none;"><div></div></div>',transclude:!0,scope:!0,restrict:"EA",compile:function(tElement,tAttrs,transclude){return{pre:function(scope,element,attrs){function AppView(){View.apply(this,arguments)}{var isolate=$famousDecorator.ensureIsolate(scope),View=$famous["famous/core/View"],Engine=$famous["famous/core/Engine"];$famous["famous/core/Transform"]}element.append('<div class="famous-angular-clipping-container"><div class="famous-angular-container"></div></div>'),isolate.context=Engine.createContext(element[0].querySelector(".famous-angular-container")),window.context=isolate.context;var _updatePerspective=function(){var val=parseInt(attrs.faPerspective);val&&isolate.context.setPerspective(val)};attrs.$observe("faPerspective",_updatePerspective),_updatePerspective(),AppView.prototype=Object.create(View.prototype),AppView.prototype.constructor=AppView;isolate.view=new AppView,isolate.context.add(isolate.view),scope.$on("$destroy",function(){isolate.context.update=angular.noop}),scope.$on("registerChild",function(evt,data){isolate.view.add(data.renderNode),evt.stopPropagation()})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){angular.element(element[0].querySelectorAll("div div")[0]).append(clone)}),isolate.readyToRender=!0}}}}}]),angular.module("famous.angular").directive("faCanvasSurface",["$famous","$famousDecorator","$interpolate","$controller","$compile",function($famous,$famousDecorator){return{scope:!0,transclude:!0,template:'<canvas class="fa-canvas-surface"></canvas>',restrict:"EA",compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){{var isolate=$famousDecorator.ensureIsolate(scope),CanvasSurface=$famous["famous/surfaces/CanvasSurface"];$famous["famous/core/Transform"],$famous["famous/core/EventHandler"]}isolate.renderNode=new CanvasSurface({size:scope.$eval(attrs.faSize)}),$famousDecorator.addRole("renderable",isolate),isolate.show(),attrs.class&&isolate.renderNode.setClasses(attrs["class"].split(" ")),$famousDecorator.sequenceWith(scope,function(){throw new Error("Surfaces are leaf nodes of the Famo.us render tree and cannot accept rendernode children.  To include additional Famo.us content inside of a fa-surface, that content must be enclosed in an additional fa-app.")})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope),updateContent=function(){isolate.renderNode.setContent(element[0].querySelector("canvas.fa-canvas-surface"))};updateContent(),transclude(scope,function(clone){angular.element(element[0].querySelectorAll("canvas.fa-canvas-surface")).append(clone)}),$famousDecorator.registerChild(scope,element,isolate,function(){})}}}}}]),angular.module("famous.angular").directive("faClick",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faClick){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("click",function(data){var fn=$parse(attrs.faClick);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faContainerSurface",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),ContainerSurface=$famous["famous/surfaces/ContainerSurface"],options=scope.$eval(attrs.faOptions)||{};isolate.renderNode=new ContainerSurface(options),$famousDecorator.addRole("renderable",isolate),isolate.show(),$famousDecorator.sequenceWith(scope,function(data){isolate.renderNode.add(data.renderGate)})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faDraggable",["$famous","$famousDecorator","$parse","$rootScope",function($famous,$famousDecorator,$parse,$rootScope){return{template:"<div></div>",transclude:!0,restrict:"EA",priority:2,scope:!0,compile:function(tElement,tAttrs,transclude){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),RenderNode=$famous["famous/core/RenderNode"],Draggable=$famous["famous/modifiers/Draggable"],options=scope.$eval(attrs.faOptions)||{};scope.$watch(function(){return scope.$eval(attrs.faOptions)},function(newVal){newVal=newVal||{},isolate.modifier.setOptions(newVal)},!0),isolate.modifier=new Draggable(options),isolate.renderNode=(new RenderNode).add(isolate.modifier),$famousDecorator.addRole("renderable",isolate),isolate.show(),$famousDecorator.sequenceWith(scope,function(data){isolate.renderNode.add(data.renderGate)}),transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate,function(){isolate.modifier.deactivate()}),scope.$$phase||$rootScope.$$phase||scope.$apply()}}}}}]),angular.module("famous.angular").directive("faEdgeSwapper",["$famous","$famousDecorator",function($famous,$famousDecorator){return{scope:!0,restrict:"A",priority:512,compile:function(){var EdgeSwapper=$famous["famous/views/EdgeSwapper"];return{pre:function(scope,element,attrs){var _nextChild,isolate=$famousDecorator.ensureIsolate(scope);isolate.$$animateEnterHandler=function(scope,locals){isolate.renderNode.show(_nextChild,function(){isolate.$$leaveDoneCallback&&isolate.$$leaveDoneCallback(),locals.$done()})},isolate.$$animateLeaveHandler=function(scope,locals){isolate.$$leaveDoneCallback=locals.$done};var initialOptions=scope.$eval(attrs.faOptions);isolate.renderNode=new EdgeSwapper(initialOptions),$famousDecorator.addRole("renderable",isolate),isolate.show(),$famousDecorator.sequenceWith(scope,function(data){_nextChild=data.renderGate})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faFlexibleLayout",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),FlexibleLayout=$famous["famous/views/FlexibleLayout"],_children=($famous["famous/core/ViewSequence"],$famous["famous/core/RenderNode"],[]),options=scope.$eval(attrs.faOptions)||{};isolate.renderNode=new FlexibleLayout(options),$famousDecorator.addRole("renderable",isolate),isolate.show();var updateFlexibleLayout=function(){_children.sort(function(a,b){return a.index-b.index}),isolate.renderNode.sequenceFrom(function(_children){var _ch=[];return angular.forEach(_children,function(c,i){_ch[i]=c.renderGate}),_ch}(_children))};$famousDecorator.sequenceWith(scope,function(data){_children.push(data),updateFlexibleLayout()},function(childScopeId){_children=function(_children){var _ch=[];return angular.forEach(_children,function(c){c.id!==childScopeId&&_ch.push(c)}),_ch}(_children),updateFlexibleLayout()})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),scope.$emit("registerChild",isolate)}}}}}]),angular.module("famous.angular").directive("faFlipper",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),Flipper=$famous["famous/views/Flipper"],options=scope.$eval(attrs.faOptions)||{};isolate.renderNode=new Flipper(options),$famousDecorator.addRole("renderable",isolate),isolate.show(),isolate.children=[],isolate.flip=function(overrideOptions){isolate.renderNode.flip(overrideOptions||scope.$eval(attrs.faOptions))},$famousDecorator.sequenceWith(scope,function(data){var _childCount=isolate.children.length;if(0===_childCount)isolate.renderNode.setFront(data.renderGate);else{if(1!==_childCount)throw new Error("fa-flipper accepts only two child elements; more than two have been provided");isolate.renderNode.setBack(data.renderGate)}isolate.children.push(data.renderGate)},function(){isolate.children.splice(isolate.children.length-1,1)})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faGridLayout",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),GridLayout=$famous["famous/views/GridLayout"],_children=($famous["famous/core/ViewSequence"],[]),options=scope.$eval(attrs.faOptions)||{};isolate.renderNode=new GridLayout(options),$famousDecorator.addRole("renderable",isolate),isolate.show();var updateGridLayout=function(){scope.$$postDigest(function(){_children.sort(function(a,b){return a.index-b.index}),isolate.renderNode.sequenceFrom(function(_children){var _ch=[];return angular.forEach(_children,function(c,i){_ch[i]=c.renderGate}),_ch}(_children))})};$famousDecorator.sequenceWith(scope,function(data){_children.push(data),updateGridLayout()},function(childScopeId){_children=function(_children){var _ch=[];return angular.forEach(_children,function(c){c.id!==childScopeId&&_ch.push(c)}),_ch}(_children),updateGridLayout()},updateGridLayout)},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faHeaderFooterLayout",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){var HeaderFooterLayout=$famous["famous/views/HeaderFooterLayout"],RenderNode=$famous["famous/core/RenderNode"];return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),options=(new RenderNode,new RenderNode,new RenderNode,scope.$eval(attrs.faOptions)||{});isolate.renderNode=new HeaderFooterLayout(options),$famousDecorator.addRole("renderable",isolate),isolate.show();var _numberOfChildren=0;$famousDecorator.sequenceWith(scope,function(data){if(_numberOfChildren++,1===_numberOfChildren)isolate.renderNode.header.add(data.renderGate);else if(2===_numberOfChildren)isolate.renderNode.content.add(data.renderGate);else{if(3!==_numberOfChildren)throw new Error("fa-header-footer-layout can accept no more than 3 children");isolate.renderNode.footer.add(data.renderGate)}},function(){1===_numberOfChildren?isolate.renderNode.header.set({}):2===_numberOfChildren?isolate.renderNode.content.set({}):3===_numberOfChildren&&isolate.renderNode.footer.set({}),_numberOfChildren--})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faImageSurface",["$famous","$famousDecorator",function($famous,$famousDecorator){return{scope:!0,template:'<div class="fa-image-surface"></div>',restrict:"EA",compile:function(){return{pre:function(scope,element,attrs){{var isolate=$famousDecorator.ensureIsolate(scope),ImageSurface=$famous["famous/surfaces/ImageSurface"];$famous["famous/core/Transform"],$famous["famous/core/EventHandler"]}scope.$watch(function(){return isolate.getProperties()},function(){isolate.renderNode&&isolate.renderNode.setProperties(isolate.getProperties())},!0);var _propToFaProp=function(prop){return"fa"+prop.charAt(0).toUpperCase()+prop.slice(1)};isolate.getProperties=function(){for(var baseProperties=scope.$eval(attrs.faProperties)||{},properties=["backgroundColor","color"],i=0;i<properties.length;i++){var prop=properties[i],faProp=_propToFaProp(prop);attrs[faProp]&&(baseProperties[prop]=scope.$eval(attrs[faProp]))}return baseProperties},isolate.renderNode=new ImageSurface({size:scope.$eval(attrs.faSize),"class":scope.$eval(attrs.class),properties:isolate.getProperties()}),$famousDecorator.addRole("renderable",isolate),isolate.show(),attrs.class&&isolate.renderNode.setClasses(attrs["class"].split(" "))},post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),updateContent=function(){isolate.renderNode.setContent(attrs.faImageUrl)};updateContent(),attrs.$observe("faImageUrl",updateContent),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faIndex",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope,element);isolate.index=scope.$eval(attrs.faIndex),scope.$watch(function(){return scope.$eval(attrs.faIndex)},function(){isolate.index=scope.$eval(attrs.faIndex),isolate.updateMethod&&isolate.updateMethod()})}}}}}]),angular.module("famous.angular").config(["$provide",function($provide){$provide.decorator("ngClickDirective",["$delegate","$famousDecorator","$parse","$rootElement","$famous","$timeout",function($delegate,$famousDecorator,$parse,$rootElement,$famous,$timeout){function hit(x1,y1,x2,y2){return Math.abs(x1-x2)<CLICKBUSTER_THRESHOLD&&Math.abs(y1-y2)<CLICKBUSTER_THRESHOLD}function checkAllowableRegions(touchCoordinates,x,y){for(var i=0;i<touchCoordinates.length;i+=2)if(hit(touchCoordinates[i],touchCoordinates[i+1],x,y))return touchCoordinates.splice(i,i+2),!0;return!1}function onClick(event){if(!(Date.now()-lastPreventedTime>PREVENT_DURATION)){var touches=event.touches&&event.touches.length?event.touches:[event],x=touches[0].clientX,y=touches[0].clientY;checkAllowableRegions(touchCoordinates,x,y)||(event.stopPropagation(),event.preventDefault(),event.target&&event.target.blur())}}function onTouchStart(event){var touches=event.touches&&event.touches.length?event.touches:[event],x=touches[0].clientX,y=touches[0].clientY;touchCoordinates.push(x,y),$timeout(function(){for(var i=0;i<touchCoordinates.length;i+=2)if(touchCoordinates[i]===x&&touchCoordinates[i+1]===y)return void touchCoordinates.splice(i,i+2)},PREVENT_DURATION,!1)}function preventGhostClick(x,y){touchCoordinates||($rootElement[0].addEventListener("click",onClick,!0),$rootElement[0].addEventListener("touchstart",onTouchStart,!0),touchCoordinates=[]),lastPreventedTime=Date.now(),checkAllowableRegions(touchCoordinates,x,y)}{var lastPreventedTime,touchCoordinates,directive=$delegate[0],compile=directive.compile,TAP_DURATION=750,MOVE_TOLERANCE=12,PREVENT_DURATION=2500,CLICKBUSTER_THRESHOLD=25,ACTIVE_CLASS_NAME="ng-click-active";$famous["famous/core/Engine"]}return directive.compile=function(element,attrs,transclude){return $famous.util.isFaElement(element)?$famous.util.isASurface(element)?{post:function(scope,element,attr){function resetState(){tapping=!1,renderNode.removeClass(ACTIVE_CLASS_NAME)}var tapElement,startTime,touchStartX,touchStartY,clickHandler=$parse(attr.ngClick),tapping=!1,isolate=$famous.getIsolate(scope),renderNode=isolate.renderNode;renderNode.on("touchstart",function(event){tapping=!0,tapElement=event.target?event.target:event.srcElement,3===tapElement.nodeType&&(tapElement=tapElement.parentNode),renderNode.addClass(ACTIVE_CLASS_NAME),startTime=Date.now();var touches=event.touches&&event.touches.length?event.touches:[event],e=touches[0].originalEvent||touches[0];touchStartX=e.clientX,touchStartY=e.clientY}),renderNode.on("touchmove",function(){resetState()}),renderNode.on("touchcancel",function(){resetState()}),renderNode.on("touchend",function(event){var diff=Date.now()-startTime,touches=event.changedTouches&&event.changedTouches.length?event.changedTouches:event.touches&&event.touches.length?event.touches:[event],e=touches[0].originalEvent||touches[0],x=e.clientX,y=e.clientY,dist=Math.sqrt(Math.pow(x-touchStartX,2)+Math.pow(y-touchStartY,2));tapping&&TAP_DURATION>diff&&MOVE_TOLERANCE>dist&&(preventGhostClick(x,y),angular.isDefined(attr.disabled)&&"false"!==attr.disabled||renderNode.emit("click",[event])),resetState()}),renderNode.on("click",function(event,touchend){scope.$apply(function(){clickHandler(scope,{$event:touchend||event})})}),renderNode.on("mousedown",function(){renderNode.addClass(ACTIVE_CLASS_NAME)}),renderNode.on("mousemove mouseup",function(){renderNode.removeClass(ACTIVE_CLASS_NAME)})}}:void 0:compile(element,attrs,transclude)
},$delegate}]),angular.forEach("dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(name){var directiveName=window.$famousUtil.directiveNormalize("ng-"+name);$provide.decorator(directiveName+"Directive",["$delegate","$famousDecorator","$parse","$famous",function($delegate,$famousDecorator,$parse,$famous){var directive=$delegate[0],compile=directive.compile;return directive.compile=function(element,attrs,transclude){return $famous.util.isFaElement(element)?{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs[directiveName]){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on(name,function(data){var fn=$parse(attrs[directiveName]);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}:compile(element,attrs,transclude)},$delegate}])})}]),angular.module("famous.angular").directive("faModifier",["$famous","$famousDecorator","$parse","$rootScope",function($famous,$famousDecorator,$parse,$rootScope){return{template:"<div></div>",transclude:!0,restrict:"EA",priority:2,scope:!0,compile:function(tElement,tAttrs,transclude){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),RenderNode=$famous["famous/core/RenderNode"],Modifier=$famous["famous/core/Modifier"],Transform=$famous["famous/core/Transform"],Particle=$famous["famous/physics/bodies/Particle"],_unwrapParticle=function(part){return part.getPosition()},_transformFields=["aboutOrigin","perspective","rotate","rotateAxis","rotateX","rotateY","rotateZ","scale","skew","translate"];attrs.$observe("faTransformOrder",function(){var candidate=scope.$eval(attrs.faTransformOrder);void 0!==candidate&&(_transformFields=candidate)});var _parsedTransforms={};angular.forEach(_transformFields,function(field){var attrName=$famous.util.directiveNormalize("fa-"+field);attrs.$observe(attrName,function(){_parsedTransforms[field]=$parse(attrs[attrName])})});var _transformFn=angular.noop;attrs.$observe("faTransform",function(){_transformFn=$parse(attrs.faTransform)}),isolate.getTransform=function(){var override=_transformFn(scope);if(void 0!==override)return override instanceof Function?override():override instanceof Object&&void 0!==override.get?override.get():override;var transforms=[];return angular.forEach(_transformFields,function(field){var candidate=_parsedTransforms[field]?_parsedTransforms[field](scope):void 0;void 0!==candidate&&(candidate instanceof Function&&(candidate=candidate()),transforms.push(candidate instanceof Array?Transform[field].apply(this,candidate):candidate instanceof Particle?Transform[field].apply(this,_unwrapParticle(candidate)):Transform[field].call(this,candidate)))}),transforms.length?1===transforms.length?transforms[0]:Transform.multiply.apply(this,transforms):void 0};var _alignFn=angular.noop;attrs.$observe("faAlign",function(){_alignFn=$parse(attrs.faAlign)}),isolate.getAlign=function(){var ret=_alignFn(scope);return ret instanceof Function?ret():ret instanceof Object&&void 0!==ret.get?ret.get():ret instanceof Particle?_unwrapParticle(ret):ret};var _opacityFn=angular.noop;attrs.$observe("faOpacity",function(){_opacityFn=$parse(attrs.faOpacity)}),isolate.getOpacity=function(){var ret=_opacityFn(scope);return void 0===ret?1:ret instanceof Function?ret():ret instanceof Object&&void 0!==ret.get?ret.get():ret instanceof Particle?_unwrapParticle(ret):ret};var _sizeFn=angular.noop;attrs.$observe("faSize",function(){_sizeFn=$parse(attrs.faSize)}),isolate.getSize=function(){var ret=_sizeFn(scope);return ret instanceof Function?ret():ret instanceof Object&&void 0!==ret.get?ret.get():ret instanceof Particle?_unwrapParticle(ret):ret};var _originFn=angular.noop;attrs.$observe("faOrigin",function(){_originFn=$parse(attrs.faOrigin)}),isolate.getOrigin=function(){var ret=_originFn(scope);return ret instanceof Function?ret():ret instanceof Object&&void 0!==ret.get?ret.get():ret instanceof Particle?_unwrapParticle(ret):ret},isolate.modifier=new Modifier({transform:isolate.getTransform,size:isolate.getSize,opacity:isolate.getOpacity,origin:isolate.getOrigin,align:isolate.getAlign}),isolate.renderNode=(new RenderNode).add(isolate.modifier),$famousDecorator.addRole("renderable",isolate),isolate.show(),$famousDecorator.sequenceWith(scope,function(data){isolate.renderNode.add(data.renderGate)}),transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate,function(){isolate.modifier.setOpacity(0)}),scope.$$phase||$rootScope.$$phase||scope.$apply()}}}}}]),angular.module("famous.angular").directive("faMouseover",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faMouseover){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("mouseover",function(data){var fn=$parse(attrs.faMouseover);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faOptions",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,priority:-16,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope,element);scope.$watch(function(){return scope.$eval(attrs.faOptions)},function(){isolate.renderNode.setOptions(scope.$eval(attrs.faOptions))},!0)}}}}}]),angular.module("famous.angular").directive("faPipeFrom",["$famous","$famousDecorator","$famousPipe",function($famous,$famousDecorator,$famousPipe){return{restrict:"A",scope:!1,priority:16,compile:function(){var Engine=$famous["famous/core/Engine"];return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);scope.$watch(function(){return scope.$eval(attrs.faPipeFrom)},function(newTarget,oldTarget){var source;source=isolate.renderNode&&isolate.renderNode._isModifier?isolate.renderNode._object:isolate.renderNode?isolate.renderNode._eventInput||isolate.renderNode:Engine,$famousPipe.unpipesFromTargets(source,oldTarget),$famousPipe.pipesToTargets(source,newTarget)}),scope.$on("$destroy",function(){$famousPipe.unpipesFromTargets(isolate.renderNode||Engine,scope.$eval(attrs.faPipeFrom))})}}}}}]),angular.module("famous.angular").directive("faPipeTo",["$famous","$famousDecorator","$famousPipe",function($famous,$famousDecorator,$famousPipe){return{restrict:"A",scope:!1,priority:16,compile:function(){var Engine=$famous["famous/core/Engine"];return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);scope.$watch(function(){return scope.$eval(attrs.faPipeTo)},function(newSource,oldSource){var target;target=isolate.renderNode&&isolate.renderNode._isModifier?isolate.renderNode._object:isolate.renderNode?isolate.renderNode._eventOutput||isolate.renderNode:Engine,$famousPipe.unpipesFromTargets(oldSource,target),$famousPipe.pipesToTargets(newSource,target)}),scope.$on("$destroy",function(){$famousPipe.unpipesFromTargets(scope.$eval(attrs.faPipeTo),isolate.renderNode||Engine)})}}}}}]),angular.module("famous.angular").directive("faRenderNode",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",transclude:!0,scope:!0,restrict:"EA",compile:function(tElement,tAttrs,transclude){return{pre:function(scope,element,attrs){{var isolate=$famousDecorator.ensureIsolate(scope),Engine=$famous["famous/core/Engine"];$famous["famous/core/RenderNode"]}isolate.children=[],attrs.$observe("faPipeTo",function(val){var pipeTo=scope.$eval(val);pipeTo&&Engine.pipe(pipeTo)}),isolate.renderNode=scope.$eval(attrs.faNode),$famousDecorator.addRole("renderable",isolate),isolate.show(),$famousDecorator.sequenceWith(scope,function(data){isolate.renderNode.add(data.renderGate),isolate.children.push(data)})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faScrollView",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),ScrollView=$famous["famous/views/Scrollview"],ViewSequence=$famous["famous/core/ViewSequence"],_children=($famous["famous/core/Surface"],[]),options=scope.$eval(attrs.faOptions)||{};isolate.renderNode=new ScrollView(options),$famousDecorator.addRole("renderable",isolate),isolate.show();var updateScrollview=function(init){scope.$$postDigest(function(){_children.sort(function(a,b){return a.index-b.index});var options={array:function(_children){var _ch=[];return angular.forEach(_children,function(c,i){_ch[i]=c.renderGate}),_ch}(_children)};init&&(options.index=scope.$eval(attrs.faStartIndex));var viewSeq=new ViewSequence(options);isolate.renderNode.sequenceFrom(viewSeq)})};$famousDecorator.sequenceWith(scope,function(data){_children.push(data),updateScrollview(!0)},function(childScopeId){_children=function(_children){var _ch=[];return angular.forEach(_children,function(c){c.id!==childScopeId&&_ch.push(c)}),_ch}(_children),updateScrollview()},updateScrollview)},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faSequentialLayout",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){return window.$f=$famous,{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),SequentialLayout=$famous["famous/views/SequentialLayout"],_children=[],options=scope.$eval(attrs.faOptions)||{};isolate.renderNode=new SequentialLayout(options),$famousDecorator.addRole("renderable",isolate),isolate.show();var _updateSequentialLayout=function(){_children.sort(function(a,b){return a.index-b.index}),isolate.renderNode.sequenceFrom(function(_children){var _ch=[];return angular.forEach(_children,function(c,i){_ch[i]=c.renderGate}),_ch}(_children))};$famousDecorator.sequenceWith(scope,function(data){_children.push(data),_updateSequentialLayout()},function(childScopeId){_children=function(_children){var _ch=[];return angular.forEach(_children,function(c){c.id!==childScopeId&&_ch.push(c)}),_ch}(_children),_updateSequentialLayout()})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faSurface",["$famous","$famousDecorator","$interpolate","$controller","$compile",function($famous,$famousDecorator){return{scope:!0,transclude:!0,template:'<div class="fa-surface"></div>',restrict:"EA",compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){{var isolate=$famousDecorator.ensureIsolate(scope),Surface=$famous["famous/core/Surface"];$famous["famous/core/Transform"],$famous["famous/core/EventHandler"]}scope.$watch(function(){return isolate.getProperties()},function(){isolate.renderNode&&isolate.renderNode.setProperties(isolate.getProperties())},!0);var _propToFaProp=function(prop){return"fa"+prop.charAt(0).toUpperCase()+prop.slice(1)};isolate.getProperties=function(){for(var baseProperties=scope.$eval(attrs.faProperties)||{},properties=["backgroundColor","margin","padding","color","pointerEvents","zIndex"],i=0;i<properties.length;i++){var prop=properties[i],faProp=_propToFaProp(prop);attrs[faProp]&&(baseProperties[prop]=scope.$eval(attrs[faProp]))}return baseProperties};var _sizeAnimateTimeStamps=[];attrs.$observe("faSize",function(){isolate.renderNode.setSize(scope.$eval(attrs.faSize)),_sizeAnimateTimeStamps.push(new Date),_sizeAnimateTimeStamps.length>5&&(_sizeAnimateTimeStamps[4]-_sizeAnimateTimeStamps[0]<=1e3&&console.warn("Using fa-size on fa-surface to animate is significantly non-performant, prefer to use fa-size on an fa-modifier surrounding a fa-surface"),_sizeAnimateTimeStamps.shift())}),isolate.renderNode=new Surface({size:scope.$eval(attrs.faSize),properties:isolate.getProperties()}),$famousDecorator.addRole("renderable",isolate),isolate.show(),attrs.class&&isolate.renderNode.setClasses(attrs["class"].split(" ")),$famousDecorator.sequenceWith(scope,function(){throw new Error("Surfaces are leaf nodes of the Famo.us render tree and cannot accept rendernode children.  To include additional Famo.us content inside of a fa-surface, that content must be enclosed in an additional fa-app.")})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope),updateContent=function(){isolate.renderNode.setContent(element[0].querySelector("div.fa-surface"))};updateContent(),transclude(scope,function(clone){angular.element(element[0].querySelectorAll("div.fa-surface")).append(clone)}),$famousDecorator.registerChild(scope,element,isolate,function(){})}}}}}]),angular.module("famous.angular").directive("faTap",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faTap){var renderNode=isolate.renderNode._eventInput||isolate.renderNode,_dragging=!1;renderNode.on("touchmove",function(data){return _dragging=!0,data}),renderNode.on("tap",function(data){if(!_dragging){var fn=$parse(attrs.faTap);fn(scope,{$event:data}),scope.$$phase||scope.$apply()}_dragging=!1})}}}}}}]),angular.module("famous.angular").directive("faTouchend",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faTouchend){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("touchend",function(data){var fn=$parse(attrs.faTouchend);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faTouchmove",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faTouchmove){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("touchmove",function(data){var fn=$parse(attrs.faTouchmove);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faTouchstart",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faTouchstart){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("touchstart",function(data){var fn=$parse(attrs.faTouchstart);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faVideoSurface",["$famous","$famousDecorator",function($famous,$famousDecorator){return{scope:!0,transclude:!0,template:'<div class="fa-video-surface"></div>',restrict:"EA",compile:function(){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),VideoSurface=$famous["famous/surfaces/VideoSurface"];scope.$watch(function(){return scope.$eval(attrs.faOptions)},function(oldVal,newVal){isolate.renderNode.setOptions(newVal)},!0),isolate.renderNode=new VideoSurface({"class":scope.$eval(attrs.class)}),$famousDecorator.addRole("renderable",isolate),isolate.show(),attrs.class&&isolate.renderNode.setClasses(attrs["class"].split(" ")),$famousDecorator.sequenceWith(scope,function(){throw new Error("Surfaces are leaf nodes of the Famo.us render tree and cannot accept rendernode children.  To include additional Famo.us content inside of a fa-surface, that content must be enclosed in an additional fa-app.")})},post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),updateContent=function(){isolate.renderNode.setContent(attrs.faVideoUrl)};updateContent(),attrs.$observe("faVideoUrl",updateContent),$famousDecorator.registerChild(scope,element,isolate)}}}}}]),angular.module("famous.angular").directive("faView",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",transclude:!0,scope:!0,restrict:"EA",compile:function(tElement,tAttrs,transclude){var View=$famous["famous/core/View"];return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);isolate.children=[],isolate.renderNode=new View({size:scope.$eval(attrs.faSize)||[void 0,void 0]}),$famousDecorator.addRole("renderable",isolate),isolate.show(),$famousDecorator.sequenceWith(scope,function(data){isolate.renderNode.add(data.renderGate),isolate.children.push(data)})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),$famousDecorator.registerChild(scope,element,isolate)}}}}}])}.call(global,module,void 0,void 0)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"/Users/willogden/Development/projects/go/src/github.com/willogden/rover/public/vendor/angular/angular.js":12,"/Users/willogden/Development/projects/go/src/github.com/willogden/rover/public/vendor/famous/dist/famous-global.js":14}],14:[function(require,module){(function(global){__browserify_shim_require__=require,function(module,exports,require,define,browserify_shim__define__module__export__){!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.famous=e()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module){function _getElementSize(element){return[element.clientWidth,element.clientHeight]}function Context(container){this.container=container,this._allocator=new ElementAllocator(container),this._node=new RenderNode,this._eventOutput=new EventHandler,this._size=_getElementSize(this.container),this._perspectiveState=new Transitionable(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:Transform.identity,opacity:1,origin:_zeroZero,align:_zeroZero,size:this._size},this._eventOutput.on("resize",function(){this.setSize(_getElementSize(this.container))}.bind(this))}var RenderNode=_dereq_("./RenderNode"),EventHandler=_dereq_("./EventHandler"),ElementAllocator=_dereq_("./ElementAllocator"),Transform=_dereq_("./Transform"),Transitionable=_dereq_("../transitions/Transitionable"),_zeroZero=[0,0],usePrefix=!("perspective"in document.documentElement.style),_setPerspective=usePrefix?function(element,perspective){element.style.webkitPerspective=perspective?perspective.toFixed()+"px":""}:function(element,perspective){element.style.perspective=perspective?perspective.toFixed()+"px":""};Context.prototype.getAllocator=function(){return this._allocator},Context.prototype.add=function(obj){return this._node.add(obj)},Context.prototype.migrate=function(container){container!==this.container&&(this.container=container,this._allocator.migrate(container))},Context.prototype.getSize=function(){return this._size},Context.prototype.setSize=function(size){size||(size=_getElementSize(this.container)),this._size[0]=size[0],this._size[1]=size[1]},Context.prototype.update=function(contextParameters){contextParameters&&(contextParameters.transform&&(this._nodeContext.transform=contextParameters.transform),contextParameters.opacity&&(this._nodeContext.opacity=contextParameters.opacity),contextParameters.origin&&(this._nodeContext.origin=contextParameters.origin),contextParameters.align&&(this._nodeContext.align=contextParameters.align),contextParameters.size&&(this._nodeContext.size=contextParameters.size));var perspective=this._perspectiveState.get();perspective!==this._perspective&&(_setPerspective(this.container,perspective),this._perspective=perspective),this._node.commit(this._nodeContext)},Context.prototype.getPerspective=function(){return this._perspectiveState.get()},Context.prototype.setPerspective=function(perspective,transition,callback){return this._perspectiveState.set(perspective,transition,callback)},Context.prototype.emit=function(type,event){return this._eventOutput.emit(type,event)},Context.prototype.on=function(type,handler){return this._eventOutput.on(type,handler)},Context.prototype.removeListener=function(type,handler){return this._eventOutput.removeListener(type,handler)},Context.prototype.pipe=function(target){return this._eventOutput.pipe(target)},Context.prototype.unpipe=function(target){return this._eventOutput.unpipe(target)},module.exports=Context},{"../transitions/Transitionable":88,"./ElementAllocator":2,"./EventHandler":7,"./RenderNode":11,"./Transform":15}],2:[function(_dereq_,module){function ElementAllocator(container){container||(container=document.createDocumentFragment()),this.container=container,this.detachedNodes={},this.nodeCount=0}ElementAllocator.prototype.migrate=function(container){var oldContainer=this.container;if(container!==oldContainer){if(oldContainer instanceof DocumentFragment)container.appendChild(oldContainer);else for(;oldContainer.hasChildNodes();)container.appendChild(oldContainer.removeChild(oldContainer.firstChild));this.container=container}},ElementAllocator.prototype.allocate=function(type){type=type.toLowerCase(),type in this.detachedNodes||(this.detachedNodes[type]=[]);var result,nodeStore=this.detachedNodes[type];return nodeStore.length>0?result=nodeStore.pop():(result=document.createElement(type),this.container.appendChild(result)),this.nodeCount++,result},ElementAllocator.prototype.deallocate=function(element){var nodeType=element.nodeName.toLowerCase(),nodeStore=this.detachedNodes[nodeType];nodeStore.push(element),this.nodeCount--},ElementAllocator.prototype.getNodeCount=function(){return this.nodeCount},module.exports=ElementAllocator},{}],3:[function(_dereq_,module){function ElementOutput(element){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new EventHandler,this._eventOutput.bindThis(this),this.eventForwarder=function(event){this._eventOutput.emit(event.type,event)}.bind(this),this.id=Entity.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,element&&this.attach(element)}function _addEventListeners(target){for(var i in this._eventOutput.listeners)target.addEventListener(i,this.eventForwarder)}function _removeEventListeners(target){for(var i in this._eventOutput.listeners)target.removeEventListener(i,this.eventForwarder)}function _formatCSSTransform(m){m[12]=Math.round(m[12]*devicePixelRatio)/devicePixelRatio,m[13]=Math.round(m[13]*devicePixelRatio)/devicePixelRatio;for(var result="matrix3d(",i=0;15>i;i++)result+=m[i]<1e-6&&m[i]>-1e-6?"0,":m[i]+",";return result+=m[15]+")"}function _formatCSSOrigin(origin){return 100*origin[0]+"% "+100*origin[1]+"%"}function _xyNotEquals(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var Entity=_dereq_("./Entity"),EventHandler=_dereq_("./EventHandler"),Transform=_dereq_("./Transform"),usePrefix=!("transform"in document.documentElement.style),devicePixelRatio=window.devicePixelRatio||1;ElementOutput.prototype.on=function(type,fn){this._element&&this._element.addEventListener(type,this.eventForwarder),this._eventOutput.on(type,fn)},ElementOutput.prototype.removeListener=function(type,fn){this._eventOutput.removeListener(type,fn)},ElementOutput.prototype.emit=function(type,event){event&&!event.origin&&(event.origin=this);var handled=this._eventOutput.emit(type,event);return handled&&event&&event.stopPropagation&&event.stopPropagation(),handled},ElementOutput.prototype.pipe=function(target){return this._eventOutput.pipe(target)},ElementOutput.prototype.unpipe=function(target){return this._eventOutput.unpipe(target)},ElementOutput.prototype.render=function(){return this.id};var _setMatrix;_setMatrix=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(element,matrix){element.style.zIndex=1e6*matrix[14]|0,element.style.transform=_formatCSSTransform(matrix)}:usePrefix?function(element,matrix){element.style.webkitTransform=_formatCSSTransform(matrix)}:function(element,matrix){element.style.transform=_formatCSSTransform(matrix)};var _setOrigin=usePrefix?function(element,origin){element.style.webkitTransformOrigin=_formatCSSOrigin(origin)}:function(element,origin){element.style.transformOrigin=_formatCSSOrigin(origin)},_setInvisible=usePrefix?function(element){element.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",element.style.opacity=0}:function(element){element.style.transform="scale3d(0.0001,0.0001,0.0001)",element.style.opacity=0};ElementOutput.prototype.commit=function(context){var target=this._element;if(target){{var matrix=context.transform,opacity=context.opacity,origin=context.origin;context.size}if(!matrix&&this._matrix)return this._matrix=null,this._opacity=0,void _setInvisible(target);if(_xyNotEquals(this._origin,origin)&&(this._originDirty=!0),Transform.notEquals(this._matrix,matrix)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==opacity&&(this._opacity=opacity,target.style.opacity=opacity>=1?"0.999999":opacity),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(origin?(this._origin||(this._origin=[0,0]),this._origin[0]=origin[0],this._origin[1]=origin[1]):this._origin=null,_setOrigin(target,this._origin),this._originDirty=!1),matrix||(matrix=Transform.identity),this._matrix=matrix;var aaMatrix=this._size?Transform.thenMove(matrix,[-this._size[0]*origin[0],-this._size[1]*origin[1],0]):matrix;_setMatrix(target,aaMatrix),this._transformDirty=!1}}},ElementOutput.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},ElementOutput.prototype.attach=function(target){this._element=target,_addEventListeners.call(this,target)},ElementOutput.prototype.detach=function(){var target=this._element;return target&&(_removeEventListeners.call(this,target),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,target},module.exports=ElementOutput},{"./Entity":5,"./EventHandler":7,"./Transform":15}],4:[function(_dereq_,module){function loop(){options.runLoop?(Engine.step(),window.requestAnimationFrame(loop)):loopEnabled=!1}function handleResize(){for(var i=0;i<contexts.length;i++)contexts[i].emit("resize");eventHandler.emit("resize")}function initialize(){window.addEventListener("touchmove",function(event){event.preventDefault()},!0),document.body.classList.add("famous-root"),document.documentElement.classList.add("famous-root")}var frameTime,frameTimeLimit,Context=_dereq_("./Context"),EventHandler=_dereq_("./EventHandler"),OptionsManager=_dereq_("./OptionsManager"),Engine={},contexts=[],nextTickQueue=[],deferQueue=[],lastTime=Date.now(),loopEnabled=!0,eventForwarders={},eventHandler=new EventHandler,options={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},optionsManager=new OptionsManager(options),MAX_DEFER_FRAME_TIME=10;Engine.step=function(){var currentTime=Date.now();if(!(frameTimeLimit&&frameTimeLimit>currentTime-lastTime)){var i=0;for(frameTime=currentTime-lastTime,lastTime=currentTime,eventHandler.emit("prerender"),i=0;i<nextTickQueue.length;i++)nextTickQueue[i].call(this);for(nextTickQueue.splice(0);deferQueue.length&&Date.now()-currentTime<MAX_DEFER_FRAME_TIME;)deferQueue.shift().call(this);for(i=0;i<contexts.length;i++)contexts[i].update();eventHandler.emit("postrender")}},window.requestAnimationFrame(loop),window.addEventListener("resize",handleResize,!1),handleResize();var initialized=!1;Engine.pipe=function(target){return target.subscribe instanceof Function?target.subscribe(Engine):eventHandler.pipe(target)},Engine.unpipe=function(target){return target.unsubscribe instanceof Function?target.unsubscribe(Engine):eventHandler.unpipe(target)},Engine.on=function(type,handler){return type in eventForwarders||(eventForwarders[type]=eventHandler.emit.bind(eventHandler,type),document.body?document.body.addEventListener(type,eventForwarders[type]):Engine.nextTick(function(type,forwarder){document.body.addEventListener(type,forwarder)}.bind(this,type,eventForwarders[type]))),eventHandler.on(type,handler)},Engine.emit=function(type,event){return eventHandler.emit(type,event)},Engine.removeListener=function(type,handler){return eventHandler.removeListener(type,handler)},Engine.getFPS=function(){return 1e3/frameTime},Engine.setFPSCap=function(fps){frameTimeLimit=Math.floor(1e3/fps)},Engine.getOptions=function(key){return optionsManager.getOptions(key)},Engine.setOptions=function(){return optionsManager.setOptions.apply(optionsManager,arguments)},Engine.createContext=function(el){!initialized&&options.appMode&&Engine.nextTick(initialize);var needMountContainer=!1;el||(el=document.createElement(options.containerType),el.classList.add(options.containerClass),needMountContainer=!0);var context=new Context(el);return Engine.registerContext(context),needMountContainer&&Engine.nextTick(function(context,el){document.body.appendChild(el),context.emit("resize")}.bind(this,context,el)),context},Engine.registerContext=function(context){return contexts.push(context),context},Engine.getContexts=function(){return contexts},Engine.deregisterContext=function(context){var i=contexts.indexOf(context);i>=0&&contexts.splice(i,1)},Engine.nextTick=function(fn){nextTickQueue.push(fn)},Engine.defer=function(fn){deferQueue.push(fn)},optionsManager.on("change",function(data){"fpsCap"===data.id?Engine.setFPSCap(data.value):"runLoop"===data.id&&!loopEnabled&&data.value&&(loopEnabled=!0,window.requestAnimationFrame(loop))}),module.exports=Engine},{"./Context":1,"./EventHandler":7,"./OptionsManager":10}],5:[function(_dereq_,module){function get(id){return entities[id]}function set(id,entity){entities[id]=entity}function register(entity){var id=entities.length;return set(id,entity),id}function unregister(id){set(id,null)}var entities=[];module.exports={register:register,unregister:unregister,get:get,set:set}},{}],6:[function(_dereq_,module){function EventEmitter(){this.listeners={},this._owner=this}EventEmitter.prototype.emit=function(type,event){var handlers=this.listeners[type];if(handlers)for(var i=0;i<handlers.length;i++)handlers[i].call(this._owner,event);return this},EventEmitter.prototype.on=function(type,handler){type in this.listeners||(this.listeners[type]=[]);var index=this.listeners[type].indexOf(handler);return 0>index&&this.listeners[type].push(handler),this},EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.removeListener=function(type,handler){var listener=this.listeners[type];if(void 0!==listener){var index=listener.indexOf(handler);index>=0&&listener.splice(index,1)
}return this},EventEmitter.prototype.bindThis=function(owner){this._owner=owner},module.exports=EventEmitter},{}],7:[function(_dereq_,module){function EventHandler(){EventEmitter.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var EventEmitter=_dereq_("./EventEmitter");EventHandler.prototype=Object.create(EventEmitter.prototype),EventHandler.prototype.constructor=EventHandler,EventHandler.setInputHandler=function(object,handler){object.trigger=handler.trigger.bind(handler),handler.subscribe&&handler.unsubscribe&&(object.subscribe=handler.subscribe.bind(handler),object.unsubscribe=handler.unsubscribe.bind(handler))},EventHandler.setOutputHandler=function(object,handler){handler instanceof EventHandler&&handler.bindThis(object),object.pipe=handler.pipe.bind(handler),object.unpipe=handler.unpipe.bind(handler),object.on=handler.on.bind(handler),object.addListener=object.on,object.removeListener=handler.removeListener.bind(handler)},EventHandler.prototype.emit=function(type,event){EventEmitter.prototype.emit.apply(this,arguments);var i=0;for(i=0;i<this.downstream.length;i++)this.downstream[i].trigger&&this.downstream[i].trigger(type,event);for(i=0;i<this.downstreamFn.length;i++)this.downstreamFn[i](type,event);return this},EventHandler.prototype.trigger=EventHandler.prototype.emit,EventHandler.prototype.pipe=function(target){if(target.subscribe instanceof Function)return target.subscribe(this);var downstreamCtx=target instanceof Function?this.downstreamFn:this.downstream,index=downstreamCtx.indexOf(target);return 0>index&&downstreamCtx.push(target),target instanceof Function?target("pipe",null):target.trigger&&target.trigger("pipe",null),target},EventHandler.prototype.unpipe=function(target){if(target.unsubscribe instanceof Function)return target.unsubscribe(this);var downstreamCtx=target instanceof Function?this.downstreamFn:this.downstream,index=downstreamCtx.indexOf(target);return index>=0?(downstreamCtx.splice(index,1),target instanceof Function?target("unpipe",null):target.trigger&&target.trigger("unpipe",null),target):!1},EventHandler.prototype.on=function(type){if(EventEmitter.prototype.on.apply(this,arguments),!(type in this.upstreamListeners)){var upstreamListener=this.trigger.bind(this,type);this.upstreamListeners[type]=upstreamListener;for(var i=0;i<this.upstream.length;i++)this.upstream[i].on(type,upstreamListener)}return this},EventHandler.prototype.addListener=EventHandler.prototype.on,EventHandler.prototype.subscribe=function(source){var index=this.upstream.indexOf(source);if(0>index){this.upstream.push(source);for(var type in this.upstreamListeners)source.on(type,this.upstreamListeners[type])}return this},EventHandler.prototype.unsubscribe=function(source){var index=this.upstream.indexOf(source);if(index>=0){this.upstream.splice(index,1);for(var type in this.upstreamListeners)source.removeListener(type,this.upstreamListeners[type])}return this},module.exports=EventHandler},{"./EventEmitter":6}],8:[function(_dereq_,module){function Group(options){Surface.call(this,options),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new Context(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var Context=_dereq_("./Context"),Transform=_dereq_("./Transform"),Surface=_dereq_("./Surface");Group.SIZE_ZERO=[0,0],Group.prototype=Object.create(Surface.prototype),Group.prototype.elementType="div",Group.prototype.elementClass="famous-group",Group.prototype.add=function(){return this.context.add.apply(this.context,arguments)},Group.prototype.render=function(){return Surface.prototype.render.call(this)},Group.prototype.deploy=function(target){this.context.migrate(target)},Group.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},Group.prototype.commit=function(context){var transform=context.transform,origin=context.origin,opacity=context.opacity,size=context.size,result=Surface.prototype.commit.call(this,{allocator:context.allocator,transform:Transform.thenMove(transform,[-origin[0]*size[0],-origin[1]*size[1],0]),opacity:opacity,origin:origin,size:Group.SIZE_ZERO});return(size[0]!==this._groupSize[0]||size[1]!==this._groupSize[1])&&(this._groupSize[0]=size[0],this._groupSize[1]=size[1],this.context.setSize(size)),this.context.update({transform:Transform.translate(-origin[0]*size[0],-origin[1]*size[1],0),origin:origin,size:size}),result},module.exports=Group},{"./Context":1,"./Surface":14,"./Transform":15}],9:[function(_dereq_,module){function Modifier(options){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:Transform.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},options&&(options.transform&&this.transformFrom(options.transform),void 0!==options.opacity&&this.opacityFrom(options.opacity),options.origin&&this.originFrom(options.origin),options.align&&this.alignFrom(options.align),options.size&&this.sizeFrom(options.size),options.proportions&&this.proportionsFrom(options.proportions))}function _update(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var Transform=_dereq_("./Transform"),Transitionable=_dereq_("../transitions/Transitionable"),TransitionableTransform=_dereq_("../transitions/TransitionableTransform");Modifier.prototype.transformFrom=function(transform){return transform instanceof Function?this._transformGetter=transform:transform instanceof Object&&transform.get?this._transformGetter=transform.get.bind(transform):(this._transformGetter=null,this._output.transform=transform),this},Modifier.prototype.opacityFrom=function(opacity){return opacity instanceof Function?this._opacityGetter=opacity:opacity instanceof Object&&opacity.get?this._opacityGetter=opacity.get.bind(opacity):(this._opacityGetter=null,this._output.opacity=opacity),this},Modifier.prototype.originFrom=function(origin){return origin instanceof Function?this._originGetter=origin:origin instanceof Object&&origin.get?this._originGetter=origin.get.bind(origin):(this._originGetter=null,this._output.origin=origin),this},Modifier.prototype.alignFrom=function(align){return align instanceof Function?this._alignGetter=align:align instanceof Object&&align.get?this._alignGetter=align.get.bind(align):(this._alignGetter=null,this._output.align=align),this},Modifier.prototype.sizeFrom=function(size){return size instanceof Function?this._sizeGetter=size:size instanceof Object&&size.get?this._sizeGetter=size.get.bind(size):(this._sizeGetter=null,this._output.size=size),this},Modifier.prototype.proportionsFrom=function(proportions){return proportions instanceof Function?this._proportionGetter=proportions:proportions instanceof Object&&proportions.get?this._proportionGetter=proportions.get.bind(proportions):(this._proportionGetter=null,this._output.proportions=proportions),this},Modifier.prototype.setTransform=function(transform,transition,callback){return transition||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new TransitionableTransform(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(transform,transition,callback),this):this.transformFrom(transform)},Modifier.prototype.setOpacity=function(opacity,transition,callback){return transition||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new Transitionable(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(opacity,transition,callback)):this.opacityFrom(opacity)},Modifier.prototype.setOrigin=function(origin,transition,callback){return transition||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new Transitionable(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(origin,transition,callback),this):this.originFrom(origin)},Modifier.prototype.setAlign=function(align,transition,callback){return transition||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new Transitionable(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(align,transition,callback),this):this.alignFrom(align)},Modifier.prototype.setSize=function(size,transition,callback){return size&&(transition||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new Transitionable(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(size,transition,callback),this):this.sizeFrom(size)},Modifier.prototype.setProportions=function(proportions,transition,callback){return proportions&&(transition||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new Transitionable(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(proportions,transition,callback),this):this.proportionsFrom(proportions)},Modifier.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},Modifier.prototype.getTransform=function(){return this._transformGetter()},Modifier.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},Modifier.prototype.getOpacity=function(){return this._opacityGetter()},Modifier.prototype.getOrigin=function(){return this._originGetter()},Modifier.prototype.getAlign=function(){return this._alignGetter()},Modifier.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},Modifier.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},Modifier.prototype.modify=function(target){return _update.call(this),this._output.target=target,this._output},module.exports=Modifier},{"../transitions/Transitionable":88,"../transitions/TransitionableTransform":89,"./Transform":15}],10:[function(_dereq_,module){function OptionsManager(value){this._value=value,this.eventOutput=null}function _createEventOutput(){this.eventOutput=new EventHandler,this.eventOutput.bindThis(this),EventHandler.setOutputHandler(this,this.eventOutput)}var EventHandler=_dereq_("./EventHandler");OptionsManager.patch=function(source){for(var manager=new OptionsManager(source),i=1;i<arguments.length;i++)manager.patch(arguments[i]);return source},OptionsManager.prototype.patch=function(){for(var myState=this._value,i=0;i<arguments.length;i++){var data=arguments[i];for(var k in data)k in myState&&data[k]&&data[k].constructor===Object&&myState[k]&&myState[k].constructor===Object?(myState.hasOwnProperty(k)||(myState[k]=Object.create(myState[k])),this.key(k).patch(data[k]),this.eventOutput&&this.eventOutput.emit("change",{id:k,value:this.key(k).value()})):this.set(k,data[k])}return this},OptionsManager.prototype.setOptions=OptionsManager.prototype.patch,OptionsManager.prototype.key=function(identifier){var result=new OptionsManager(this._value[identifier]);return(!(result._value instanceof Object)||result._value instanceof Array)&&(result._value={}),result},OptionsManager.prototype.get=function(key){return key?this._value[key]:this._value},OptionsManager.prototype.getOptions=OptionsManager.prototype.get,OptionsManager.prototype.set=function(key,value){var originalValue=this.get(key);return this._value[key]=value,this.eventOutput&&value!==originalValue&&this.eventOutput.emit("change",{id:key,value:value}),this},OptionsManager.prototype.on=function(){return _createEventOutput.call(this),this.on.apply(this,arguments)},OptionsManager.prototype.removeListener=function(){return _createEventOutput.call(this),this.removeListener.apply(this,arguments)},OptionsManager.prototype.pipe=function(){return _createEventOutput.call(this),this.pipe.apply(this,arguments)},OptionsManager.prototype.unpipe=function(){return _createEventOutput.call(this),this.unpipe.apply(this,arguments)},module.exports=OptionsManager},{"./EventHandler":7}],11:[function(_dereq_,module){function RenderNode(object){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,object&&this.set(object)}function _applyCommit(spec,context,cacheStorage){for(var result=SpecParser.parse(spec,context),keys=Object.keys(result),i=0;i<keys.length;i++){var id=keys[i],childNode=Entity.get(id),commitParams=result[id];commitParams.allocator=context.allocator;var commitResult=childNode.commit(commitParams);commitResult?_applyCommit(commitResult,context,cacheStorage):cacheStorage[id]=commitParams}}var Entity=_dereq_("./Entity"),SpecParser=_dereq_("./SpecParser");RenderNode.prototype.add=function(child){var childNode=child instanceof RenderNode?child:new RenderNode(child);return this._child instanceof Array?this._child.push(childNode):this._child?(this._child=[this._child,childNode],this._hasMultipleChildren=!0,this._childResult=[]):this._child=childNode,childNode},RenderNode.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},RenderNode.prototype.set=function(child){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=child.render?!0:!1,this._isModifier=child.modify?!0:!1,this._object=child,this._child=null,child instanceof RenderNode?child:this},RenderNode.prototype.getSize=function(){var result=null,target=this.get();return target&&target.getSize&&(result=target.getSize()),!result&&this._child&&this._child.getSize&&(result=this._child.getSize()),result},RenderNode.prototype.commit=function(context){for(var prevKeys=Object.keys(this._prevResults),i=0;i<prevKeys.length;i++){var id=prevKeys[i];if(void 0===this._resultCache[id]){var object=Entity.get(id);object.cleanup&&object.cleanup(context.allocator)}}this._prevResults=this._resultCache,this._resultCache={},_applyCommit(this.render(),context,this._resultCache)},RenderNode.prototype.render=function(){if(this._isRenderable)return this._object.render();var result=null;if(this._hasMultipleChildren){result=this._childResult;for(var children=this._child,i=0;i<children.length;i++)result[i]=children[i].render()}else this._child&&(result=this._child.render());return this._isModifier?this._object.modify(result):result},module.exports=RenderNode},{"./Entity":5,"./SpecParser":13}],12:[function(_dereq_,module){function Scene(definition){this.id=null,this._objects=null,this.node=new RenderNode,this._definition=null,definition&&this.load(definition)}function _resolveTransformMatrix(matrixDefinition){for(var type in _MATRIX_GENERATORS)if(type in matrixDefinition){var args=matrixDefinition[type];return args instanceof Array||(args=[args]),_MATRIX_GENERATORS[type].apply(this,args)}}function _parseTransform(definition){var transformDefinition=definition.transform,opacity=definition.opacity,origin=definition.origin,align=definition.align,size=definition.size,transform=Transform.identity;if(transformDefinition instanceof Array)if(16===transformDefinition.length&&"number"==typeof transformDefinition[0])transform=transformDefinition;else for(var i=0;i<transformDefinition.length;i++)transform=Transform.multiply(transform,_resolveTransformMatrix(transformDefinition[i]));else transformDefinition instanceof Function?transform=transformDefinition:transformDefinition instanceof Object&&(transform=_resolveTransformMatrix(transformDefinition));var result=new Modifier({transform:transform,opacity:opacity,origin:origin,align:align,size:size});return result}function _parseArray(definition){for(var result=new RenderNode,i=0;i<definition.length;i++){var obj=_parse.call(this,definition[i]);obj&&result.add(obj)}return result}function _parse(definition){var result,id;if(definition instanceof Array)result=_parseArray.call(this,definition);else if(id=this._objects.length,definition.render&&definition.render instanceof Function)result=definition;else if(definition.target){var targetObj=_parse.call(this,definition.target),obj=_parseTransform.call(this,definition);result=new RenderNode(obj),result.add(targetObj),definition.id&&(this.id[definition.id]=obj)}else definition.id&&(result=new RenderNode,this.id[definition.id]=result);return this._objects[id]=result,result}var Transform=_dereq_("./Transform"),Modifier=_dereq_("./Modifier"),RenderNode=_dereq_("./RenderNode"),_MATRIX_GENERATORS={translate:Transform.translate,rotate:Transform.rotate,rotateX:Transform.rotateX,rotateY:Transform.rotateY,rotateZ:Transform.rotateZ,rotateAxis:Transform.rotateAxis,scale:Transform.scale,skew:Transform.skew,matrix3d:function(){return arguments}};Scene.prototype.create=function(){return new Scene(this._definition)},Scene.prototype.load=function(definition){this._definition=definition,this.id={},this._objects=[],this.node.set(_parse.call(this,definition))},Scene.prototype.add=function(){return this.node.add.apply(this.node,arguments)},Scene.prototype.render=function(){return this.node.render.apply(this.node,arguments)},module.exports=Scene},{"./Modifier":9,"./RenderNode":11,"./Transform":15}],13:[function(_dereq_,module){function SpecParser(){this.result={}}function _vecInContext(v,m){return[v[0]*m[0]+v[1]*m[4]+v[2]*m[8],v[0]*m[1]+v[1]*m[5]+v[2]*m[9],v[0]*m[2]+v[1]*m[6]+v[2]*m[10]]}var Transform=_dereq_("./Transform");SpecParser._instance=new SpecParser,SpecParser.parse=function(spec,context){return SpecParser._instance.parse(spec,context)},SpecParser.prototype.parse=function(spec,context){return this.reset(),this._parseSpec(spec,context,Transform.identity),this.result},SpecParser.prototype.reset=function(){this.result={}};var _zeroZero=[0,0];SpecParser.prototype._parseSpec=function(spec,parentContext,sizeContext){var id,target,transform,opacity,origin,align,size;if("number"==typeof spec){if(id=spec,transform=parentContext.transform,align=parentContext.align||_zeroZero,parentContext.size&&align&&(align[0]||align[1])){var alignAdjust=[align[0]*parentContext.size[0],align[1]*parentContext.size[1],0];transform=Transform.thenMove(transform,_vecInContext(alignAdjust,sizeContext))}this.result[id]={transform:transform,opacity:parentContext.opacity,origin:parentContext.origin||_zeroZero,align:parentContext.align||_zeroZero,size:parentContext.size}}else{if(!spec)return;if(spec instanceof Array)for(var i=0;i<spec.length;i++)this._parseSpec(spec[i],parentContext,sizeContext);else{target=spec.target,transform=parentContext.transform,opacity=parentContext.opacity,origin=parentContext.origin,align=parentContext.align,size=parentContext.size;var nextSizeContext=sizeContext;if(void 0!==spec.opacity&&(opacity=parentContext.opacity*spec.opacity),spec.transform&&(transform=Transform.multiply(parentContext.transform,spec.transform)),spec.origin&&(origin=spec.origin,nextSizeContext=parentContext.transform),spec.align&&(align=spec.align),spec.size||spec.proportions){var parentSize=size;size=[size[0],size[1]],spec.size&&(void 0!==spec.size[0]&&(size[0]=spec.size[0]),void 0!==spec.size[1]&&(size[1]=spec.size[1])),spec.proportions&&(void 0!==spec.proportions[0]&&(size[0]=size[0]*spec.proportions[0]),void 0!==spec.proportions[1]&&(size[1]=size[1]*spec.proportions[1])),parentSize&&(align&&(align[0]||align[1])&&(transform=Transform.thenMove(transform,_vecInContext([align[0]*parentSize[0],align[1]*parentSize[1],0],sizeContext))),origin&&(origin[0]||origin[1])&&(transform=Transform.moveThen([-origin[0]*size[0],-origin[1]*size[1],0],transform))),nextSizeContext=parentContext.transform,origin=null,align=null}this._parseSpec(target,{transform:transform,opacity:opacity,origin:origin,align:align,size:size},nextSizeContext)}}},module.exports=SpecParser},{"./Transform":15}],14:[function(_dereq_,module){function Surface(options){ElementOutput.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],options&&this.setOptions(options),this._currentTarget=null}function _cleanupClasses(target){for(var i=0;i<this._dirtyClasses.length;i++)target.classList.remove(this._dirtyClasses[i]);this._dirtyClasses=[]}function _applyStyles(target){for(var n in this.properties)target.style[n]=this.properties[n]}function _cleanupStyles(target){for(var n in this.properties)target.style[n]=""}function _applyAttributes(target){for(var n in this.attributes)target.setAttribute(n,this.attributes[n])}function _cleanupAttributes(target){for(var n in this.attributes)target.removeAttribute(n)}function _xyNotEquals(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var ElementOutput=_dereq_("./ElementOutput");Surface.prototype=Object.create(ElementOutput.prototype),Surface.prototype.constructor=Surface,Surface.prototype.elementType="div",Surface.prototype.elementClass="famous-surface",Surface.prototype.setAttributes=function(attributes){for(var n in attributes){if("style"===n)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[n]=attributes[n]}this._attributesDirty=!0},Surface.prototype.getAttributes=function(){return this.attributes},Surface.prototype.setProperties=function(properties){for(var n in properties)this.properties[n]=properties[n];return this._stylesDirty=!0,this},Surface.prototype.getProperties=function(){return this.properties},Surface.prototype.addClass=function(className){return this.classList.indexOf(className)<0&&(this.classList.push(className),this._classesDirty=!0),this},Surface.prototype.removeClass=function(className){var i=this.classList.indexOf(className);return i>=0&&(this._dirtyClasses.push(this.classList.splice(i,1)[0]),this._classesDirty=!0),this},Surface.prototype.toggleClass=function(className){var i=this.classList.indexOf(className);return i>=0?this.removeClass(className):this.addClass(className),this},Surface.prototype.setClasses=function(classList){var i=0,removal=[];for(i=0;i<this.classList.length;i++)classList.indexOf(this.classList[i])<0&&removal.push(this.classList[i]);for(i=0;i<removal.length;i++)this.removeClass(removal[i]);for(i=0;i<classList.length;i++)this.addClass(classList[i]);return this},Surface.prototype.getClassList=function(){return this.classList},Surface.prototype.setContent=function(content){return this.content!==content&&(this.content=content,this._contentDirty=!0),this},Surface.prototype.getContent=function(){return this.content},Surface.prototype.setOptions=function(options){return options.size&&this.setSize(options.size),options.classes&&this.setClasses(options.classes),options.properties&&this.setProperties(options.properties),options.attributes&&this.setAttributes(options.attributes),options.content&&this.setContent(options.content),this},Surface.prototype.setup=function(allocator){var target=allocator.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)target.classList.add(this.elementClass[i]);else target.classList.add(this.elementClass);target.style.display="",this.attach(target),this._opacity=null,this._currentTarget=target,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},Surface.prototype.commit=function(context){this._currentTarget||this.setup(context.allocator);var target=this._currentTarget,size=context.size;if(this._classesDirty){_cleanupClasses.call(this,target);for(var classList=this.getClassList(),i=0;i<classList.length;i++)target.classList.add(classList[i]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(_applyStyles.call(this,target),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(_applyAttributes.call(this,target),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var origSize=context.size;if(size=[this.size[0],this.size[1]],void 0===size[0]&&(size[0]=origSize[0]),void 0===size[1]&&(size[1]=origSize[1]),size[0]===!0||size[1]===!0){if(size[0]!==!0||!this._trueSizeCheck&&0!==this._size[0])this._size&&(size[0]=this._size[0]);else{var width=target.offsetWidth;this._size&&this._size[0]!==width&&(this._size[0]=width,this._sizeDirty=!0),size[0]=width}if(size[1]!==!0||!this._trueSizeCheck&&0!==this._size[1])this._size&&(size[1]=this._size[1]);else{var height=target.offsetHeight;this._size&&this._size[1]!==height&&(this._size[1]=height,this._sizeDirty=!0),size[1]=height}this._trueSizeCheck=!1}}_xyNotEquals(this._size,size)&&(this._size||(this._size=[0,0]),this._size[0]=size[0],this._size[1]=size[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(target.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",target.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(target),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),ElementOutput.prototype.commit.call(this,context)},Surface.prototype.cleanup=function(allocator){var i=0,target=this._currentTarget;this._eventOutput.emit("recall"),this.recall(target),target.style.display="none",target.style.opacity="",target.style.width="",target.style.height="",_cleanupStyles.call(this,target),_cleanupAttributes.call(this,target);var classList=this.getClassList();for(_cleanupClasses.call(this,target),i=0;i<classList.length;i++)target.classList.remove(classList[i]);if(this.elementClass)if(this.elementClass instanceof Array)for(i=0;i<this.elementClass.length;i++)target.classList.remove(this.elementClass[i]);else target.classList.remove(this.elementClass);this.detach(target),this._currentTarget=null,allocator.deallocate(target)},Surface.prototype.deploy=function(target){var content=this.getContent();if(content instanceof Node){for(;target.hasChildNodes();)target.removeChild(target.firstChild);target.appendChild(content)}else target.innerHTML=content},Surface.prototype.recall=function(target){for(var df=document.createDocumentFragment();target.hasChildNodes();)df.appendChild(target.firstChild);this.setContent(df)},Surface.prototype.getSize=function(){return this._size?this._size:this.size},Surface.prototype.setSize=function(size){return this.size=size?[size[0],size[1]]:null,this._sizeDirty=!0,this},module.exports=Surface},{"./ElementOutput":3}],15:[function(_dereq_,module){function _normSquared(v){return 2===v.length?v[0]*v[0]+v[1]*v[1]:v[0]*v[0]+v[1]*v[1]+v[2]*v[2]}function _norm(v){return Math.sqrt(_normSquared(v))}function _sign(n){return 0>n?-1:1}var Transform={};Transform.precision=1e-6,Transform.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Transform.multiply4x4=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]},Transform.multiply=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2],a[1]*b[0]+a[5]*b[1]+a[9]*b[2],a[2]*b[0]+a[6]*b[1]+a[10]*b[2],0,a[0]*b[4]+a[4]*b[5]+a[8]*b[6],a[1]*b[4]+a[5]*b[5]+a[9]*b[6],a[2]*b[4]+a[6]*b[5]+a[10]*b[6],0,a[0]*b[8]+a[4]*b[9]+a[8]*b[10],a[1]*b[8]+a[5]*b[9]+a[9]*b[10],a[2]*b[8]+a[6]*b[9]+a[10]*b[10],0,a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14],1]},Transform.thenMove=function(m,t){return t[2]||(t[2]=0),[m[0],m[1],m[2],0,m[4],m[5],m[6],0,m[8],m[9],m[10],0,m[12]+t[0],m[13]+t[1],m[14]+t[2],1]},Transform.moveThen=function(v,m){v[2]||(v[2]=0);var t0=v[0]*m[0]+v[1]*m[4]+v[2]*m[8],t1=v[0]*m[1]+v[1]*m[5]+v[2]*m[9],t2=v[0]*m[2]+v[1]*m[6]+v[2]*m[10];return Transform.thenMove(m,[t0,t1,t2])},Transform.translate=function(x,y,z){return void 0===z&&(z=0),[1,0,0,0,0,1,0,0,0,0,1,0,x,y,z,1]},Transform.thenScale=function(m,s){return[s[0]*m[0],s[1]*m[1],s[2]*m[2],0,s[0]*m[4],s[1]*m[5],s[2]*m[6],0,s[0]*m[8],s[1]*m[9],s[2]*m[10],0,s[0]*m[12],s[1]*m[13],s[2]*m[14],1]},Transform.scale=function(x,y,z){return void 0===z&&(z=1),void 0===y&&(y=x),[x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1]},Transform.rotateX=function(theta){var cosTheta=Math.cos(theta),sinTheta=Math.sin(theta);return[1,0,0,0,0,cosTheta,sinTheta,0,0,-sinTheta,cosTheta,0,0,0,0,1]},Transform.rotateY=function(theta){var cosTheta=Math.cos(theta),sinTheta=Math.sin(theta);return[cosTheta,0,-sinTheta,0,0,1,0,0,sinTheta,0,cosTheta,0,0,0,0,1]},Transform.rotateZ=function(theta){var cosTheta=Math.cos(theta),sinTheta=Math.sin(theta);return[cosTheta,sinTheta,0,0,-sinTheta,cosTheta,0,0,0,0,1,0,0,0,0,1]},Transform.rotate=function(phi,theta,psi){var cosPhi=Math.cos(phi),sinPhi=Math.sin(phi),cosTheta=Math.cos(theta),sinTheta=Math.sin(theta),cosPsi=Math.cos(psi),sinPsi=Math.sin(psi),result=[cosTheta*cosPsi,cosPhi*sinPsi+sinPhi*sinTheta*cosPsi,sinPhi*sinPsi-cosPhi*sinTheta*cosPsi,0,-cosTheta*sinPsi,cosPhi*cosPsi-sinPhi*sinTheta*sinPsi,sinPhi*cosPsi+cosPhi*sinTheta*sinPsi,0,sinTheta,-sinPhi*cosTheta,cosPhi*cosTheta,0,0,0,0,1];return result},Transform.rotateAxis=function(v,theta){var sinTheta=Math.sin(theta),cosTheta=Math.cos(theta),verTheta=1-cosTheta,xxV=v[0]*v[0]*verTheta,xyV=v[0]*v[1]*verTheta,xzV=v[0]*v[2]*verTheta,yyV=v[1]*v[1]*verTheta,yzV=v[1]*v[2]*verTheta,zzV=v[2]*v[2]*verTheta,xs=v[0]*sinTheta,ys=v[1]*sinTheta,zs=v[2]*sinTheta,result=[xxV+cosTheta,xyV+zs,xzV-ys,0,xyV-zs,yyV+cosTheta,yzV+xs,0,xzV+ys,yzV-xs,zzV+cosTheta,0,0,0,0,1];return result},Transform.aboutOrigin=function(v,m){var t0=v[0]-(v[0]*m[0]+v[1]*m[4]+v[2]*m[8]),t1=v[1]-(v[0]*m[1]+v[1]*m[5]+v[2]*m[9]),t2=v[2]-(v[0]*m[2]+v[1]*m[6]+v[2]*m[10]);return Transform.thenMove(m,[t0,t1,t2])},Transform.skew=function(phi,theta,psi){return[1,Math.tan(theta),0,0,Math.tan(psi),1,0,0,0,Math.tan(phi),1,0,0,0,0,1]},Transform.skewX=function(angle){return[1,0,0,0,Math.tan(angle),1,0,0,0,0,1,0,0,0,0,1]},Transform.skewY=function(angle){return[1,Math.tan(angle),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Transform.perspective=function(focusZ){return[1,0,0,0,0,1,0,0,0,0,1,-1/focusZ,0,0,0,1]},Transform.getTranslate=function(m){return[m[12],m[13],m[14]]},Transform.inverse=function(m){var c0=m[5]*m[10]-m[6]*m[9],c1=m[4]*m[10]-m[6]*m[8],c2=m[4]*m[9]-m[5]*m[8],c4=m[1]*m[10]-m[2]*m[9],c5=m[0]*m[10]-m[2]*m[8],c6=m[0]*m[9]-m[1]*m[8],c8=m[1]*m[6]-m[2]*m[5],c9=m[0]*m[6]-m[2]*m[4],c10=m[0]*m[5]-m[1]*m[4],detM=m[0]*c0-m[1]*c1+m[2]*c2,invD=1/detM,result=[invD*c0,-invD*c4,invD*c8,0,-invD*c1,invD*c5,-invD*c9,0,invD*c2,-invD*c6,invD*c10,0,0,0,0,1];
return result[12]=-m[12]*result[0]-m[13]*result[4]-m[14]*result[8],result[13]=-m[12]*result[1]-m[13]*result[5]-m[14]*result[9],result[14]=-m[12]*result[2]-m[13]*result[6]-m[14]*result[10],result},Transform.transpose=function(m){return[m[0],m[4],m[8],m[12],m[1],m[5],m[9],m[13],m[2],m[6],m[10],m[14],m[3],m[7],m[11],m[15]]},Transform.interpret=function(M){var x=[M[0],M[1],M[2]],sgn=_sign(x[0]),xNorm=_norm(x),v=[x[0]+sgn*xNorm,x[1],x[2]],mult=2/_normSquared(v);if(mult>=1/0)return{translate:Transform.getTranslate(M),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var Q1=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];Q1[0]=1-mult*v[0]*v[0],Q1[5]=1-mult*v[1]*v[1],Q1[10]=1-mult*v[2]*v[2],Q1[1]=-mult*v[0]*v[1],Q1[2]=-mult*v[0]*v[2],Q1[6]=-mult*v[1]*v[2],Q1[4]=Q1[1],Q1[8]=Q1[2],Q1[9]=Q1[6];var MQ1=Transform.multiply(Q1,M),x2=[MQ1[5],MQ1[6]],sgn2=_sign(x2[0]),x2Norm=_norm(x2),v2=[x2[0]+sgn2*x2Norm,x2[1]],mult2=2/_normSquared(v2),Q2=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];Q2[5]=1-mult2*v2[0]*v2[0],Q2[10]=1-mult2*v2[1]*v2[1],Q2[6]=-mult2*v2[0]*v2[1],Q2[9]=Q2[6];var Q=Transform.multiply(Q2,Q1),R=Transform.multiply(Q,M),remover=Transform.scale(R[0]<0?-1:1,R[5]<0?-1:1,R[10]<0?-1:1);R=Transform.multiply(R,remover),Q=Transform.multiply(remover,Q);var result={};return result.translate=Transform.getTranslate(M),result.rotate=[Math.atan2(-Q[6],Q[10]),Math.asin(Q[2]),Math.atan2(-Q[1],Q[0])],result.rotate[0]||(result.rotate[0]=0,result.rotate[2]=Math.atan2(Q[4],Q[5])),result.scale=[R[0],R[5],R[10]],result.skew=[Math.atan2(R[9],result.scale[2]),Math.atan2(R[8],result.scale[2]),Math.atan2(R[4],result.scale[0])],Math.abs(result.rotate[0])+Math.abs(result.rotate[2])>1.5*Math.PI&&(result.rotate[1]=Math.PI-result.rotate[1],result.rotate[1]>Math.PI&&(result.rotate[1]-=2*Math.PI),result.rotate[1]<-Math.PI&&(result.rotate[1]+=2*Math.PI),result.rotate[0]<0?result.rotate[0]+=Math.PI:result.rotate[0]-=Math.PI,result.rotate[2]<0?result.rotate[2]+=Math.PI:result.rotate[2]-=Math.PI),result},Transform.average=function(M1,M2,t){t=void 0===t?.5:t;for(var specM1=Transform.interpret(M1),specM2=Transform.interpret(M2),specAvg={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},i=0;3>i;i++)specAvg.translate[i]=(1-t)*specM1.translate[i]+t*specM2.translate[i],specAvg.rotate[i]=(1-t)*specM1.rotate[i]+t*specM2.rotate[i],specAvg.scale[i]=(1-t)*specM1.scale[i]+t*specM2.scale[i],specAvg.skew[i]=(1-t)*specM1.skew[i]+t*specM2.skew[i];return Transform.build(specAvg)},Transform.build=function(spec){var scaleMatrix=Transform.scale(spec.scale[0],spec.scale[1],spec.scale[2]),skewMatrix=Transform.skew(spec.skew[0],spec.skew[1],spec.skew[2]),rotateMatrix=Transform.rotate(spec.rotate[0],spec.rotate[1],spec.rotate[2]);return Transform.thenMove(Transform.multiply(Transform.multiply(rotateMatrix,skewMatrix),scaleMatrix),spec.translate)},Transform.equals=function(a,b){return!Transform.notEquals(a,b)},Transform.notEquals=function(a,b){return a===b?!1:!(a&&b)||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]},Transform.normalizeRotation=function(rotation){var result=rotation.slice(0);for((result[0]===.5*Math.PI||result[0]===.5*-Math.PI)&&(result[0]=-result[0],result[1]=Math.PI-result[1],result[2]-=Math.PI),result[0]>.5*Math.PI&&(result[0]=result[0]-Math.PI,result[1]=Math.PI-result[1],result[2]-=Math.PI),result[0]<.5*-Math.PI&&(result[0]=result[0]+Math.PI,result[1]=-Math.PI-result[1],result[2]-=Math.PI);result[1]<-Math.PI;)result[1]+=2*Math.PI;for(;result[1]>=Math.PI;)result[1]-=2*Math.PI;for(;result[2]<-Math.PI;)result[2]+=2*Math.PI;for(;result[2]>=Math.PI;)result[2]-=2*Math.PI;return result},Transform.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],Transform.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],module.exports=Transform},{}],16:[function(_dereq_,module){function View(options){this._node=new RenderNode,this._eventInput=new EventHandler,this._eventOutput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput),this.options=Utility.clone(this.constructor.DEFAULT_OPTIONS||View.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options)}var EventHandler=_dereq_("./EventHandler"),OptionsManager=_dereq_("./OptionsManager"),RenderNode=_dereq_("./RenderNode"),Utility=_dereq_("../utilities/Utility");View.DEFAULT_OPTIONS={},View.prototype.getOptions=function(key){return this._optionsManager.getOptions(key)},View.prototype.setOptions=function(options){this._optionsManager.patch(options)},View.prototype.add=function(){return this._node.add.apply(this._node,arguments)},View.prototype._add=View.prototype.add,View.prototype.render=function(){return this._node.render()},View.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},module.exports=View},{"../utilities/Utility":95,"./EventHandler":7,"./OptionsManager":10,"./RenderNode":11}],17:[function(_dereq_,module){function ViewSequence(options){options||(options=[]),options instanceof Array&&(options={array:options}),this._=null,this.index=options.index||0,options.array?this._=new this.constructor.Backing(options.array):options._&&(this._=options._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==options.loop&&(this._.loop=options.loop),void 0!==options.trackSize&&(this._.trackSize=options.trackSize),this._previousNode=null,this._nextNode=null}ViewSequence.Backing=function(array){this.array=array,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},ViewSequence.Backing.prototype.getValue=function(i){var _i=i-this.firstIndex;return 0>_i||_i>=this.array.length?null:this.array[_i]},ViewSequence.Backing.prototype.setValue=function(i,value){this.array[i-this.firstIndex]=value},ViewSequence.Backing.prototype.getSize=function(index){return this.cumulativeSizes[index]},ViewSequence.Backing.prototype.calculateSize=function(index){index=index||this.array.length;for(var size=[0,0],i=0;index>i;i++){var nodeSize=this.array[i].getSize();if(!nodeSize)return void 0;void 0!==size[0]&&(void 0===nodeSize[0]?size[0]=void 0:size[0]+=nodeSize[0]),void 0!==size[1]&&(void 0===nodeSize[1]?size[1]=void 0:size[1]+=nodeSize[1]),this.cumulativeSizes[i+1]=size.slice()}return this.sizeDirty=!1,size},ViewSequence.Backing.prototype.reindex=function(start,removeCount,insertCount){if(this.array[0]){for(var i=0,index=this.firstIndex,indexShiftAmount=insertCount-removeCount,node=this.firstNode;start-1>index;)node=node.getNext(),index++;var spliceStartNode=node;for(i=0;removeCount>i;i++)node=node.getNext(),node&&(node._previousNode=spliceStartNode);var spliceResumeNode=node?node.getNext():null;for(spliceStartNode._nextNode=null,node=spliceStartNode,i=0;insertCount>i;i++)node=node.getNext();if(index+=insertCount,node!==spliceResumeNode&&(node._nextNode=spliceResumeNode,spliceResumeNode&&(spliceResumeNode._previousNode=node)),spliceResumeNode)for(node=spliceResumeNode,index++;node&&index<this.array.length+this.firstIndex;)node._nextNode?node.index+=indexShiftAmount:node.index=index,node=node.getNext(),index++;this.trackSize&&(this.sizeDirty=!0)}},ViewSequence.prototype.getPrevious=function(){var len=this._.array.length;return len?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+len-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},ViewSequence.prototype.getNext=function(){var len=this._.array.length;return len?this.index===this._.firstIndex+len-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},ViewSequence.prototype.indexOf=function(item){return this._.array.indexOf(item)},ViewSequence.prototype.getIndex=function(){return this.index},ViewSequence.prototype.toString=function(){return""+this.index},ViewSequence.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},ViewSequence.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},ViewSequence.prototype.splice=function(index,howMany){var values=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[index-this._.firstIndex,howMany].concat(values)),this._.reindex(index,howMany,values.length)},ViewSequence.prototype.swap=function(other){var otherValue=other.get(),myValue=this.get();this._.setValue(this.index,otherValue),this._.setValue(other.index,myValue);var myPrevious=this._previousNode,myNext=this._nextNode,myIndex=this.index,otherPrevious=other._previousNode,otherNext=other._nextNode,otherIndex=other.index;this.index=otherIndex,this._previousNode=otherPrevious===this?other:otherPrevious,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=otherNext===this?other:otherNext,this._nextNode&&(this._nextNode._previousNode=this),other.index=myIndex,other._previousNode=myPrevious===other?this:myPrevious,other._previousNode&&(other._previousNode._nextNode=other),other._nextNode=myNext===other?this:myNext,other._nextNode&&(other._nextNode._previousNode=other),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),other.index===this._.firstIndex?this._.firstNode=other:other.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=other),this._.trackSize&&(this._.sizeDirty=!0)},ViewSequence.prototype.get=function(){return this._.getValue(this.index)},ViewSequence.prototype.getSize=function(){var target=this.get();return target?target.getSize():null},ViewSequence.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var target=this.get();return target?target.render.apply(target,arguments):null},module.exports=ViewSequence},{}],18:[function(_dereq_,module){module.exports={Context:_dereq_("./Context"),ElementAllocator:_dereq_("./ElementAllocator"),ElementOutput:_dereq_("./ElementOutput"),Engine:_dereq_("./Engine"),Entity:_dereq_("./Entity"),EventEmitter:_dereq_("./EventEmitter"),EventHandler:_dereq_("./EventHandler"),Group:_dereq_("./Group"),Modifier:_dereq_("./Modifier"),OptionsManager:_dereq_("./OptionsManager"),RenderNode:_dereq_("./RenderNode"),Scene:_dereq_("./Scene"),SpecParser:_dereq_("./SpecParser"),Surface:_dereq_("./Surface"),Transform:_dereq_("./Transform"),View:_dereq_("./View"),ViewSequence:_dereq_("./ViewSequence")}},{"./Context":1,"./ElementAllocator":2,"./ElementOutput":3,"./Engine":4,"./Entity":5,"./EventEmitter":6,"./EventHandler":7,"./Group":8,"./Modifier":9,"./OptionsManager":10,"./RenderNode":11,"./Scene":12,"./SpecParser":13,"./Surface":14,"./Transform":15,"./View":16,"./ViewSequence":17}],19:[function(_dereq_,module){function EventArbiter(startMode){this.dispatchers={},this.currMode=void 0,this.setMode(startMode)}var EventHandler=_dereq_("../core/EventHandler");EventArbiter.prototype.setMode=function(mode){if(mode!==this.currMode){var startMode=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].trigger("unpipe"),this.currMode=mode,this.dispatchers[mode]&&this.dispatchers[mode].emit("pipe"),this.emit("change",{from:startMode,to:mode})}},EventArbiter.prototype.forMode=function(mode){return this.dispatchers[mode]||(this.dispatchers[mode]=new EventHandler),this.dispatchers[mode]},EventArbiter.prototype.emit=function(eventType,event){if(void 0===this.currMode)return!1;event||(event={});var dispatcher=this.dispatchers[this.currMode];return dispatcher?dispatcher.trigger(eventType,event):void 0},module.exports=EventArbiter},{"../core/EventHandler":7}],20:[function(_dereq_,module){function EventFilter(condition){EventHandler.call(this),this._condition=condition}var EventHandler=_dereq_("../core/EventHandler");EventFilter.prototype=Object.create(EventHandler.prototype),EventFilter.prototype.constructor=EventFilter,EventFilter.prototype.emit=function(type,data){return this._condition(type,data)?EventHandler.prototype.emit.apply(this,arguments):void 0},EventFilter.prototype.trigger=EventFilter.prototype.emit,module.exports=EventFilter},{"../core/EventHandler":7}],21:[function(_dereq_,module){function EventMapper(mappingFunction){EventHandler.call(this),this._mappingFunction=mappingFunction}var EventHandler=_dereq_("../core/EventHandler");EventMapper.prototype=Object.create(EventHandler.prototype),EventMapper.prototype.constructor=EventMapper,EventMapper.prototype.subscribe=null,EventMapper.prototype.unsubscribe=null,EventMapper.prototype.emit=function(type,data){var target=this._mappingFunction.apply(this,arguments);target&&target.emit instanceof Function&&target.emit(type,data)},EventMapper.prototype.trigger=EventMapper.prototype.emit,module.exports=EventMapper},{"../core/EventHandler":7}],22:[function(_dereq_,module){module.exports={EventArbiter:_dereq_("./EventArbiter"),EventFilter:_dereq_("./EventFilter"),EventMapper:_dereq_("./EventMapper")}},{"./EventArbiter":19,"./EventFilter":20,"./EventMapper":21}],23:[function(_dereq_,module){module.exports={core:_dereq_("./core"),events:_dereq_("./events"),inputs:_dereq_("./inputs"),math:_dereq_("./math"),modifiers:_dereq_("./modifiers"),physics:_dereq_("./physics"),utilities:_dereq_("./utilities"),widgets:_dereq_("./widgets"),transitions:_dereq_("./transitions"),surfaces:_dereq_("./surfaces"),views:_dereq_("./views")}},{"./core":18,"./events":22,"./inputs":36,"./math":42,"./modifiers":47,"./physics":71,"./surfaces":82,"./transitions":92,"./utilities":96,"./views":111,"./widgets":116}],24:[function(_dereq_,module){function Accumulator(value,eventName){void 0===eventName&&(eventName="update"),this._state=value&&value.get&&value.set?value:new Transitionable(value||0),this._eventInput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),this._eventInput.on(eventName,_handleUpdate.bind(this))}function _handleUpdate(data){var delta=data.delta,state=this.get();if(delta.constructor===state.constructor){var newState=delta instanceof Array?[state[0]+delta[0],state[1]+delta[1]]:state+delta;this.set(newState)}}var EventHandler=_dereq_("../core/EventHandler"),Transitionable=_dereq_("../transitions/Transitionable");Accumulator.prototype.get=function(){return this._state.get()},Accumulator.prototype.set=function(value){this._state.set(value)},module.exports=Accumulator},{"../core/EventHandler":7,"../transitions/Transitionable":88}],25:[function(){function kill(type){window.addEventListener(type,function(event){return event.stopPropagation(),!1},!0)}var hasTouch="ontouchstart"in window;hasTouch&&(kill("mousedown"),kill("mousemove"),kill("mouseup"),kill("mouseleave"))},{}],26:[function(){!function(){if(window.CustomEvent){var clickThreshold=300,clickWindow=500,potentialClicks={},recentlyDispatched={},_now=Date.now;window.addEventListener("touchstart",function(event){for(var timestamp=_now(),i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];potentialClicks[touch.identifier]=timestamp}}),window.addEventListener("touchmove",function(event){for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];delete potentialClicks[touch.identifier]}}),window.addEventListener("touchend",function(event){for(var currTime=_now(),i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i],startTime=potentialClicks[touch.identifier];if(startTime&&clickThreshold>currTime-startTime){var clickEvt=new window.CustomEvent("click",{bubbles:!0,detail:touch});recentlyDispatched[currTime]=event,event.target.dispatchEvent(clickEvt)}delete potentialClicks[touch.identifier]}}),window.addEventListener("click",function(event){var currTime=_now();for(var i in recentlyDispatched){var previousEvent=recentlyDispatched[i];clickWindow>currTime-i?event instanceof window.MouseEvent&&event.target===previousEvent.target&&event.stopPropagation():delete recentlyDispatched[i]}},!0)}}()},{}],27:[function(_dereq_,module){function GenericSync(syncs,options){this._eventInput=new EventHandler,this._eventOutput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput),this._syncs={},syncs&&this.addSync(syncs),options&&this.setOptions(options)}function _addSingleSync(key,options){registry[key]&&(this._syncs[key]=new registry[key](options),this.pipeSync(key))}var EventHandler=_dereq_("../core/EventHandler");GenericSync.DIRECTION_X=0,GenericSync.DIRECTION_Y=1,GenericSync.DIRECTION_Z=2;var registry={};GenericSync.register=function(syncObject){for(var key in syncObject){if(registry[key]){if(registry[key]===syncObject[key])return;throw new Error("this key is registered to a different sync class")}registry[key]=syncObject[key]}},GenericSync.prototype.setOptions=function(options){for(var key in this._syncs)this._syncs[key].setOptions(options)},GenericSync.prototype.pipeSync=function(key){var sync=this._syncs[key];this._eventInput.pipe(sync),sync.pipe(this._eventOutput)},GenericSync.prototype.unpipeSync=function(key){var sync=this._syncs[key];this._eventInput.unpipe(sync),sync.unpipe(this._eventOutput)},GenericSync.prototype.addSync=function(syncs){if(syncs instanceof Array)for(var i=0;i<syncs.length;i++)_addSingleSync.call(this,syncs[i]);else if(syncs instanceof Object)for(var key in syncs)_addSingleSync.call(this,key,syncs[key])},module.exports=GenericSync},{"../core/EventHandler":7}],28:[function(_dereq_,module){function MouseSync(options){this.options=Object.create(MouseSync.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._eventInput=new EventHandler,this._eventOutput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",_handleStart.bind(this)),this._eventInput.on("mousemove",_handleMove.bind(this)),this._eventInput.on("mouseup",_handleEnd.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",_handleLeave.bind(this)):this._eventInput.on("mouseleave",_handleEnd.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._moved=!1,this._documentActive=!1}function _handleStart(event){var delta,velocity;this.options.preventDefault&&event.preventDefault();var x=event.clientX,y=event.clientY;this._prevCoord=[x,y],this._prevTime=Date.now(),this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,delta=0,velocity=0):(this._position=[0,0],delta=[0,0],velocity=[0,0]);var payload=this._payload;payload.delta=delta,payload.position=this._position,payload.velocity=velocity,payload.clientX=x,payload.clientY=y,payload.offsetX=event.offsetX,payload.offsetY=event.offsetY,this._positionHistory.push({position:payload.position.slice?payload.position.slice(0):payload.position,time:this._prevTime}),this._eventOutput.emit("start",payload),this._documentActive=!1}function _handleMove(event){if(this._prevCoord){var prevCoord=this._prevCoord,x=(this._prevTime,event.clientX),y=event.clientY,currTime=Date.now(),diffX=x-prevCoord[0],diffY=y-prevCoord[1];this.options.rails&&(Math.abs(diffX)>Math.abs(diffY)?diffY=0:diffX=0);var nextVel,nextDelta,diffTime=Math.max(currTime-this._positionHistory[0].time,MINIMUM_TICK_TIME),scale=this.options.scale;this.options.direction===MouseSync.DIRECTION_X?(nextDelta=scale*diffX,this._position+=nextDelta,nextVel=scale*(this._position-this._positionHistory[0].position)/diffTime):this.options.direction===MouseSync.DIRECTION_Y?(nextDelta=scale*diffY,this._position+=nextDelta,nextVel=scale*(this._position-this._positionHistory[0].position)/diffTime):(nextDelta=[scale*diffX,scale*diffY],nextVel=[scale*(this._position[0]-this._positionHistory[0].position[0])/diffTime,scale*(this._position[1]-this._positionHistory[0].position[1])/diffTime],this._position[0]+=nextDelta[0],this._position[1]+=nextDelta[1]);var payload=this._payload;payload.delta=nextDelta,payload.position=this._position,payload.velocity=nextVel,payload.clientX=x,payload.clientY=y,payload.offsetX=event.offsetX,payload.offsetY=event.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:payload.position.slice?payload.position.slice(0):payload.position,time:currTime}),this._eventOutput.emit("update",payload),this._prevCoord=[x,y],this._prevTime=currTime,this._move=!0}}function _handleEnd(){this._down&&(this._eventOutput.emit("end",this._payload),this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._move=!1,this._positionHistory=[])}function _handleLeave(event){if(this._down&&this._move&&!this._documentActive){var boundMove=_handleMove.bind(this),boundEnd=function(event){_handleEnd.call(this,event),document.removeEventListener("mousemove",boundMove),document.removeEventListener("mouseup",boundEnd)}.bind(this,event);document.addEventListener("mousemove",boundMove),document.addEventListener("mouseup",boundEnd),this._documentActive=!0}}var EventHandler=_dereq_("../core/EventHandler"),OptionsManager=_dereq_("../core/OptionsManager");MouseSync.DEFAULT_OPTIONS={direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,preventDefault:!0},MouseSync.DIRECTION_X=0,MouseSync.DIRECTION_Y=1;var MINIMUM_TICK_TIME=8;MouseSync.prototype.getOptions=function(){return this.options},MouseSync.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},module.exports=MouseSync},{"../core/EventHandler":7,"../core/OptionsManager":10}],29:[function(_dereq_,module){function PinchSync(options){TwoFingerSync.call(this),this.options=Object.create(PinchSync.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._displacement=0,this._previousDistance=0}var TwoFingerSync=_dereq_("./TwoFingerSync"),OptionsManager=_dereq_("../core/OptionsManager");PinchSync.prototype=Object.create(TwoFingerSync.prototype),PinchSync.prototype.constructor=PinchSync,PinchSync.DEFAULT_OPTIONS={scale:1},PinchSync.prototype._startUpdate=function(event){this._previousDistance=TwoFingerSync.calculateDistance(this.posA,this.posB),this._displacement=0,this._eventOutput.emit("start",{count:event.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist,center:TwoFingerSync.calculateCenter(this.posA,this.posB)})},PinchSync.prototype._moveUpdate=function(diffTime){var currDist=TwoFingerSync.calculateDistance(this.posA,this.posB),center=TwoFingerSync.calculateCenter(this.posA,this.posB),scale=this.options.scale,delta=scale*(currDist-this._previousDistance),velocity=delta/diffTime;this._previousDistance=currDist,this._displacement+=delta,this._eventOutput.emit("update",{delta:delta,velocity:velocity,distance:currDist,displacement:this._displacement,center:center,touches:[this.touchAId,this.touchBId]})},PinchSync.prototype.getOptions=function(){return this.options},PinchSync.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},module.exports=PinchSync},{"../core/OptionsManager":10,"./TwoFingerSync":35}],30:[function(_dereq_,module){function RotateSync(options){TwoFingerSync.call(this),this.options=Object.create(RotateSync.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._angle=0,this._previousAngle=0}var TwoFingerSync=_dereq_("./TwoFingerSync"),OptionsManager=_dereq_("../core/OptionsManager");RotateSync.prototype=Object.create(TwoFingerSync.prototype),RotateSync.prototype.constructor=RotateSync,RotateSync.DEFAULT_OPTIONS={scale:1},RotateSync.prototype._startUpdate=function(event){this._angle=0,this._previousAngle=TwoFingerSync.calculateAngle(this.posA,this.posB);var center=TwoFingerSync.calculateCenter(this.posA,this.posB);this._eventOutput.emit("start",{count:event.touches.length,angle:this._angle,center:center,touches:[this.touchAId,this.touchBId]})},RotateSync.prototype._moveUpdate=function(diffTime){var scale=this.options.scale,currAngle=TwoFingerSync.calculateAngle(this.posA,this.posB),center=TwoFingerSync.calculateCenter(this.posA,this.posB),diffTheta=scale*(currAngle-this._previousAngle),velTheta=diffTheta/diffTime;this._angle+=diffTheta,this._eventOutput.emit("update",{delta:diffTheta,velocity:velTheta,angle:this._angle,center:center,touches:[this.touchAId,this.touchBId]}),this._previousAngle=currAngle},RotateSync.prototype.getOptions=function(){return this.options},RotateSync.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},module.exports=RotateSync},{"../core/OptionsManager":10,"./TwoFingerSync":35}],31:[function(_dereq_,module){function ScaleSync(options){TwoFingerSync.call(this),this.options=Object.create(ScaleSync.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._scaleFactor=1,this._startDist=0,this._eventInput.on("pipe",_reset.bind(this))}function _reset(){this.touchAId=void 0,this.touchBId=void 0}var TwoFingerSync=_dereq_("./TwoFingerSync"),OptionsManager=_dereq_("../core/OptionsManager");ScaleSync.prototype=Object.create(TwoFingerSync.prototype),ScaleSync.prototype.constructor=ScaleSync,ScaleSync.DEFAULT_OPTIONS={scale:1},ScaleSync.prototype._startUpdate=function(event){this._scaleFactor=1,this._startDist=TwoFingerSync.calculateDistance(this.posA,this.posB),this._eventOutput.emit("start",{count:event.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist,center:TwoFingerSync.calculateCenter(this.posA,this.posB)})},ScaleSync.prototype._moveUpdate=function(diffTime){var scale=this.options.scale,currDist=TwoFingerSync.calculateDistance(this.posA,this.posB),center=TwoFingerSync.calculateCenter(this.posA,this.posB),delta=(currDist-this._startDist)/this._startDist,newScaleFactor=Math.max(1+scale*delta,0),veloScale=(newScaleFactor-this._scaleFactor)/diffTime;this._eventOutput.emit("update",{delta:delta,scale:newScaleFactor,velocity:veloScale,distance:currDist,center:center,touches:[this.touchAId,this.touchBId]}),this._scaleFactor=newScaleFactor},ScaleSync.prototype.getOptions=function(){return this.options},ScaleSync.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},module.exports=ScaleSync},{"../core/OptionsManager":10,"./TwoFingerSync":35}],32:[function(_dereq_,module){function ScrollSync(options){this.options=Object.create(ScrollSync.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new EventHandler,this._eventOutput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",_handleMove.bind(this)),this._eventInput.on("wheel",_handleMove.bind(this)),this._inProgress=!1,this._loopBound=!1}function _newFrame(){if(this._inProgress&&_now()-this._prevTime>this.options.stallTime){this._inProgress=!1;var finalVel=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,payload=this._payload;payload.position=this._position,payload.velocity=finalVel,payload.slip=!0,this._eventOutput.emit("end",payload)}}function _handleMove(event){this.options.preventDefault&&event.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,payload=this._payload,payload.slip=!0,payload.position=this._position,payload.clientX=event.clientX,payload.clientY=event.clientY,payload.offsetX=event.offsetX,payload.offsetY=event.offsetY,this._eventOutput.emit("start",payload),this._loopBound||(Engine.on("prerender",_newFrame.bind(this)),this._loopBound=!0));var currTime=_now(),prevTime=this._prevTime||currTime,diffX=void 0!==event.wheelDeltaX?event.wheelDeltaX:-event.deltaX,diffY=void 0!==event.wheelDeltaY?event.wheelDeltaY:-event.deltaY;1===event.deltaMode&&(diffX*=this.options.lineHeight,diffY*=this.options.lineHeight),this.options.rails&&(Math.abs(diffX)>Math.abs(diffY)?diffY=0:diffX=0);var nextVel,nextDelta,diffTime=Math.max(currTime-prevTime,MINIMUM_TICK_TIME),velX=diffX/diffTime,velY=diffY/diffTime,scale=this.options.scale;this.options.direction===ScrollSync.DIRECTION_X?(nextDelta=scale*diffX,nextVel=scale*velX,this._position+=nextDelta):this.options.direction===ScrollSync.DIRECTION_Y?(nextDelta=scale*diffY,nextVel=scale*velY,this._position+=nextDelta):(nextDelta=[scale*diffX,scale*diffY],nextVel=[scale*velX,scale*velY],this._position[0]+=nextDelta[0],this._position[1]+=nextDelta[1]);var payload=this._payload;payload.delta=nextDelta,payload.velocity=nextVel,payload.position=this._position,payload.slip=!0,this._eventOutput.emit("update",payload),this._prevTime=currTime,this._prevVel=nextVel}var EventHandler=_dereq_("../core/EventHandler"),Engine=_dereq_("../core/Engine"),OptionsManager=_dereq_("../core/OptionsManager");ScrollSync.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},ScrollSync.DIRECTION_X=0,ScrollSync.DIRECTION_Y=1;var MINIMUM_TICK_TIME=8,_now=Date.now;ScrollSync.prototype.getOptions=function(){return this.options},ScrollSync.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},module.exports=ScrollSync},{"../core/Engine":4,"../core/EventHandler":7,"../core/OptionsManager":10}],33:[function(_dereq_,module){function TouchSync(options){this.options=Object.create(TouchSync.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._eventOutput=new EventHandler,this._touchTracker=new TouchTracker({touchLimit:this.options.touchLimit}),EventHandler.setOutputHandler(this,this._eventOutput),EventHandler.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",_handleStart.bind(this)),this._touchTracker.on("trackmove",_handleMove.bind(this)),this._touchTracker.on("trackend",_handleEnd.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function _handleStart(data){var velocity,delta;void 0!==this.options.direction?(this._position=0,velocity=0,delta=0):(this._position=[0,0],velocity=[0,0],delta=[0,0]);var payload=this._payload;payload.delta=delta,payload.position=this._position,payload.velocity=velocity,payload.clientX=data.x,payload.clientY=data.y,payload.count=data.count,payload.touch=data.identifier,this._eventOutput.emit("start",payload)}function _handleMove(data){var history=data.history,currHistory=history[history.length-1],prevHistory=history[history.length-2],distantHistory=history[history.length-this.options.velocitySampleLength]?history[history.length-this.options.velocitySampleLength]:history[history.length-2],distantTime=distantHistory.timestamp,currTime=currHistory.timestamp,diffX=currHistory.x-prevHistory.x,diffY=currHistory.y-prevHistory.y,velDiffX=currHistory.x-distantHistory.x,velDiffY=currHistory.y-distantHistory.y;this.options.rails&&(Math.abs(diffX)>Math.abs(diffY)?diffY=0:diffX=0,Math.abs(velDiffX)>Math.abs(velDiffY)?velDiffY=0:velDiffX=0);
var nextVel,nextDelta,diffTime=Math.max(currTime-distantTime,MINIMUM_TICK_TIME),velX=velDiffX/diffTime,velY=velDiffY/diffTime,scale=this.options.scale;this.options.direction===TouchSync.DIRECTION_X?(nextDelta=scale*diffX,nextVel=scale*velX,this._position+=nextDelta):this.options.direction===TouchSync.DIRECTION_Y?(nextDelta=scale*diffY,nextVel=scale*velY,this._position+=nextDelta):(nextDelta=[scale*diffX,scale*diffY],nextVel=[scale*velX,scale*velY],this._position[0]+=nextDelta[0],this._position[1]+=nextDelta[1]);var payload=this._payload;payload.delta=nextDelta,payload.velocity=nextVel,payload.position=this._position,payload.clientX=data.x,payload.clientY=data.y,payload.count=data.count,payload.touch=data.identifier,this._eventOutput.emit("update",payload)}function _handleEnd(data){this._payload.count=data.count,this._eventOutput.emit("end",this._payload)}var TouchTracker=_dereq_("./TouchTracker"),EventHandler=_dereq_("../core/EventHandler"),OptionsManager=_dereq_("../core/OptionsManager");TouchSync.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1},TouchSync.DIRECTION_X=0,TouchSync.DIRECTION_Y=1;var MINIMUM_TICK_TIME=8;TouchSync.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},TouchSync.prototype.getOptions=function(){return this.options},module.exports=TouchSync},{"../core/EventHandler":7,"../core/OptionsManager":10,"./TouchTracker":34}],34:[function(_dereq_,module){function _timestampTouch(touch,event,history){return{x:touch.clientX,y:touch.clientY,identifier:touch.identifier,origin:event.origin,timestamp:_now(),count:event.touches.length,history:history}}function _handleStart(event){if(!(event.touches.length>this.touchLimit)){this.isTouched=!0;for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i],data=_timestampTouch(touch,event,null);this.eventOutput.emit("trackstart",data),this.selective||this.touchHistory[touch.identifier]||this.track(data)}}}function _handleMove(event){if(!(event.touches.length>this.touchLimit))for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i],history=this.touchHistory[touch.identifier];if(history){var data=_timestampTouch(touch,event,history);this.touchHistory[touch.identifier].push(data),this.eventOutput.emit("trackmove",data)}}}function _handleEnd(event){if(this.isTouched){for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i],history=this.touchHistory[touch.identifier];if(history){var data=_timestampTouch(touch,event,history);this.eventOutput.emit("trackend",data),delete this.touchHistory[touch.identifier]}}this.isTouched=!1}}function _handleUnpipe(){for(var i in this.touchHistory){var history=this.touchHistory[i];this.eventOutput.emit("trackend",{touch:history[history.length-1].touch,timestamp:Date.now(),count:0,history:history}),delete this.touchHistory[i]}}function TouchTracker(options){this.selective=options.selective,this.touchLimit=options.touchLimit||1,this.touchHistory={},this.eventInput=new EventHandler,this.eventOutput=new EventHandler,EventHandler.setInputHandler(this,this.eventInput),EventHandler.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",_handleStart.bind(this)),this.eventInput.on("touchmove",_handleMove.bind(this)),this.eventInput.on("touchend",_handleEnd.bind(this)),this.eventInput.on("touchcancel",_handleEnd.bind(this)),this.eventInput.on("unpipe",_handleUnpipe.bind(this)),this.isTouched=!1}var EventHandler=_dereq_("../core/EventHandler"),_now=Date.now;TouchTracker.prototype.track=function(data){this.touchHistory[data.identifier]=[data]},module.exports=TouchTracker},{"../core/EventHandler":7}],35:[function(_dereq_,module){function TwoFingerSync(){this._eventInput=new EventHandler,this._eventOutput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput),this.touchAEnabled=!1,this.touchAId=0,this.posA=null,this.timestampA=0,this.touchBEnabled=!1,this.touchBId=0,this.posB=null,this.timestampB=0,this._eventInput.on("touchstart",this.handleStart.bind(this)),this._eventInput.on("touchmove",this.handleMove.bind(this)),this._eventInput.on("touchend",this.handleEnd.bind(this)),this._eventInput.on("touchcancel",this.handleEnd.bind(this))}var EventHandler=_dereq_("../core/EventHandler");TwoFingerSync.calculateAngle=function(posA,posB){var diffX=posB[0]-posA[0],diffY=posB[1]-posA[1];return Math.atan2(diffY,diffX)},TwoFingerSync.calculateDistance=function(posA,posB){var diffX=posB[0]-posA[0],diffY=posB[1]-posA[1];return Math.sqrt(diffX*diffX+diffY*diffY)},TwoFingerSync.calculateCenter=function(posA,posB){return[(posA[0]+posB[0])/2,(posA[1]+posB[1])/2]};var _now=Date.now;TwoFingerSync.prototype.handleStart=function(event){for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];this.touchAEnabled?this.touchBEnabled||(this.touchBId=touch.identifier,this.touchBEnabled=!0,this.posB=[touch.pageX,touch.pageY],this.timestampB=_now(),this._startUpdate(event)):(this.touchAId=touch.identifier,this.touchAEnabled=!0,this.posA=[touch.pageX,touch.pageY],this.timestampA=_now())}},TwoFingerSync.prototype.handleMove=function(event){if(this.touchAEnabled&&this.touchBEnabled){for(var diffTime,prevTimeA=this.timestampA,prevTimeB=this.timestampB,i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];touch.identifier===this.touchAId?(this.posA=[touch.pageX,touch.pageY],this.timestampA=_now(),diffTime=this.timestampA-prevTimeA):touch.identifier===this.touchBId&&(this.posB=[touch.pageX,touch.pageY],this.timestampB=_now(),diffTime=this.timestampB-prevTimeB)}diffTime&&this._moveUpdate(diffTime)}},TwoFingerSync.prototype.handleEnd=function(event){for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];(touch.identifier===this.touchAId||touch.identifier===this.touchBId)&&(this.touchAEnabled&&this.touchBEnabled&&this._eventOutput.emit("end",{touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAEnabled=!1,this.touchAId=0,this.touchBEnabled=!1,this.touchBId=0)}},module.exports=TwoFingerSync},{"../core/EventHandler":7}],36:[function(_dereq_,module){module.exports={Accumulator:_dereq_("./Accumulator"),DesktopEmulationMode:_dereq_("./DesktopEmulationMode"),FastClick:_dereq_("./FastClick"),GenericSync:_dereq_("./GenericSync"),MouseSync:_dereq_("./MouseSync"),PinchSync:_dereq_("./PinchSync"),RotateSync:_dereq_("./RotateSync"),ScaleSync:_dereq_("./ScaleSync"),ScrollSync:_dereq_("./ScrollSync"),TouchSync:_dereq_("./TouchSync"),TouchTracker:_dereq_("./TouchTracker"),TwoFingerSync:_dereq_("./TwoFingerSync")}},{"./Accumulator":24,"./DesktopEmulationMode":25,"./FastClick":26,"./GenericSync":27,"./MouseSync":28,"./PinchSync":29,"./RotateSync":30,"./ScaleSync":31,"./ScrollSync":32,"./TouchSync":33,"./TouchTracker":34,"./TwoFingerSync":35}],37:[function(_dereq_,module){function Matrix(values){return this.values=values||[[1,0,0],[0,1,0],[0,0,1]],this}var Vector=_dereq_("./Vector"),_register=new Matrix,_vectorRegister=new Vector;Matrix.prototype.get=function(){return this.values},Matrix.prototype.set=function(values){this.values=values},Matrix.prototype.vectorMultiply=function(v){var M=this.get(),v0=v.x,v1=v.y,v2=v.z,M0=M[0],M1=M[1],M2=M[2],M00=M0[0],M01=M0[1],M02=M0[2],M10=M1[0],M11=M1[1],M12=M1[2],M20=M2[0],M21=M2[1],M22=M2[2];return _vectorRegister.setXYZ(M00*v0+M01*v1+M02*v2,M10*v0+M11*v1+M12*v2,M20*v0+M21*v1+M22*v2)},Matrix.prototype.multiply=function(M2){for(var M1=this.get(),result=[[]],i=0;3>i;i++){result[i]=[];for(var j=0;3>j;j++){for(var sum=0,k=0;3>k;k++)sum+=M1[i][k]*M2[k][j];result[i][j]=sum}}return _register.set(result)},Matrix.prototype.transpose=function(){for(var result=[],M=this.get(),row=0;3>row;row++)for(var col=0;3>col;col++)result[row][col]=M[col][row];return _register.set(result)},Matrix.prototype.clone=function(){for(var values=this.get(),M=[],row=0;3>row;row++)M[row]=values[row].slice();return new Matrix(M)},module.exports=Matrix},{"./Vector":41}],38:[function(_dereq_,module){function Quaternion(w,x,y,z){return 1===arguments.length?this.set(w):(this.w=void 0!==w?w:1,this.x=void 0!==x?x:0,this.y=void 0!==y?y:0,this.z=void 0!==z?z:0),this}var Matrix=_dereq_("./Matrix"),register=new Quaternion(1,0,0,0);Quaternion.prototype.add=function(q){return register.setWXYZ(this.w+q.w,this.x+q.x,this.y+q.y,this.z+q.z)},Quaternion.prototype.sub=function(q){return register.setWXYZ(this.w-q.w,this.x-q.x,this.y-q.y,this.z-q.z)},Quaternion.prototype.scalarDivide=function(s){return this.scalarMultiply(1/s)},Quaternion.prototype.scalarMultiply=function(s){return register.setWXYZ(this.w*s,this.x*s,this.y*s,this.z*s)},Quaternion.prototype.multiply=function(q){var x1=this.x,y1=this.y,z1=this.z,w1=this.w,x2=q.x,y2=q.y,z2=q.z,w2=q.w||0;return register.setWXYZ(w1*w2-x1*x2-y1*y2-z1*z2,x1*w2+x2*w1+y2*z1-y1*z2,y1*w2+y2*w1+x1*z2-x2*z1,z1*w2+z2*w1+x2*y1-x1*y2)};var conj=new Quaternion(1,0,0,0);Quaternion.prototype.rotateVector=function(v){return conj.set(this.conj()),register.set(this.multiply(v).multiply(conj))},Quaternion.prototype.inverse=function(){return register.set(this.conj().scalarDivide(this.normSquared()))},Quaternion.prototype.negate=function(){return this.scalarMultiply(-1)},Quaternion.prototype.conj=function(){return register.setWXYZ(this.w,-this.x,-this.y,-this.z)},Quaternion.prototype.normalize=function(length){return length=void 0===length?1:length,this.scalarDivide(length*this.norm())},Quaternion.prototype.makeFromAngleAndAxis=function(angle,v){var n=v.normalize(),ha=.5*angle,s=-Math.sin(ha);return this.x=s*n.x,this.y=s*n.y,this.z=s*n.z,this.w=Math.cos(ha),this},Quaternion.prototype.setWXYZ=function(w,x,y,z){return register.clear(),this.w=w,this.x=x,this.y=y,this.z=z,this},Quaternion.prototype.set=function(v){return v instanceof Array?(this.w=0,this.x=v[0],this.y=v[1],this.z=v[2]):(this.w=v.w,this.x=v.x,this.y=v.y,this.z=v.z),this!==register&&register.clear(),this},Quaternion.prototype.put=function(q){q.set(register)},Quaternion.prototype.clone=function(){return new Quaternion(this)},Quaternion.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},Quaternion.prototype.isEqual=function(q){return q.w===this.w&&q.x===this.x&&q.y===this.y&&q.z===this.z},Quaternion.prototype.dot=function(q){return this.w*q.w+this.x*q.x+this.y*q.y+this.z*q.z},Quaternion.prototype.normSquared=function(){return this.dot(this)},Quaternion.prototype.norm=function(){return Math.sqrt(this.normSquared())},Quaternion.prototype.isZero=function(){return!(this.x||this.y||this.z)},Quaternion.prototype.getTransform=function(){var temp=this.normalize(1),x=temp.x,y=temp.y,z=temp.z,w=temp.w;return[1-2*y*y-2*z*z,2*x*y-2*z*w,2*x*z+2*y*w,0,2*x*y+2*z*w,1-2*x*x-2*z*z,2*y*z-2*x*w,0,2*x*z-2*y*w,2*y*z+2*x*w,1-2*x*x-2*y*y,0,0,0,0,1]};var matrixRegister=new Matrix;Quaternion.prototype.getMatrix=function(){var temp=this.normalize(1),x=temp.x,y=temp.y,z=temp.z,w=temp.w;return matrixRegister.set([[1-2*y*y-2*z*z,2*x*y+2*z*w,2*x*z-2*y*w],[2*x*y-2*z*w,1-2*x*x-2*z*z,2*y*z+2*x*w],[2*x*z+2*y*w,2*y*z-2*x*w,1-2*x*x-2*y*y]])};var epsilon=1e-5;Quaternion.prototype.slerp=function(q,t){var omega,cosomega,sinomega,scaleFrom,scaleTo;return cosomega=this.dot(q),1-cosomega>epsilon?(omega=Math.acos(cosomega),sinomega=Math.sin(omega),scaleFrom=Math.sin((1-t)*omega)/sinomega,scaleTo=Math.sin(t*omega)/sinomega):(scaleFrom=1-t,scaleTo=t),register.set(this.scalarMultiply(scaleFrom/scaleTo).add(q).multiply(scaleTo))},module.exports=Quaternion},{"./Matrix":37}],39:[function(_dereq_,module){function _randomFloat(min,max){return min+RAND()*(max-min)}function _randomInteger(min,max){return min+RAND()*(max-min+1)>>0}var RAND=Math.random,Random={};Random.integer=function(min,max,dim){if(min=void 0!==min?min:0,max=void 0!==max?max:1,void 0!==dim){for(var result=[],i=0;dim>i;i++)result.push(_randomInteger(min,max));return result}return _randomInteger(min,max)},Random.range=function(min,max,dim){if(min=void 0!==min?min:0,max=void 0!==max?max:1,void 0!==dim){for(var result=[],i=0;dim>i;i++)result.push(_randomFloat(min,max));return result}return _randomFloat(min,max)},Random.sign=function(prob){return prob=void 0!==prob?prob:.5,RAND()<prob?1:-1},Random.bool=function(prob){return prob=void 0!==prob?prob:.5,RAND()<prob},module.exports=Random},{}],40:[function(_dereq_,module){var Utilities={};Utilities.clamp=function(value,range){return Math.max(Math.min(value,range[1]),range[0])},Utilities.length=function(array){for(var distanceSquared=0,i=0;i<array.length;i++)distanceSquared+=array[i]*array[i];return Math.sqrt(distanceSquared)},module.exports=Utilities},{}],41:[function(_dereq_,module){function Vector(x,y,z){return 1===arguments.length&&void 0!==x?this.set(x):(this.x=x||0,this.y=y||0,this.z=z||0),this}function _setXYZ(x,y,z){return this.x=x,this.y=y,this.z=z,this}function _setFromArray(v){return _setXYZ.call(this,v[0],v[1],v[2]||0)}function _setFromVector(v){return _setXYZ.call(this,v.x,v.y,v.z)}function _setFromNumber(x){return _setXYZ.call(this,x,0,0)}var _register=new Vector(0,0,0);Vector.prototype.add=function(v){return _setXYZ.call(_register,this.x+v.x,this.y+v.y,this.z+v.z)},Vector.prototype.sub=function(v){return _setXYZ.call(_register,this.x-v.x,this.y-v.y,this.z-v.z)},Vector.prototype.mult=function(r){return _setXYZ.call(_register,r*this.x,r*this.y,r*this.z)},Vector.prototype.div=function(r){return this.mult(1/r)},Vector.prototype.cross=function(v){var x=this.x,y=this.y,z=this.z,vx=v.x,vy=v.y,vz=v.z;return _setXYZ.call(_register,z*vy-y*vz,x*vz-z*vx,y*vx-x*vy)},Vector.prototype.equals=function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z},Vector.prototype.rotateX=function(theta){var x=this.x,y=this.y,z=this.z,cosTheta=Math.cos(theta),sinTheta=Math.sin(theta);return _setXYZ.call(_register,x,y*cosTheta-z*sinTheta,y*sinTheta+z*cosTheta)},Vector.prototype.rotateY=function(theta){var x=this.x,y=this.y,z=this.z,cosTheta=Math.cos(theta),sinTheta=Math.sin(theta);return _setXYZ.call(_register,z*sinTheta+x*cosTheta,y,z*cosTheta-x*sinTheta)},Vector.prototype.rotateZ=function(theta){var x=this.x,y=this.y,z=this.z,cosTheta=Math.cos(theta),sinTheta=Math.sin(theta);return _setXYZ.call(_register,x*cosTheta-y*sinTheta,x*sinTheta+y*cosTheta,z)},Vector.prototype.dot=function(v){return this.x*v.x+this.y*v.y+this.z*v.z},Vector.prototype.normSquared=function(){return this.dot(this)},Vector.prototype.norm=function(){return Math.sqrt(this.normSquared())},Vector.prototype.normalize=function(length){0===arguments.length&&(length=1);var norm=this.norm();return norm>1e-7?_setFromVector.call(_register,this.mult(length/norm)):_setXYZ.call(_register,length,0,0)},Vector.prototype.clone=function(){return new Vector(this)},Vector.prototype.isZero=function(){return!(this.x||this.y||this.z)},Vector.prototype.set=function(v){return v instanceof Array?_setFromArray.call(this,v):"number"==typeof v?_setFromNumber.call(this,v):_setFromVector.call(this,v)},Vector.prototype.setXYZ=function(){return _setXYZ.apply(this,arguments)},Vector.prototype.set1D=function(x){return _setFromNumber.call(this,x)},Vector.prototype.put=function(v){this===_register?_setFromVector.call(v,_register):_setFromVector.call(v,this)},Vector.prototype.clear=function(){return _setXYZ.call(this,0,0,0)},Vector.prototype.cap=function cap(cap){if(1/0===cap)return _setFromVector.call(_register,this);var norm=this.norm();return norm>cap?_setFromVector.call(_register,this.mult(cap/norm)):_setFromVector.call(_register,this)},Vector.prototype.project=function(n){return n.mult(this.dot(n))},Vector.prototype.reflectAcross=function(n){return n.normalize().put(n),_setFromVector(_register,this.sub(this.project(n).mult(2)))},Vector.prototype.get=function(){return[this.x,this.y,this.z]},Vector.prototype.get1D=function(){return this.x},module.exports=Vector},{}],42:[function(_dereq_,module){module.exports={Matrix:_dereq_("./Matrix"),Quaternion:_dereq_("./Quaternion"),Random:_dereq_("./Random"),Utilities:_dereq_("./Utilities"),Vector:_dereq_("./Vector")}},{"./Matrix":37,"./Quaternion":38,"./Random":39,"./Utilities":40,"./Vector":41}],43:[function(_dereq_,module){function Draggable(options){this.options=Object.create(Draggable.DEFAULT_OPTIONS),options&&this.setOptions(options),this._positionState=new Transitionable([0,0]),this._differential=[0,0],this._active=!0,this.sync=new GenericSync(["mouse","touch"],{scale:this.options.scale}),this.eventOutput=new EventHandler,EventHandler.setInputHandler(this,this.sync),EventHandler.setOutputHandler(this,this.eventOutput),_bindEvents.call(this)}function _mapDifferential(differential){var opts=this.options,projection=opts.projection,snapX=opts.snapX,snapY=opts.snapY,tx=projection&_direction.x?differential[0]:0,ty=projection&_direction.y?differential[1]:0;return snapX>0&&(tx-=tx%snapX),snapY>0&&(ty-=ty%snapY),[tx,ty]}function _handleStart(){this._active&&(this._positionState.isActive()&&this._positionState.halt(),this.eventOutput.emit("start",{position:this.getPosition()}))}function _handleMove(event){if(this._active){var options=this.options;this._differential=event.position;var newDifferential=_mapDifferential.call(this,this._differential);this._differential[0]-=newDifferential[0],this._differential[1]-=newDifferential[1];var pos=this.getPosition();if(pos[0]+=newDifferential[0],pos[1]+=newDifferential[1],options.xRange){var xRange=[options.xRange[0]+.5*options.snapX,options.xRange[1]-.5*options.snapX];pos[0]=_clamp(pos[0],xRange)}if(options.yRange){var yRange=[options.yRange[0]+.5*options.snapY,options.yRange[1]-.5*options.snapY];pos[1]=_clamp(pos[1],yRange)}this.eventOutput.emit("update",{position:pos})}}function _handleEnd(){this._active&&this.eventOutput.emit("end",{position:this.getPosition()})}function _bindEvents(){this.sync.on("start",_handleStart.bind(this)),this.sync.on("update",_handleMove.bind(this)),this.sync.on("end",_handleEnd.bind(this))}var Transform=_dereq_("../core/Transform"),Transitionable=_dereq_("../transitions/Transitionable"),EventHandler=_dereq_("../core/EventHandler"),Utilities=_dereq_("../math/Utilities"),GenericSync=_dereq_("../inputs/GenericSync"),MouseSync=_dereq_("../inputs/MouseSync"),TouchSync=_dereq_("../inputs/TouchSync");GenericSync.register({mouse:MouseSync,touch:TouchSync});var _direction={x:1,y:2};Draggable.DIRECTION_X=_direction.x,Draggable.DIRECTION_Y=_direction.y;var _clamp=Utilities.clamp;Draggable.DEFAULT_OPTIONS={projection:_direction.x|_direction.y,scale:1,xRange:null,yRange:null,snapX:0,snapY:0,transition:{duration:0}},Draggable.prototype.setOptions=function(options){var currentOptions=this.options;if(void 0!==options.projection){var proj=options.projection;this.options.projection=0,["x","y"].forEach(function(val){-1!==proj.indexOf(val)&&(currentOptions.projection|=_direction[val])})}void 0!==options.scale&&(currentOptions.scale=options.scale,this.sync.setOptions({scale:options.scale})),void 0!==options.xRange&&(currentOptions.xRange=options.xRange),void 0!==options.yRange&&(currentOptions.yRange=options.yRange),void 0!==options.snapX&&(currentOptions.snapX=options.snapX),void 0!==options.snapY&&(currentOptions.snapY=options.snapY)},Draggable.prototype.getPosition=function(){return this._positionState.get()},Draggable.prototype.setRelativePosition=function(position,transition,callback){var currPos=this.getPosition(),relativePosition=[currPos[0]+position[0],currPos[1]+position[1]];this.setPosition(relativePosition,transition,callback)},Draggable.prototype.setPosition=function(position,transition,callback){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(position,transition,callback)},Draggable.prototype.activate=function(){this._active=!0},Draggable.prototype.deactivate=function(){this._active=!1},Draggable.prototype.toggle=function(){this._active=!this._active},Draggable.prototype.modify=function(target){var pos=this.getPosition();return{transform:Transform.translate(pos[0],pos[1]),target:target}},module.exports=Draggable},{"../core/EventHandler":7,"../core/Transform":15,"../inputs/GenericSync":27,"../inputs/MouseSync":28,"../inputs/TouchSync":33,"../math/Utilities":40,"../transitions/Transitionable":88}],44:[function(_dereq_,module){function Fader(options,startState){this.options=Object.create(Fader.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),startState||(startState=0),this.transitionHelper=new Transitionable(startState)}var Transitionable=_dereq_("../transitions/Transitionable"),OptionsManager=_dereq_("../core/OptionsManager");Fader.DEFAULT_OPTIONS={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0},Fader.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},Fader.prototype.show=function(transition,callback){transition=transition||this.options.transition,this.set(1,transition,callback)},Fader.prototype.hide=function(transition,callback){transition=transition||this.options.transition,this.set(0,transition,callback)},Fader.prototype.set=function(state,transition,callback){this.halt(),this.transitionHelper.set(state,transition,callback)},Fader.prototype.halt=function(){this.transitionHelper.halt()},Fader.prototype.isVisible=function(){return this.transitionHelper.get()>0},Fader.prototype.modify=function(target){var currOpacity=this.transitionHelper.get();return this.options.cull&&!currOpacity?void 0:{opacity:currOpacity,target:target}},module.exports=Fader},{"../core/OptionsManager":10,"../transitions/Transitionable":88}],45:[function(_dereq_,module){function ModifierChain(){this._chain=[],arguments.length&&this.addModifier.apply(this,arguments)}ModifierChain.prototype.addModifier=function(){Array.prototype.push.apply(this._chain,arguments)},ModifierChain.prototype.removeModifier=function(modifier){var index=this._chain.indexOf(modifier);0>index||this._chain.splice(index,1)},ModifierChain.prototype.modify=function(input){for(var chain=this._chain,result=input,i=0;i<chain.length;i++)result=chain[i].modify(result);return result},module.exports=ModifierChain},{}],46:[function(_dereq_,module){function StateModifier(options){this._transformState=new TransitionableTransform(Transform.identity),this._opacityState=new Transitionable(1),this._originState=new Transitionable([0,0]),this._alignState=new Transitionable([0,0]),this._sizeState=new Transitionable([0,0]),this._proportionsState=new Transitionable([0,0]),this._modifier=new Modifier({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,options&&(options.transform&&this.setTransform(options.transform),void 0!==options.opacity&&this.setOpacity(options.opacity),options.origin&&this.setOrigin(options.origin),options.align&&this.setAlign(options.align),options.size&&this.setSize(options.size),options.proportions&&this.setProportions(options.proportions))}var Modifier=_dereq_("../core/Modifier"),Transform=_dereq_("../core/Transform"),Transitionable=_dereq_("../transitions/Transitionable"),TransitionableTransform=_dereq_("../transitions/TransitionableTransform");StateModifier.prototype.setTransform=function(transform,transition,callback){return this._transformState.set(transform,transition,callback),this},StateModifier.prototype.setOpacity=function(opacity,transition,callback){return this._opacityState.set(opacity,transition,callback),this},StateModifier.prototype.setOrigin=function(origin,transition,callback){return null===origin?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(origin,transition,callback),this)},StateModifier.prototype.setAlign=function(align,transition,callback){return null===align?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(align,transition,callback),this)},StateModifier.prototype.setSize=function(size,transition,callback){return null===size?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(size,transition,callback),this)},StateModifier.prototype.setProportions=function(proportions,transition,callback){return null===proportions?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(proportions,transition,callback),this)},StateModifier.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},StateModifier.prototype.getTransform=function(){return this._transformState.get()},StateModifier.prototype.getFinalTransform=function(){return this._transformState.getFinal()},StateModifier.prototype.getOpacity=function(){return this._opacityState.get()},StateModifier.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},StateModifier.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},StateModifier.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},StateModifier.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},StateModifier.prototype.modify=function(target){return this._modifier.modify(target)},module.exports=StateModifier},{"../core/Modifier":9,"../core/Transform":15,"../transitions/Transitionable":88,"../transitions/TransitionableTransform":89}],47:[function(_dereq_,module){module.exports={Draggable:_dereq_("./Draggable"),Fader:_dereq_("./Fader"),ModifierChain:_dereq_("./ModifierChain"),StateModifier:_dereq_("./StateModifier")}},{"./Draggable":43,"./Fader":44,"./ModifierChain":45,"./StateModifier":46}],48:[function(_dereq_,module){function PhysicsEngine(options){this.options=Object.create(PhysicsEngine.DEFAULT_OPTIONS),options&&this.setOptions(options),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=now(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function _mapAgentArray(agent){return agent.applyForce?this._forces:agent.applyConstraint?this._constraints:void 0}function _attachOne(agent,targets,source){return void 0===targets&&(targets=this.getParticlesAndBodies()),targets instanceof Array||(targets=[targets]),agent.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:agent,id:this._currAgentId,targets:targets,source:source},_mapAgentArray.call(this,agent).push(this._currAgentId),this._currAgentId++}function _getAgentData(id){return this._agentData[id]}function _updateForce(index){var boundAgent=_getAgentData.call(this,this._forces[index]);boundAgent.agent.applyForce(boundAgent.targets,boundAgent.source)}function _updateForces(){for(var index=this._forces.length-1;index>-1;index--)_updateForce.call(this,index)}function _updateConstraint(index,dt){var boundAgent=this._agentData[this._constraints[index]];return boundAgent.agent.applyConstraint(boundAgent.targets,boundAgent.source,dt)}function _updateConstraints(dt){for(var iteration=0;iteration<this.options.constraintSteps;){for(var index=this._constraints.length-1;index>-1;index--)_updateConstraint.call(this,index,dt);iteration++}}function _updateVelocities(body,dt){body.integrateVelocity(dt),this.options.velocityCap&&body.velocity.cap(this.options.velocityCap).put(body.velocity)}function _updateAngularVelocities(body,dt){body.integrateAngularMomentum(dt),body.updateAngularVelocity(),this.options.angularVelocityCap&&body.angularVelocity.cap(this.options.angularVelocityCap).put(body.angularVelocity)}function _updateOrientations(body,dt){body.integrateOrientation(dt)}function _updatePositions(body,dt){body.integratePosition(dt),body.emit(_events.update,body)}function _integrate(dt){_updateForces.call(this,dt),this.forEach(_updateVelocities,dt),this.forEachBody(_updateAngularVelocities,dt),_updateConstraints.call(this,dt),this.forEachBody(_updateOrientations,dt),this.forEach(_updatePositions,dt)}function _getParticlesEnergy(){var energy=0,particleEnergy=0;return this.forEach(function(particle){particleEnergy=particle.getEnergy(),energy+=particleEnergy}),energy}function _getAgentsEnergy(){var energy=0;for(var id in this._agentData)energy+=this.getAgentEnergy(id);return energy}var EventHandler=_dereq_("../core/EventHandler"),TIMESTEP=17,MIN_TIME_STEP=1e3/120,MAX_TIME_STEP=17,now=Date.now,_events={start:"start",update:"update",end:"end"};PhysicsEngine.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},PhysicsEngine.prototype.setOptions=function(opts){for(var key in opts)this.options[key]&&(this.options[key]=opts[key])},PhysicsEngine.prototype.addBody=function(body){return body._engine=this,body.isBody?(this._bodies.push(body),this._hasBodies=!0):this._particles.push(body),body.on("start",this.wake.bind(this)),body},PhysicsEngine.prototype.removeBody=function(body){var array=body.isBody?this._bodies:this._particles,index=array.indexOf(body);if(index>-1){for(var agent in this._agentData)this.detachFrom(agent.id,body);array.splice(index,1)}0===this.getBodies().length&&(this._hasBodies=!1)},PhysicsEngine.prototype.attach=function(agents,targets,source){if(this.wake(),agents instanceof Array){for(var agentIDs=[],i=0;i<agents.length;i++)agentIDs[i]=_attachOne.call(this,agents[i],targets,source);return agentIDs}return _attachOne.call(this,agents,targets,source)},PhysicsEngine.prototype.attachTo=function(agentID,target){_getAgentData.call(this,agentID).targets.push(target)},PhysicsEngine.prototype.detach=function(id){var agent=this.getAgent(id),agentArray=_mapAgentArray.call(this,agent),index=agentArray.indexOf(id);agentArray.splice(index,1),delete this._agentData[id]},PhysicsEngine.prototype.detachFrom=function(id,target){var boundAgent=_getAgentData.call(this,id);if(boundAgent.source===target)this.detach(id);else{var targets=boundAgent.targets,index=targets.indexOf(target);index>-1&&targets.splice(index,1)}},PhysicsEngine.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},PhysicsEngine.prototype.getAgent=function(id){return _getAgentData.call(this,id).agent},PhysicsEngine.prototype.getParticles=function(){return this._particles},PhysicsEngine.prototype.getBodies=function(){return this._bodies},PhysicsEngine.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},PhysicsEngine.prototype.forEachParticle=function(fn,dt){for(var particles=this.getParticles(),index=0,len=particles.length;len>index;index++)fn.call(this,particles[index],dt)},PhysicsEngine.prototype.forEachBody=function(fn,dt){if(this._hasBodies)for(var bodies=this.getBodies(),index=0,len=bodies.length;len>index;index++)fn.call(this,bodies[index],dt)},PhysicsEngine.prototype.forEach=function(fn,dt){this.forEachParticle(fn,dt),this.forEachBody(fn,dt)},PhysicsEngine.prototype.getAgentEnergy=function(agentId){var agentData=_getAgentData.call(this,agentId);return agentData.agent.getEnergy(agentData.targets,agentData.source)},PhysicsEngine.prototype.getEnergy=function(){return _getParticlesEnergy.call(this)+_getAgentsEnergy.call(this)},PhysicsEngine.prototype.step=function(){if(!this.isSleeping()){var currTime=now(),dtFrame=currTime-this._prevTime;this._prevTime=currTime,MIN_TIME_STEP>dtFrame||(dtFrame>MAX_TIME_STEP&&(dtFrame=MAX_TIME_STEP),_integrate.call(this,TIMESTEP),this.emit(_events.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},PhysicsEngine.prototype.isSleeping=function(){return this._isSleeping
},PhysicsEngine.prototype.isActive=function(){return!this._isSleeping},PhysicsEngine.prototype.sleep=function(){this._isSleeping||(this.forEach(function(body){body.sleep()}),this.emit(_events.end,this),this._isSleeping=!0)},PhysicsEngine.prototype.wake=function(){this._isSleeping&&(this._prevTime=now(),this.emit(_events.start,this),this._isSleeping=!1)},PhysicsEngine.prototype.emit=function(type,data){null!==this._eventHandler&&this._eventHandler.emit(type,data)},PhysicsEngine.prototype.on=function(event,fn){null===this._eventHandler&&(this._eventHandler=new EventHandler),this._eventHandler.on(event,fn)},module.exports=PhysicsEngine},{"../core/EventHandler":7}],49:[function(_dereq_,module){function Body(options){Particle.call(this,options),options=options||{},this.orientation=new Quaternion,this.angularVelocity=new Vector,this.angularMomentum=new Vector,this.torque=new Vector,options.orientation&&this.orientation.set(options.orientation),options.angularVelocity&&this.angularVelocity.set(options.angularVelocity),options.angularMomentum&&this.angularMomentum.set(options.angularMomentum),options.torque&&this.torque.set(options.torque),this.angularVelocity.w=0,this.setMomentsOfInertia(),this.pWorld=new Vector}var Particle=_dereq_("./Particle"),Transform=_dereq_("../../core/Transform"),Vector=_dereq_("../../math/Vector"),Quaternion=_dereq_("../../math/Quaternion"),Matrix=_dereq_("../../math/Matrix"),Integrator=_dereq_("../integrators/SymplecticEuler");Body.DEFAULT_OPTIONS=Particle.DEFAULT_OPTIONS,Body.DEFAULT_OPTIONS.orientation=[0,0,0,1],Body.DEFAULT_OPTIONS.angularVelocity=[0,0,0],Body.prototype=Object.create(Particle.prototype),Body.prototype.constructor=Body,Body.prototype.isBody=!0,Body.prototype.setMass=function(){Particle.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},Body.prototype.setMomentsOfInertia=function(){this.inertia=new Matrix,this.inverseInertia=new Matrix},Body.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},Body.prototype.toWorldCoordinates=function(localPosition){return this.pWorld.set(this.orientation.rotateVector(localPosition))},Body.prototype.getEnergy=function(){return Particle.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},Body.prototype.reset=function(p,v,q,L){Particle.prototype.reset.call(this,p,v),this.angularVelocity.clear(),this.setOrientation(q||[1,0,0,0]),this.setAngularMomentum(L||[0,0,0])},Body.prototype.setOrientation=function(q){this.orientation.set(q)},Body.prototype.setAngularVelocity=function(w){this.wake(),this.angularVelocity.set(w)},Body.prototype.setAngularMomentum=function(L){this.wake(),this.angularMomentum.set(L)},Body.prototype.applyForce=function(force,location){Particle.prototype.applyForce.call(this,force),void 0!==location&&this.applyTorque(location.cross(force))},Body.prototype.applyTorque=function(torque){this.wake(),this.torque.set(this.torque.add(torque))},Body.prototype.getTransform=function(){return Transform.thenMove(this.orientation.getTransform(),Transform.getTranslate(Particle.prototype.getTransform.call(this)))},Body.prototype._integrate=function(dt){Particle.prototype._integrate.call(this,dt),this.integrateAngularMomentum(dt),this.updateAngularVelocity(dt),this.integrateOrientation(dt)},Body.prototype.integrateAngularMomentum=function(dt){Integrator.integrateAngularMomentum(this,dt)},Body.prototype.integrateOrientation=function(dt){Integrator.integrateOrientation(this,dt)},module.exports=Body},{"../../core/Transform":15,"../../math/Matrix":37,"../../math/Quaternion":38,"../../math/Vector":41,"../integrators/SymplecticEuler":72,"./Particle":51}],50:[function(_dereq_,module){function Circle(options){options=options||{},this.setRadius(options.radius||0),Body.call(this,options)}var Body=_dereq_("./Body"),Matrix=_dereq_("../../math/Matrix");Circle.prototype=Object.create(Body.prototype),Circle.prototype.constructor=Circle,Circle.prototype.setRadius=function(r){this.radius=r,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},Circle.prototype.setMomentsOfInertia=function(){var m=this.mass,r=this.radius;this.inertia=new Matrix([[.25*m*r*r,0,0],[0,.25*m*r*r,0],[0,0,.5*m*r*r]]),this.inverseInertia=new Matrix([[4/(m*r*r),0,0],[0,4/(m*r*r),0],[0,0,2/(m*r*r)]])},module.exports=Circle},{"../../math/Matrix":37,"./Body":49}],51:[function(_dereq_,module){function Particle(options){options=options||{};var defaults=Particle.DEFAULT_OPTIONS;this.position=new Vector,this.velocity=new Vector,this.force=new Vector,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==options.mass?options.mass:defaults.mass,this.inverseMass=1/this.mass,this.setPosition(options.position||defaults.position),this.setVelocity(options.velocity||defaults.velocity),this.force.set(options.force||[0,0,0]),this.transform=Transform.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}}function _createEventOutput(){this._eventOutput=new EventHandler,this._eventOutput.bindThis(this),EventHandler.setOutputHandler(this,this._eventOutput)}var Vector=_dereq_("../../math/Vector"),Transform=_dereq_("../../core/Transform"),EventHandler=_dereq_("../../core/EventHandler"),Integrator=_dereq_("../integrators/SymplecticEuler");Particle.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var _events={start:"start",update:"update",end:"end"},now=Date.now;Particle.prototype.isBody=!1,Particle.prototype.isActive=function(){return!this._isSleeping},Particle.prototype.sleep=function(){this._isSleeping||(this.emit(_events.end,this),this._isSleeping=!0)},Particle.prototype.wake=function(){this._isSleeping&&(this.emit(_events.start,this),this._isSleeping=!1,this._prevTime=now(),this._engine&&this._engine.wake())},Particle.prototype.setPosition=function(position){this.position.set(position)},Particle.prototype.setPosition1D=function(x){this.position.x=x},Particle.prototype.getPosition=function(){return this._engine.step(),this.position.get()},Particle.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},Particle.prototype.setVelocity=function(velocity){this.velocity.set(velocity),(0!==velocity[0]||0!==velocity[1]||0!==velocity[2])&&this.wake()},Particle.prototype.setVelocity1D=function(x){this.velocity.x=x,0!==x&&this.wake()},Particle.prototype.getVelocity=function(){return this.velocity.get()},Particle.prototype.setForce=function(force){this.force.set(force),this.wake()},Particle.prototype.getVelocity1D=function(){return this.velocity.x},Particle.prototype.setMass=function(mass){this.mass=mass,this.inverseMass=1/mass},Particle.prototype.getMass=function(){return this.mass},Particle.prototype.reset=function(position,velocity){this.setPosition(position||[0,0,0]),this.setVelocity(velocity||[0,0,0])},Particle.prototype.applyForce=function(force){force.isZero()||(this.force.add(force).put(this.force),this.wake())},Particle.prototype.applyImpulse=function(impulse){if(!impulse.isZero()){var velocity=this.velocity;velocity.add(impulse.mult(this.inverseMass)).put(velocity)}},Particle.prototype.integrateVelocity=function(dt){Integrator.integrateVelocity(this,dt)},Particle.prototype.integratePosition=function(dt){Integrator.integratePosition(this,dt)},Particle.prototype._integrate=function(dt){this.integrateVelocity(dt),this.integratePosition(dt)},Particle.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},Particle.prototype.getTransform=function(){this._engine.step();var position=this.position,transform=this.transform;return transform[12]=position.x,transform[13]=position.y,transform[14]=position.z,transform},Particle.prototype.modify=function(target){var _spec=this._spec.target;return _spec.transform=this.getTransform(),_spec.target=target,this._spec},Particle.prototype.emit=function(type,data){this._eventOutput&&this._eventOutput.emit(type,data)},Particle.prototype.on=function(){return _createEventOutput.call(this),this.on.apply(this,arguments)},Particle.prototype.removeListener=function(){return _createEventOutput.call(this),this.removeListener.apply(this,arguments)},Particle.prototype.pipe=function(){return _createEventOutput.call(this),this.pipe.apply(this,arguments)},Particle.prototype.unpipe=function(){return _createEventOutput.call(this),this.unpipe.apply(this,arguments)},module.exports=Particle},{"../../core/EventHandler":7,"../../core/Transform":15,"../../math/Vector":41,"../integrators/SymplecticEuler":72}],52:[function(_dereq_,module){function Rectangle(options){options=options||{},this.size=options.size||[0,0],Body.call(this,options)}var Body=_dereq_("./Body"),Matrix=_dereq_("../../math/Matrix");Rectangle.prototype=Object.create(Body.prototype),Rectangle.prototype.constructor=Rectangle,Rectangle.prototype.setSize=function(size){this.size=size,this.setMomentsOfInertia()},Rectangle.prototype.setMomentsOfInertia=function(){var m=this.mass,w=this.size[0],h=this.size[1];this.inertia=new Matrix([[m*h*h/12,0,0],[0,m*w*w/12,0],[0,0,m*(w*w+h*h)/12]]),this.inverseInertia=new Matrix([[12/(m*h*h),0,0],[0,12/(m*w*w),0],[0,0,12/(m*(w*w+h*h))]])},module.exports=Rectangle},{"../../math/Matrix":37,"./Body":49}],53:[function(_dereq_,module){module.exports={Body:_dereq_("./Body"),Circle:_dereq_("./Circle"),Particle:_dereq_("./Particle"),Rectangle:_dereq_("./Rectangle")}},{"./Body":49,"./Circle":50,"./Particle":51,"./Rectangle":52}],54:[function(_dereq_,module){function Collision(options){this.options=Object.create(Collision.DEFAULT_OPTIONS),options&&this.setOptions(options),this.normal=new Vector,this.pDiff=new Vector,this.vDiff=new Vector,this.impulse1=new Vector,this.impulse2=new Vector,Constraint.call(this)}var Constraint=_dereq_("./Constraint"),Vector=_dereq_("../../math/Vector");Collision.prototype=Object.create(Constraint.prototype),Collision.prototype.constructor=Collision,Collision.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},Collision.prototype.setOptions=function(options){for(var key in options)this.options[key]=options[key]},Collision.prototype.applyConstraint=function(targets,source,dt){if(void 0!==source)for(var v1=source.velocity,p1=source.position,w1=source.inverseMass,r1=source.radius,options=this.options,drift=options.drift,slop=-options.slop,restitution=options.restitution,n=this.normal,pDiff=this.pDiff,vDiff=this.vDiff,impulse1=this.impulse1,impulse2=this.impulse2,i=0;i<targets.length;i++){var target=targets[i];if(target!==source){var v2=target.velocity,p2=target.position,w2=target.inverseMass,r2=target.radius;pDiff.set(p2.sub(p1)),vDiff.set(v2.sub(v1));var dist=pDiff.norm(),overlap=dist-(r1+r2),effMass=1/(w1+w2),gamma=0;if(0>overlap){if(n.set(pDiff.normalize()),this._eventOutput){var collisionData={target:target,source:source,overlap:overlap,normal:n};this._eventOutput.emit("preCollision",collisionData),this._eventOutput.emit("collision",collisionData)}var lambda=slop>=overlap?((1+restitution)*n.dot(vDiff)+drift/dt*(overlap-slop))/(gamma+dt/effMass):(1+restitution)*n.dot(vDiff)/(gamma+dt/effMass);n.mult(dt*lambda).put(impulse1),impulse1.mult(-1).put(impulse2),source.applyImpulse(impulse1),target.applyImpulse(impulse2),this._eventOutput&&this._eventOutput.emit("postCollision",collisionData)}}}},module.exports=Collision},{"../../math/Vector":41,"./Constraint":55}],55:[function(_dereq_,module){function Constraint(){this.options=this.options||{},this._eventOutput=new EventHandler,EventHandler.setOutputHandler(this,this._eventOutput)}var EventHandler=_dereq_("../../core/EventHandler");Constraint.prototype.setOptions=function(options){this._eventOutput.emit("change",options)},Constraint.prototype.applyConstraint=function(){},Constraint.prototype.getEnergy=function(){return 0},module.exports=Constraint},{"../../core/EventHandler":7}],56:[function(_dereq_,module){function Curve(options){this.options=Object.create(Curve.DEFAULT_OPTIONS),options&&this.setOptions(options),this.J=new Vector,this.impulse=new Vector,Constraint.call(this)}var Constraint=_dereq_("./Constraint"),Vector=_dereq_("../../math/Vector");Curve.prototype=Object.create(Constraint.prototype),Curve.prototype.constructor=Curve;var epsilon=1e-7,pi=Math.PI;Curve.DEFAULT_OPTIONS={equation:function(){return 0},plane:function(x,y,z){return z},period:0,dampingRatio:0},Curve.prototype.setOptions=function(options){for(var key in options)this.options[key]=options[key]},Curve.prototype.applyConstraint=function(targets,source,dt){for(var options=this.options,impulse=this.impulse,J=this.J,f=options.equation,g=options.plane,dampingRatio=options.dampingRatio,period=options.period,i=0;i<targets.length;i++){var gamma,beta,body=targets[i],v=body.velocity,p=body.position,m=body.mass;if(0===period)gamma=0,beta=1;else{var c=4*m*pi*dampingRatio/period,k=4*m*pi*pi/(period*period);gamma=1/(c+dt*k),beta=dt*k/(c+dt*k)}var x=p.x,y=p.y,z=p.z,f0=f(x,y,z),dfx=(f(x+epsilon,p,p)-f0)/epsilon,dfy=(f(x,y+epsilon,p)-f0)/epsilon,dfz=(f(x,y,p+epsilon)-f0)/epsilon,g0=g(x,y,z),dgx=(g(x+epsilon,y,z)-g0)/epsilon,dgy=(g(x,y+epsilon,z)-g0)/epsilon,dgz=(g(x,y,z+epsilon)-g0)/epsilon;J.setXYZ(dfx+dgx,dfy+dgy,dfz+dgz);var antiDrift=beta/dt*(f0+g0),lambda=-(J.dot(v)+antiDrift)/(gamma+dt*J.normSquared()/m);impulse.set(J.mult(dt*lambda)),body.applyImpulse(impulse)}},module.exports=Curve},{"../../math/Vector":41,"./Constraint":55}],57:[function(_dereq_,module){function Distance(options){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),options&&this.setOptions(options),this.impulse=new Vector,this.normal=new Vector,this.diffP=new Vector,this.diffV=new Vector,Constraint.call(this)}var Constraint=_dereq_("./Constraint"),Vector=_dereq_("../../math/Vector");Distance.prototype=Object.create(Constraint.prototype),Distance.prototype.constructor=Distance,Distance.DEFAULT_OPTIONS={anchor:null,length:0,minLength:0,period:0,dampingRatio:0};var pi=Math.PI;Distance.prototype.setOptions=function(options){options.anchor&&(options.anchor.position instanceof Vector&&(this.options.anchor=options.anchor.position),options.anchor instanceof Vector&&(this.options.anchor=options.anchor),options.anchor instanceof Array&&(this.options.anchor=new Vector(options.anchor))),void 0!==options.length&&(this.options.length=options.length),void 0!==options.dampingRatio&&(this.options.dampingRatio=options.dampingRatio),void 0!==options.period&&(this.options.period=options.period),void 0!==options.minLength&&(this.options.minLength=options.minLength)},Distance.prototype.setAnchor=function(anchor){this.options.anchor||(this.options.anchor=new Vector),this.options.anchor.set(anchor)},Distance.prototype.applyConstraint=function(targets,source,dt){var p2,w2,n=this.normal,diffP=this.diffP,diffV=this.diffV,impulse=this.impulse,options=this.options,dampingRatio=options.dampingRatio,period=options.period,minLength=options.minLength;if(source){var v2=source.velocity;p2=source.position,w2=source.inverseMass}else p2=this.options.anchor,w2=0;for(var length=this.options.length,i=0;i<targets.length;i++){var body=targets[i],v1=body.velocity,p1=body.position,w1=body.inverseMass;diffP.set(p1.sub(p2)),n.set(diffP.normalize());var dist=diffP.norm()-length;if(Math.abs(dist)<minLength)return;diffV.set(source?v1.sub(v2):v1);var gamma,beta,effMass=1/(w1+w2);if(0===period)gamma=0,beta=1;else{var c=4*effMass*pi*dampingRatio/period,k=4*effMass*pi*pi/(period*period);gamma=1/(c+dt*k),beta=dt*k/(c+dt*k)}var antiDrift=beta/dt*dist,lambda=-(n.dot(diffV)+antiDrift)/(gamma+dt/effMass);impulse.set(n.mult(dt*lambda)),body.applyImpulse(impulse),source&&source.applyImpulse(impulse.mult(-1))}},module.exports=Distance},{"../../math/Vector":41,"./Constraint":55}],58:[function(_dereq_,module){function Snap(options){Constraint.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),options&&this.setOptions(options),this.pDiff=new Vector,this.vDiff=new Vector,this.impulse1=new Vector,this.impulse2=new Vector}var Constraint=_dereq_("./Constraint"),Vector=_dereq_("../../math/Vector");Snap.prototype=Object.create(Constraint.prototype),Snap.prototype.constructor=Snap,Snap.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var pi=Math.PI;Snap.prototype.setOptions=function(options){void 0!==options.anchor&&(options.anchor instanceof Vector&&(this.options.anchor=options.anchor),options.anchor.position instanceof Vector&&(this.options.anchor=options.anchor.position),options.anchor instanceof Array&&(this.options.anchor=new Vector(options.anchor))),void 0!==options.length&&(this.options.length=options.length),void 0!==options.dampingRatio&&(this.options.dampingRatio=options.dampingRatio),void 0!==options.period&&(this.options.period=options.period),Constraint.prototype.setOptions.call(this,options)},Snap.prototype.getEnergy=function(targets,source){for(var options=this.options,restLength=options.length,anchor=options.anchor||source.position,strength=Math.pow(2*pi/options.period,2),energy=0,i=0;i<targets.length;i++){var target=targets[i],dist=anchor.sub(target.position).norm()-restLength;energy+=.5*strength*dist*dist}return energy},Snap.prototype.applyConstraint=function(targets,source,dt){for(var options=this.options,pDiff=this.pDiff,vDiff=this.vDiff,impulse1=this.impulse1,impulse2=this.impulse2,length=options.length,anchor=options.anchor||source.position,period=options.period,dampingRatio=options.dampingRatio,i=0;i<targets.length;i++){var target=targets[i],p1=target.position,v1=target.velocity,m1=target.mass,w1=target.inverseMass;pDiff.set(p1.sub(anchor));var effMass,dist=pDiff.norm()-length;if(source){var w2=source.inverseMass,v2=source.velocity;vDiff.set(v1.sub(v2)),effMass=1/(w1+w2)}else vDiff.set(v1),effMass=m1;var gamma,beta;if(0===this.options.period)gamma=0,beta=1;else{var k=4*effMass*pi*pi/(period*period),c=4*effMass*pi*dampingRatio/period;beta=dt*k/(c+dt*k),gamma=1/(c+dt*k)}var antiDrift=beta/dt*dist;pDiff.normalize(-antiDrift).sub(vDiff).mult(dt/(gamma+dt/effMass)).put(impulse1),target.applyImpulse(impulse1),source&&(impulse1.mult(-1).put(impulse2),source.applyImpulse(impulse2))}},module.exports=Snap},{"../../math/Vector":41,"./Constraint":55}],59:[function(_dereq_,module){function Surface(options){this.options=Object.create(Surface.DEFAULT_OPTIONS),options&&this.setOptions(options),this.J=new Vector,this.impulse=new Vector,Constraint.call(this)}var Constraint=_dereq_("./Constraint"),Vector=_dereq_("../../math/Vector");Surface.prototype=Object.create(Constraint.prototype),Surface.prototype.constructor=Surface,Surface.DEFAULT_OPTIONS={equation:void 0,period:0,dampingRatio:0};var epsilon=1e-7,pi=Math.PI;Surface.prototype.setOptions=function(options){for(var key in options)this.options[key]=options[key]},Surface.prototype.applyConstraint=function(targets,source,dt){for(var impulse=this.impulse,J=this.J,options=this.options,f=options.equation,dampingRatio=options.dampingRatio,period=options.period,i=0;i<targets.length;i++){var gamma,beta,particle=targets[i],v=particle.velocity,p=particle.position,m=particle.mass;if(0===period)gamma=0,beta=1;else{var c=4*m*pi*dampingRatio/period,k=4*m*pi*pi/(period*period);gamma=1/(c+dt*k),beta=dt*k/(c+dt*k)}var x=p.x,y=p.y,z=p.z,f0=f(x,y,z),dfx=(f(x+epsilon,p,p)-f0)/epsilon,dfy=(f(x,y+epsilon,p)-f0)/epsilon,dfz=(f(x,y,p+epsilon)-f0)/epsilon;J.setXYZ(dfx,dfy,dfz);var antiDrift=beta/dt*f0,lambda=-(J.dot(v)+antiDrift)/(gamma+dt*J.normSquared()/m);impulse.set(J.mult(dt*lambda)),particle.applyImpulse(impulse)}},module.exports=Surface},{"../../math/Vector":41,"./Constraint":55}],60:[function(_dereq_,module){function Wall(options){this.options=Object.create(Wall.DEFAULT_OPTIONS),options&&this.setOptions(options),this.diff=new Vector,this.impulse=new Vector,Constraint.call(this)}function _getNormalVelocity(n,v){return v.dot(n)}function _getDistanceFromOrigin(p){var n=this.options.normal,d=this.options.distance;return p.dot(n)+d}function _onEnter(particle,overlap,dt){var p=particle.position,v=particle.velocity,m=particle.mass,n=this.options.normal,action=this.options.onContact,restitution=this.options.restitution,impulse=this.impulse,drift=this.options.drift,slop=-this.options.slop,gamma=0;if(this._eventOutput){var data={particle:particle,wall:this,overlap:overlap,normal:n};this._eventOutput.emit("preCollision",data),this._eventOutput.emit("collision",data)}switch(action){case Wall.ON_CONTACT.REFLECT:var lambda=slop>overlap?-((1+restitution)*n.dot(v)+drift/dt*(overlap-slop))/(m*dt+gamma):-((1+restitution)*n.dot(v))/(m*dt+gamma);impulse.set(n.mult(dt*lambda)),particle.applyImpulse(impulse),particle.setPosition(p.add(n.mult(-overlap)))}this._eventOutput&&this._eventOutput.emit("postCollision",data)}function _onExit(particle,overlap){var action=this.options.onContact,p=particle.position,n=this.options.normal;action===Wall.ON_CONTACT.REFLECT&&particle.setPosition(p.add(n.mult(-overlap)))}var Constraint=_dereq_("./Constraint"),Vector=_dereq_("../../math/Vector");Wall.prototype=Object.create(Constraint.prototype),Wall.prototype.constructor=Wall,Wall.ON_CONTACT={REFLECT:0,SILENT:1},Wall.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:Wall.ON_CONTACT.REFLECT},Wall.prototype.setOptions=function(options){void 0!==options.normal&&(options.normal instanceof Vector&&(this.options.normal=options.normal.clone()),options.normal instanceof Array&&(this.options.normal=new Vector(options.normal))),void 0!==options.restitution&&(this.options.restitution=options.restitution),void 0!==options.drift&&(this.options.drift=options.drift),void 0!==options.slop&&(this.options.slop=options.slop),void 0!==options.distance&&(this.options.distance=options.distance),void 0!==options.onContact&&(this.options.onContact=options.onContact)},Wall.prototype.applyConstraint=function(targets,source,dt){for(var n=this.options.normal,i=0;i<targets.length;i++){var particle=targets[i],p=particle.position,v=particle.velocity,r=particle.radius||0,overlap=_getDistanceFromOrigin.call(this,p.add(n.mult(-r))),nv=_getNormalVelocity.call(this,n,v);0>=overlap&&(0>nv?_onEnter.call(this,particle,overlap,dt):_onExit.call(this,particle,overlap,dt))}},module.exports=Wall},{"../../math/Vector":41,"./Constraint":55}],61:[function(_dereq_,module){function Walls(options){this.options=Object.create(Walls.DEFAULT_OPTIONS),options&&this.setOptions(options),_createComponents.call(this,options.sides||this.options.sides),Constraint.call(this)}function _getDistance(side,size,origin){var distance,SIDES=Walls.SIDES;switch(parseInt(side)){case SIDES.LEFT:distance=size[0]*origin[0];break;case SIDES.TOP:distance=size[1]*origin[1];break;case SIDES.FRONT:distance=size[2]*origin[2];break;case SIDES.RIGHT:distance=size[0]*(1-origin[0]);break;case SIDES.BOTTOM:distance=size[1]*(1-origin[1]);break;case SIDES.BACK:distance=size[2]*(1-origin[2])}return distance}function _createComponents(sides){this.components={};for(var components=this.components,i=0;i<sides.length;i++){var side=sides[i];components[i]=new Wall({normal:_SIDE_NORMALS[side].clone(),distance:_getDistance(side,this.options.size,this.options.origin)})}}function _setOptionsForEach(options){this.forEach(function(wall){wall.setOptions(options)});for(var key in options)this.options[key]=options[key]}var Constraint=_dereq_("./Constraint"),Wall=_dereq_("./Wall"),Vector=_dereq_("../../math/Vector");Walls.prototype=Object.create(Constraint.prototype),Walls.prototype.constructor=Walls,Walls.ON_CONTACT=Wall.ON_CONTACT,Walls.SIDES={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5,TWO_DIMENSIONAL:[0,1,2,3],THREE_DIMENSIONAL:[0,1,2,3,4,5]},Walls.DEFAULT_OPTIONS={sides:Walls.SIDES.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],drift:.5,slop:0,restitution:.5,onContact:Walls.ON_CONTACT.REFLECT};var _SIDE_NORMALS={0:new Vector(1,0,0),1:new Vector(-1,0,0),2:new Vector(0,1,0),3:new Vector(0,-1,0),4:new Vector(0,0,1),5:new Vector(0,0,-1)};Walls.prototype.setOptions=function(options){var resizeFlag=!1;void 0!==options.restitution&&_setOptionsForEach.call(this,{restitution:options.restitution}),void 0!==options.drift&&_setOptionsForEach.call(this,{drift:options.drift}),void 0!==options.slop&&_setOptionsForEach.call(this,{slop:options.slop}),void 0!==options.onContact&&_setOptionsForEach.call(this,{onContact:options.onContact}),void 0!==options.size&&(resizeFlag=!0),void 0!==options.sides&&(this.options.sides=options.sides),void 0!==options.origin&&(resizeFlag=!0),resizeFlag&&this.setSize(options.size,options.origin)},Walls.prototype.setSize=function(size,origin){origin=origin||this.options.origin,origin.length<3&&(origin[2]=.5),this.forEach(function(wall,side){var d=_getDistance(side,size,origin);wall.setOptions({distance:d})}),this.options.size=size,this.options.origin=origin},Walls.prototype.applyConstraint=function(targets,source,dt){this.forEach(function(wall){wall.applyConstraint(targets,source,dt)})},Walls.prototype.forEach=function(fn){var sides=this.options.sides;for(var key in this.sides)fn(sides[key],key)},Walls.prototype.rotateZ=function(angle){this.forEach(function(wall){var n=wall.options.normal;n.rotateZ(angle).put(n)})},Walls.prototype.rotateX=function(angle){this.forEach(function(wall){var n=wall.options.normal;n.rotateX(angle).put(n)})},Walls.prototype.rotateY=function(angle){this.forEach(function(wall){var n=wall.options.normal;n.rotateY(angle).put(n)})},module.exports=Walls},{"../../math/Vector":41,"./Constraint":55,"./Wall":60}],62:[function(_dereq_,module){module.exports={Collision:_dereq_("./Collision"),Constraint:_dereq_("./Constraint"),Curve:_dereq_("./Curve"),Distance:_dereq_("./Distance"),Snap:_dereq_("./Snap"),Surface:_dereq_("./Surface"),Wall:_dereq_("./Wall"),Walls:_dereq_("./Walls")}},{"./Collision":54,"./Constraint":55,"./Curve":56,"./Distance":57,"./Snap":58,"./Surface":59,"./Wall":60,"./Walls":61}],63:[function(_dereq_,module){function Drag(options){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),options&&this.setOptions(options),Force.call(this)}var Force=_dereq_("./Force");Drag.prototype=Object.create(Force.prototype),Drag.prototype.constructor=Drag,Drag.FORCE_FUNCTIONS={LINEAR:function(velocity){return velocity},QUADRATIC:function(velocity){return velocity.mult(velocity.norm())}},Drag.DEFAULT_OPTIONS={strength:.01,forceFunction:Drag.FORCE_FUNCTIONS.LINEAR},Drag.prototype.applyForce=function(targets){var index,particle,strength=this.options.strength,forceFunction=this.options.forceFunction,force=this.force;for(index=0;index<targets.length;index++)particle=targets[index],forceFunction(particle.velocity).mult(-strength).put(force),particle.applyForce(force)},Drag.prototype.setOptions=function(options){for(var key in options)this.options[key]=options[key]},module.exports=Drag},{"./Force":64}],64:[function(_dereq_,module){function Force(force){this.force=new Vector(force),this._eventOutput=new EventHandler,EventHandler.setOutputHandler(this,this._eventOutput)}var Vector=_dereq_("../../math/Vector"),EventHandler=_dereq_("../../core/EventHandler");Force.prototype.setOptions=function(options){this._eventOutput.emit("change",options)},Force.prototype.applyForce=function(targets){for(var length=targets.length;length--;)targets[length].applyForce(this.force)},Force.prototype.getEnergy=function(){return 0},module.exports=Force},{"../../core/EventHandler":7,"../../math/Vector":41}],65:[function(_dereq_,module){function Repulsion(options){this.options=Object.create(Repulsion.DEFAULT_OPTIONS),options&&this.setOptions(options),this.disp=new Vector,Force.call(this)}var Force=_dereq_("./Force"),Vector=_dereq_("../../math/Vector");Repulsion.prototype=Object.create(Force.prototype),Repulsion.prototype.constructor=Repulsion,Repulsion.DECAY_FUNCTIONS={LINEAR:function(r,cutoff){return Math.max(1-1/cutoff*r,0)},MORSE:function(r,cutoff){var r0=0===cutoff?100:cutoff,rShifted=r+r0*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(rShifted/r0-1),2),0)},INVERSE:function(r,cutoff){return 1/(1-cutoff+r)},GRAVITY:function(r,cutoff){return 1/(1-cutoff+r*r)}},Repulsion.DEFAULT_OPTIONS={strength:1,anchor:void 0,range:[0,1/0],cutoff:0,cap:1/0,decayFunction:Repulsion.DECAY_FUNCTIONS.GRAVITY},Repulsion.prototype.setOptions=function(options){void 0!==options.anchor&&(options.anchor.position instanceof Vector&&(this.options.anchor=options.anchor.position),options.anchor instanceof Array&&(this.options.anchor=new Vector(options.anchor)),delete options.anchor);for(var key in options)this.options[key]=options[key]},Repulsion.prototype.applyForce=function(targets,source){var options=this.options,force=this.force,disp=this.disp,strength=options.strength,anchor=options.anchor||source.position,cap=options.cap,cutoff=options.cutoff,rMin=options.range[0],rMax=options.range[1],decayFn=options.decayFunction;if(0!==strength)for(var particle,m1,p1,r,length=targets.length;length--;)particle=targets[length],particle!==source&&(m1=particle.mass,p1=particle.position,disp.set(p1.sub(anchor)),r=disp.norm(),rMax>r&&r>rMin&&(force.set(disp.normalize(strength*m1*decayFn(r,cutoff)).cap(cap)),particle.applyForce(force)))},module.exports=Repulsion},{"../../math/Vector":41,"./Force":64}],66:[function(_dereq_,module){function RotationalDrag(options){Drag.call(this,options)}var Drag=_dereq_("./Drag");RotationalDrag.prototype=Object.create(Drag.prototype),RotationalDrag.prototype.constructor=RotationalDrag,RotationalDrag.DEFAULT_OPTIONS=Drag.DEFAULT_OPTIONS,RotationalDrag.FORCE_FUNCTIONS=Drag.FORCE_FUNCTIONS,RotationalDrag.FORCE_FUNCTIONS={LINEAR:function(angularVelocity){return angularVelocity},QUADRATIC:function(angularVelocity){return angularVelocity.mult(angularVelocity.norm())}},RotationalDrag.prototype.applyForce=function(targets){var index,particle,strength=this.options.strength,forceFunction=this.options.forceFunction,force=this.force;for(index=0;index<targets.length;index++)particle=targets[index],forceFunction(particle.angularVelocity).mult(-100*strength).put(force),particle.applyTorque(force)},RotationalDrag.prototype.setOptions=function(options){for(var key in options)this.options[key]=options[key]},module.exports=RotationalDrag},{"./Drag":63}],67:[function(_dereq_,module){function RotationalSpring(options){Spring.call(this,options)}function _calcStiffness(){var options=this.options;options.stiffness=Math.pow(2*pi/options.period,2)}function _calcDamping(){var options=this.options;options.damping=4*pi*options.dampingRatio/options.period}function _init(){_calcStiffness.call(this),_calcDamping.call(this)}var Force=_dereq_("./Force"),Spring=_dereq_("./Spring"),Quaternion=_dereq_("../../math/Quaternion");RotationalSpring.prototype=Object.create(Spring.prototype),RotationalSpring.prototype.constructor=RotationalSpring,RotationalSpring.DEFAULT_OPTIONS=Spring.DEFAULT_OPTIONS,RotationalSpring.FORCE_FUNCTIONS=Spring.FORCE_FUNCTIONS;var pi=Math.PI;RotationalSpring.prototype.setOptions=function(options){void 0!==options.anchor&&(options.anchor instanceof Quaternion&&(this.options.anchor=options.anchor),options.anchor instanceof Array&&(this.options.anchor=new Quaternion(options.anchor))),void 0!==options.period&&(this.options.period=options.period),void 0!==options.dampingRatio&&(this.options.dampingRatio=options.dampingRatio),void 0!==options.length&&(this.options.length=options.length),void 0!==options.forceFunction&&(this.options.forceFunction=options.forceFunction),void 0!==options.maxLength&&(this.options.maxLength=options.maxLength),_init.call(this),Force.prototype.setOptions.call(this,options)},RotationalSpring.prototype.applyForce=function(targets){var i,target,dist,m,force=this.force,options=this.options,disp=this.disp,stiffness=options.stiffness,damping=options.damping,restLength=options.length,anchor=options.anchor,forceFunction=options.forceFunction,maxLength=options.maxLength;for(i=0;i<targets.length;i++){if(target=targets[i],disp.set(anchor.sub(target.orientation)),dist=disp.norm()-restLength,0===dist)return;m=target.mass,stiffness*=m,damping*=m,force.set(disp.normalize(stiffness*forceFunction(dist,maxLength))),damping&&force.add(target.angularVelocity.mult(-damping)).put(force),target.applyTorque(force)
}},RotationalSpring.prototype.getEnergy=function(targets){for(var options=this.options,restLength=options.length,anchor=options.anchor,strength=options.stiffness,energy=0,i=0;i<targets.length;i++){var target=targets[i],dist=anchor.sub(target.orientation).norm()-restLength;energy+=.5*strength*dist*dist}return energy},module.exports=RotationalSpring},{"../../math/Quaternion":38,"./Force":64,"./Spring":68}],68:[function(_dereq_,module){function Spring(options){Force.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),options&&this.setOptions(options),this.disp=new Vector(0,0,0),_init.call(this)}function _calcStiffness(){var options=this.options;options.stiffness=Math.pow(2*pi/options.period,2)}function _calcDamping(){var options=this.options;options.damping=4*pi*options.dampingRatio/options.period}function _init(){_calcStiffness.call(this),_calcDamping.call(this)}var Force=_dereq_("./Force"),Vector=_dereq_("../../math/Vector");Spring.prototype=Object.create(Force.prototype),Spring.prototype.constructor=Spring;var pi=Math.PI,MIN_PERIOD=150;Spring.FORCE_FUNCTIONS={FENE:function(dist,rMax){var rMaxSmall=.99*rMax,r=Math.max(Math.min(dist,rMaxSmall),-rMaxSmall);return r/(1-r*r/(rMax*rMax))},HOOK:function(dist){return dist}},Spring.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:Spring.FORCE_FUNCTIONS.HOOK},Spring.prototype.setOptions=function(options){void 0!==options.anchor&&(options.anchor.position instanceof Vector&&(this.options.anchor=options.anchor.position),options.anchor instanceof Vector&&(this.options.anchor=options.anchor),options.anchor instanceof Array&&(this.options.anchor=new Vector(options.anchor))),void 0!==options.period&&(options.period<MIN_PERIOD&&(options.period=MIN_PERIOD,console.warn("The period of a SpringTransition is capped at "+MIN_PERIOD+" ms. Use a SnapTransition for faster transitions")),this.options.period=options.period),void 0!==options.dampingRatio&&(this.options.dampingRatio=options.dampingRatio),void 0!==options.length&&(this.options.length=options.length),void 0!==options.forceFunction&&(this.options.forceFunction=options.forceFunction),void 0!==options.maxLength&&(this.options.maxLength=options.maxLength),_init.call(this),Force.prototype.setOptions.call(this,options)},Spring.prototype.applyForce=function(targets,source){var i,target,p2,v2,dist,m,force=this.force,disp=this.disp,options=this.options,stiffness=options.stiffness,damping=options.damping,restLength=options.length,maxLength=options.maxLength,anchor=options.anchor||source.position,forceFunction=options.forceFunction;for(i=0;i<targets.length;i++){if(target=targets[i],p2=target.position,v2=target.velocity,anchor.sub(p2).put(disp),dist=disp.norm()-restLength,0===dist)return;m=target.mass,stiffness*=m,damping*=m,disp.normalize(stiffness*forceFunction(dist,maxLength)).put(force),damping&&(source?force.add(v2.sub(source.velocity).mult(-damping)).put(force):force.add(v2.mult(-damping)).put(force)),target.applyForce(force),source&&source.applyForce(force.mult(-1))}},Spring.prototype.getEnergy=function(targets,source){for(var options=this.options,restLength=options.length,anchor=source?source.position:options.anchor,strength=options.stiffness,energy=0,i=0;i<targets.length;i++){var target=targets[i],dist=anchor.sub(target.position).norm()-restLength;energy+=.5*strength*dist*dist}return energy},module.exports=Spring},{"../../math/Vector":41,"./Force":64}],69:[function(_dereq_,module){function VectorField(options){Force.call(this),this.options=Object.create(VectorField.DEFAULT_OPTIONS),options&&this.setOptions(options),this.evaluation=new Vector}function _setFieldOptions(field){var FIELDS=VectorField.FIELDS;switch(field){case FIELDS.CONSTANT:this.options.direction?this.options.direction instanceof Array&&(this.options.direction=new Vector(this.options.direction)):this.options.direction=new Vector(0,1,0);break;case FIELDS.POINT_ATTRACTOR:this.options.position?this.options.position instanceof Array&&(this.options.position=new Vector(this.options.position)):this.options.position=new Vector(0,0,0)}}var Force=_dereq_("./Force"),Vector=_dereq_("../../math/Vector");VectorField.prototype=Object.create(Force.prototype),VectorField.prototype.constructor=VectorField,VectorField.FIELDS={CONSTANT:function(v,options){options.direction.put(this.evaluation)},LINEAR:function(v){v.put(this.evaluation)},RADIAL:function(v){v.mult(-1).put(this.evaluation)},POINT_ATTRACTOR:function(v,options){options.position.sub(v).put(this.evaluation)}},VectorField.DEFAULT_OPTIONS={strength:.01,field:VectorField.FIELDS.CONSTANT},VectorField.prototype.setOptions=function(options){void 0!==options.strength&&(this.options.strength=options.strength),void 0!==options.field&&(this.options.field=options.field,_setFieldOptions.call(this,this.options.field))},VectorField.prototype.applyForce=function(targets){var i,target,force=this.force,strength=this.options.strength,field=this.options.field;for(i=0;i<targets.length;i++)target=targets[i],field.call(this,target.position,this.options),this.evaluation.mult(target.mass*strength).put(force),target.applyForce(force)},VectorField.prototype.getEnergy=function(targets){var i,target,field=this.options.field,FIELDS=VectorField.FIELDS,energy=0;switch(field){case FIELDS.CONSTANT:energy=targets.length*this.options.direction.norm();break;case FIELDS.RADIAL:for(i=0;i<targets.length;i++)target=targets[i],energy+=target.position.norm();break;case FIELDS.POINT_ATTRACTOR:for(i=0;i<targets.length;i++)target=targets[i],energy+=target.position.sub(this.options.position).norm()}return energy*=this.options.strength},module.exports=VectorField},{"../../math/Vector":41,"./Force":64}],70:[function(_dereq_,module){module.exports={Drag:_dereq_("./Drag"),Force:_dereq_("./Force"),Repulsion:_dereq_("./Repulsion"),RotationalDrag:_dereq_("./RotationalDrag"),RotationalSpring:_dereq_("./RotationalSpring"),Spring:_dereq_("./Spring"),VectorField:_dereq_("./VectorField")}},{"./Drag":63,"./Force":64,"./Repulsion":65,"./RotationalDrag":66,"./RotationalSpring":67,"./Spring":68,"./VectorField":69}],71:[function(_dereq_,module){module.exports={PhysicsEngine:_dereq_("./PhysicsEngine"),bodies:_dereq_("./bodies"),constraints:_dereq_("./constraints"),forces:_dereq_("./forces"),integrators:_dereq_("./integrators")}},{"./PhysicsEngine":48,"./bodies":53,"./constraints":62,"./forces":70,"./integrators":73}],72:[function(_dereq_,module){var SymplecticEuler={};SymplecticEuler.integrateVelocity=function(body,dt){var v=body.velocity,w=body.inverseMass,f=body.force;f.isZero()||(v.add(f.mult(dt*w)).put(v),f.clear())},SymplecticEuler.integratePosition=function(body,dt){var p=body.position,v=body.velocity;p.add(v.mult(dt)).put(p)},SymplecticEuler.integrateAngularMomentum=function(body,dt){var L=body.angularMomentum,t=body.torque;t.isZero()||(L.add(t.mult(dt)).put(L),t.clear())},SymplecticEuler.integrateOrientation=function(body,dt){var q=body.orientation,w=body.angularVelocity;w.isZero()||q.add(q.multiply(w).scalarMultiply(.5*dt)).put(q)},module.exports=SymplecticEuler},{}],73:[function(_dereq_,module){module.exports={SymplecticEuler:_dereq_("./SymplecticEuler")}},{"./SymplecticEuler":72}],74:[function(_dereq_,module){function CanvasSurface(options){options&&options.canvasSize&&(this._canvasSize=options.canvasSize),Surface.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var Surface=_dereq_("../core/Surface");CanvasSurface.prototype=Object.create(Surface.prototype),CanvasSurface.prototype.constructor=CanvasSurface,CanvasSurface.prototype.elementType="canvas",CanvasSurface.prototype.elementClass="famous-surface",CanvasSurface.prototype.setContent=function(){},CanvasSurface.prototype.deploy=function(target){this._canvasSize&&(target.width=this._canvasSize[0],target.height=this._canvasSize[1]),"2d"===this._contextId&&(target.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},CanvasSurface.prototype.recall=function(target){this.getSize();this._backBuffer.width=target.width,this._backBuffer.height=target.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(target,0,0),target.width=0,target.height=0)},CanvasSurface.prototype.getContext=function(contextId){return this._contextId=contextId,this._currentTarget?this._currentTarget.getContext(contextId):this._backBuffer.getContext(contextId)},CanvasSurface.prototype.setSize=function(size,canvasSize){Surface.prototype.setSize.apply(this,arguments),canvasSize&&(this._canvasSize=[canvasSize[0],canvasSize[1]]),this._currentTarget&&(this._currentTarget.width=this._canvasSize[0],this._currentTarget.height=this._canvasSize[1])},module.exports=CanvasSurface},{"../core/Surface":14}],75:[function(_dereq_,module){function ContainerSurface(options){Surface.call(this,options),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new Context(this._container),this.setContent(this._container)}var Surface=_dereq_("../core/Surface"),Context=_dereq_("../core/Context");ContainerSurface.prototype=Object.create(Surface.prototype),ContainerSurface.prototype.constructor=ContainerSurface,ContainerSurface.prototype.elementType="div",ContainerSurface.prototype.elementClass="famous-surface",ContainerSurface.prototype.add=function(){return this.context.add.apply(this.context,arguments)},ContainerSurface.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),Surface.prototype.render.apply(this,arguments)},ContainerSurface.prototype.deploy=function(){return this._shouldRecalculateSize=!0,Surface.prototype.deploy.apply(this,arguments)},ContainerSurface.prototype.commit=function(){var previousSize=this._size?[this._size[0],this._size[1]]:null,result=Surface.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||previousSize&&(this._size[0]!==previousSize[0]||this._size[1]!==previousSize[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),result},module.exports=ContainerSurface},{"../core/Context":1,"../core/Surface":14}],76:[function(_dereq_,module){function FormContainerSurface(options){options&&(this._method=options.method||""),ContainerSurface.apply(this,arguments)}var ContainerSurface=_dereq_("./ContainerSurface");FormContainerSurface.prototype=Object.create(ContainerSurface.prototype),FormContainerSurface.prototype.constructor=FormContainerSurface,FormContainerSurface.prototype.elementType="form",FormContainerSurface.prototype.deploy=function(target){return this._method&&(target.method=this._method),ContainerSurface.prototype.deploy.apply(this,arguments)},module.exports=FormContainerSurface},{"./ContainerSurface":75}],77:[function(_dereq_,module){function ImageSurface(){this._imageUrl=void 0,Surface.apply(this,arguments)}var Surface=_dereq_("../core/Surface"),urlCache=[],countCache=[],nodeCache=[],cacheEnabled=!0;ImageSurface.enableCache=function(){cacheEnabled=!0},ImageSurface.disableCache=function(){cacheEnabled=!1},ImageSurface.clearCache=function(){urlCache=[],countCache=[],nodeCache=[]},ImageSurface.getCache=function(){return{urlCache:urlCache,countCache:countCache,nodeCache:countCache}},ImageSurface.prototype=Object.create(Surface.prototype),ImageSurface.prototype.constructor=ImageSurface,ImageSurface.prototype.elementType="img",ImageSurface.prototype.elementClass="famous-surface",ImageSurface.prototype.setContent=function(imageUrl){var urlIndex=urlCache.indexOf(this._imageUrl);-1!==urlIndex&&(1===countCache[urlIndex]?(urlCache.splice(urlIndex,1),countCache.splice(urlIndex,1),nodeCache.splice(urlIndex,1)):countCache[urlIndex]--),urlIndex=urlCache.indexOf(imageUrl),-1===urlIndex?(urlCache.push(imageUrl),countCache.push(1)):countCache[urlIndex]++,this._imageUrl=imageUrl,this._contentDirty=!0},ImageSurface.prototype.deploy=function(target){var urlIndex=urlCache.indexOf(this._imageUrl);if(void 0===nodeCache[urlIndex]&&cacheEnabled){var img=new Image;img.src=this._imageUrl||"",nodeCache[urlIndex]=img}target.src=this._imageUrl||""},ImageSurface.prototype.recall=function(target){target.src=""},module.exports=ImageSurface},{"../core/Surface":14}],78:[function(_dereq_,module){function InputSurface(options){this._placeholder=options.placeholder||"",this._value=options.value||"",this._type=options.type||"text",this._name=options.name||"",Surface.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(event){event.target!==this._currentTarget&&this.blur()}.bind(this))}var Surface=_dereq_("../core/Surface");InputSurface.prototype=Object.create(Surface.prototype),InputSurface.prototype.constructor=InputSurface,InputSurface.prototype.elementType="input",InputSurface.prototype.elementClass="famous-surface",InputSurface.prototype.setPlaceholder=function(str){return this._placeholder=str,this._contentDirty=!0,this},InputSurface.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},InputSurface.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},InputSurface.prototype.setValue=function(str){return this._value=str,this._contentDirty=!0,this},InputSurface.prototype.setType=function(str){return this._type=str,this._contentDirty=!0,this},InputSurface.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},InputSurface.prototype.setName=function(str){return this._name=str,this._contentDirty=!0,this},InputSurface.prototype.getName=function(){return this._name},InputSurface.prototype.deploy=function(target){""!==this._placeholder&&(target.placeholder=this._placeholder),target.value=this._value,target.type=this._type,target.name=this._name},module.exports=InputSurface},{"../core/Surface":14}],79:[function(_dereq_,module){function SubmitInputSurface(options){InputSurface.apply(this,arguments),this._type="submit",options&&options.onClick&&this.setOnClick(options.onClick)}var InputSurface=_dereq_("./InputSurface");SubmitInputSurface.prototype=Object.create(InputSurface.prototype),SubmitInputSurface.prototype.constructor=SubmitInputSurface,SubmitInputSurface.prototype.setOnClick=function(onClick){this.onClick=onClick},SubmitInputSurface.prototype.deploy=function(target){this.onclick&&(target.onClick=this.onClick),InputSurface.prototype.deploy.apply(this,arguments)},module.exports=SubmitInputSurface},{"./InputSurface":78}],80:[function(_dereq_,module){function TextareaSurface(options){this._placeholder=options.placeholder||"",this._value=options.value||"",this._name=options.name||"",this._wrap=options.wrap||"",this._cols=options.cols||"",this._rows=options.rows||"",Surface.apply(this,arguments),this.on("click",this.focus.bind(this))}var Surface=_dereq_("../core/Surface");TextareaSurface.prototype=Object.create(Surface.prototype),TextareaSurface.prototype.constructor=TextareaSurface,TextareaSurface.prototype.elementType="textarea",TextareaSurface.prototype.elementClass="famous-surface",TextareaSurface.prototype.setPlaceholder=function(str){return this._placeholder=str,this._contentDirty=!0,this},TextareaSurface.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},TextareaSurface.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},TextareaSurface.prototype.setValue=function(str){return this._value=str,this._contentDirty=!0,this},TextareaSurface.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},TextareaSurface.prototype.setName=function(str){return this._name=str,this._contentDirty=!0,this},TextareaSurface.prototype.getName=function(){return this._name},TextareaSurface.prototype.setWrap=function(str){return this._wrap=str,this._contentDirty=!0,this},TextareaSurface.prototype.setColumns=function(num){return this._cols=num,this._contentDirty=!0,this},TextareaSurface.prototype.setRows=function(num){return this._rows=num,this._contentDirty=!0,this},TextareaSurface.prototype.deploy=function(target){""!==this._placeholder&&(target.placeholder=this._placeholder),""!==this._value&&(target.value=this._value),""!==this._name&&(target.name=this._name),""!==this._wrap&&(target.wrap=this._wrap),""!==this._cols&&(target.cols=this._cols),""!==this._rows&&(target.rows=this._rows)},module.exports=TextareaSurface},{"../core/Surface":14}],81:[function(_dereq_,module){function VideoSurface(options){Surface.apply(this,arguments),this._videoUrl=void 0,this.options=Object.create(VideoSurface.DEFAULT_OPTIONS),options&&this.setOptions(options)}var Surface=_dereq_("../core/Surface");VideoSurface.prototype=Object.create(Surface.prototype),VideoSurface.prototype.constructor=VideoSurface,VideoSurface.DEFAULT_OPTIONS={autoplay:!1},VideoSurface.prototype.elementType="video",VideoSurface.prototype.elementClass="famous-surface",VideoSurface.prototype.setOptions=function(options){options.size&&this.setSize(options.size),options.classes&&this.setClasses(options.classes),options.properties&&this.setProperties(options.properties),options.autoplay&&(this.options.autoplay=options.autoplay),options.src&&(this._videoUrl=options.src,this._contentDirty=!0)},VideoSurface.prototype.setContent=function(videoUrl){this._videoUrl=videoUrl,this._contentDirty=!0},VideoSurface.prototype.deploy=function(target){target.src=this._videoUrl,target.autoplay=this.options.autoplay},VideoSurface.prototype.recall=function(target){target.src=""},module.exports=VideoSurface},{"../core/Surface":14}],82:[function(_dereq_,module){module.exports={CanvasSurface:_dereq_("./CanvasSurface"),ContainerSurface:_dereq_("./ContainerSurface"),FormContainerSurface:_dereq_("./FormContainerSurface"),ImageSurface:_dereq_("./ImageSurface"),InputSurface:_dereq_("./InputSurface"),SubmitInputSurface:_dereq_("./SubmitInputSurface"),TextareaSurface:_dereq_("./TextareaSurface"),VideoSurface:_dereq_("./VideoSurface")}},{"./CanvasSurface":74,"./ContainerSurface":75,"./FormContainerSurface":76,"./ImageSurface":77,"./InputSurface":78,"./SubmitInputSurface":79,"./TextareaSurface":80,"./VideoSurface":81}],83:[function(_dereq_,module){function CachedMap(mappingFunction){this._map=mappingFunction||null,this._cachedOutput=null,this._cachedInput=Number.NaN}CachedMap.create=function(mappingFunction){var instance=new CachedMap(mappingFunction);return instance.get.bind(instance)},CachedMap.prototype.get=function(input){return input!==this._cachedInput&&(this._cachedInput=input,this._cachedOutput=this._map(input)),this._cachedOutput},module.exports=CachedMap},{}],84:[function(_dereq_,module){var Easing={inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:1===t?1:(p||(p=.3),s=p/(2*Math.PI)*Math.asin(1/a),-(a*Math.pow(2,10*(t-=1))*Math.sin(2*(t-s)*Math.PI/p)))},outElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:1===t?1:(p||(p=.3),s=p/(2*Math.PI)*Math.asin(1/a),a*Math.pow(2,-10*t)*Math.sin(2*(t-s)*Math.PI/p)+1)},inOutElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:2===(t/=.5)?1:(p||(p=.3*1.5),s=p/(2*Math.PI)*Math.asin(1/a),1>t?-.5*a*Math.pow(2,10*(t-=1))*Math.sin(2*(t-s)*Math.PI/p):a*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-s)*Math.PI/p)*.5+1)},inBack:function(t,s){return void 0===s&&(s=1.70158),t*t*((s+1)*t-s)},outBack:function(t,s){return void 0===s&&(s=1.70158),--t*t*((s+1)*t+s)+1},inOutBack:function(t,s){return void 0===s&&(s=1.70158),(t/=.5)<1?.5*t*t*(((s*=1.525)+1)*t-s):.5*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)},inBounce:function(t){return 1-Easing.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*Easing.inBounce(2*t):.5*Easing.outBounce(2*t-1)+.5}};module.exports=Easing},{}],85:[function(_dereq_,module){function MultipleTransition(method){this.method=method,this._instances=[],this.state=[]}var Utility=_dereq_("../utilities/Utility");MultipleTransition.SUPPORTS_MULTIPLE=!0,MultipleTransition.prototype.get=function(){for(var i=0;i<this._instances.length;i++)this.state[i]=this._instances[i].get();return this.state},MultipleTransition.prototype.set=function(endState,transition,callback){for(var _allCallback=Utility.after(endState.length,callback),i=0;i<endState.length;i++)this._instances[i]||(this._instances[i]=new this.method),this._instances[i].set(endState[i],transition,_allCallback)},MultipleTransition.prototype.reset=function(startState){for(var i=0;i<startState.length;i++)this._instances[i]||(this._instances[i]=new this.method),this._instances[i].reset(startState[i])},module.exports=MultipleTransition},{"../utilities/Utility":95}],86:[function(_dereq_,module){function SnapTransition(state){state=state||0,this.endState=new Vector(state),this.initState=new Vector,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new PE,this.particle=new Particle,this.spring=new Spring({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function _getEnergy(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function _setAbsoluteRestTolerance(){var distance=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===distance?this._restTolerance:this._restTolerance*distance}function _setTarget(target){this.endState.set(target),_setAbsoluteRestTolerance.call(this)}function _wake(){this.PE.wake()}function _sleep(){this.PE.sleep()}function _setParticlePosition(p){this.particle.position.set(p)}function _setParticleVelocity(v){this.particle.velocity.set(v)}function _getParticlePosition(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function _getParticleVelocity(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function _setCallback(callback){this._callback=callback}function _setupDefinition(definition){var defaults=SnapTransition.DEFAULT_OPTIONS;void 0===definition.period&&(definition.period=defaults.period),void 0===definition.dampingRatio&&(definition.dampingRatio=defaults.dampingRatio),void 0===definition.velocity&&(definition.velocity=defaults.velocity),this.spring.setOptions({period:definition.period,dampingRatio:definition.dampingRatio}),_setParticleVelocity.call(this,definition.velocity)}function _update(){if(this.PE.isSleeping()){if(this._callback){var cb=this._callback;this._callback=void 0,cb()}}else _getEnergy.call(this)<this._absRestTolerance&&(_setParticlePosition.call(this,this.endState),_setParticleVelocity.call(this,[0,0,0]),_sleep.call(this))}var PE=_dereq_("../physics/PhysicsEngine"),Particle=_dereq_("../physics/bodies/Particle"),Spring=_dereq_("../physics/constraints/Snap"),Vector=_dereq_("../math/Vector");SnapTransition.SUPPORTS_MULTIPLE=3,SnapTransition.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},SnapTransition.prototype.reset=function(state,velocity){this._dimensions=state instanceof Array?state.length:0,this.initState.set(state),_setParticlePosition.call(this,state),_setTarget.call(this,state),velocity&&_setParticleVelocity.call(this,velocity),_setCallback.call(this,void 0)},SnapTransition.prototype.getVelocity=function(){return _getParticleVelocity.call(this)},SnapTransition.prototype.setVelocity=function(velocity){this.call(this,_setParticleVelocity(velocity))},SnapTransition.prototype.isActive=function(){return!this.PE.isSleeping()},SnapTransition.prototype.halt=function(){this.set(this.get())},SnapTransition.prototype.get=function(){return _update.call(this),_getParticlePosition.call(this)},SnapTransition.prototype.set=function(state,definition,callback){return definition?(this._dimensions=state instanceof Array?state.length:0,_wake.call(this),_setupDefinition.call(this,definition),_setTarget.call(this,state),void _setCallback.call(this,callback)):(this.reset(state),void(callback&&callback()))},module.exports=SnapTransition},{"../math/Vector":41,"../physics/PhysicsEngine":48,"../physics/bodies/Particle":51,"../physics/constraints/Snap":58}],87:[function(_dereq_,module){function SpringTransition(state){state=state||0,this.endState=new Vector(state),this.initState=new Vector,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new PE,this.spring=new Spring({anchor:this.endState}),this.particle=new Particle,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function _getEnergy(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function _setParticlePosition(p){this.particle.setPosition(p)}function _setParticleVelocity(v){this.particle.setVelocity(v)}function _getParticlePosition(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function _getParticleVelocity(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function _setCallback(callback){this._callback=callback}function _wake(){this.PE.wake()}function _sleep(){this.PE.sleep()}function _update(){if(this.PE.isSleeping()){if(this._callback){var cb=this._callback;this._callback=void 0,cb()}}else _getEnergy.call(this)<this._absRestTolerance&&(_setParticlePosition.call(this,this.endState),_setParticleVelocity.call(this,[0,0,0]),_sleep.call(this))}function _setupDefinition(definition){var defaults=SpringTransition.DEFAULT_OPTIONS;void 0===definition.period&&(definition.period=defaults.period),void 0===definition.dampingRatio&&(definition.dampingRatio=defaults.dampingRatio),void 0===definition.velocity&&(definition.velocity=defaults.velocity),definition.period<150&&(definition.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:definition.period,dampingRatio:definition.dampingRatio}),_setParticleVelocity.call(this,definition.velocity)}function _setAbsoluteRestTolerance(){var distance=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===distance?this._restTolerance:this._restTolerance*distance}function _setTarget(target){this.endState.set(target),_setAbsoluteRestTolerance.call(this)}var PE=_dereq_("../physics/PhysicsEngine"),Particle=_dereq_("../physics/bodies/Particle"),Spring=_dereq_("../physics/forces/Spring"),Vector=_dereq_("../math/Vector");SpringTransition.SUPPORTS_MULTIPLE=3,SpringTransition.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},SpringTransition.prototype.reset=function(pos,vel){this._dimensions=pos instanceof Array?pos.length:0,this.initState.set(pos),_setParticlePosition.call(this,pos),_setTarget.call(this,pos),vel&&_setParticleVelocity.call(this,vel),_setCallback.call(this,void 0)},SpringTransition.prototype.getVelocity=function(){return _getParticleVelocity.call(this)},SpringTransition.prototype.setVelocity=function(v){this.call(this,_setParticleVelocity(v))},SpringTransition.prototype.isActive=function(){return!this.PE.isSleeping()},SpringTransition.prototype.halt=function(){this.set(this.get())},SpringTransition.prototype.get=function(){return _update.call(this),_getParticlePosition.call(this)},SpringTransition.prototype.set=function(endState,definition,callback){return definition?(this._dimensions=endState instanceof Array?endState.length:0,_wake.call(this),_setupDefinition.call(this,definition),_setTarget.call(this,endState),void _setCallback.call(this,callback)):(this.reset(endState),void(callback&&callback()))},module.exports=SpringTransition},{"../math/Vector":41,"../physics/PhysicsEngine":48,"../physics/bodies/Particle":51,"../physics/forces/Spring":68}],88:[function(_dereq_,module){function Transitionable(start){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(start)}function _loadNext(){if(this._callback){var callback=this._callback;this._callback=void 0,callback()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var method=null,endValue=this.currentAction[0],transition=this.currentAction[1];transition instanceof Object&&transition.method?(method=transition.method,"string"==typeof method&&(method=transitionMethods[method])):method=TweenTransition,this._currentMethod!==method&&(this._engineInstance=!(endValue instanceof Object)||method.SUPPORTS_MULTIPLE===!0||endValue.length<=method.SUPPORTS_MULTIPLE?new method:new MultipleTransition(method),this._currentMethod=method),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(transition.velocity=this.velocity),this._engineInstance.set(endValue,transition,_loadNext.bind(this))}var MultipleTransition=_dereq_("./MultipleTransition"),TweenTransition=_dereq_("./TweenTransition"),transitionMethods={};Transitionable.register=function(methods){var success=!0;for(var method in methods)Transitionable.registerMethod(method,methods[method])||(success=!1);return success},Transitionable.registerMethod=function(name,engineClass){return name in transitionMethods?!1:(transitionMethods[name]=engineClass,!0)},Transitionable.unregisterMethod=function(name){return name in transitionMethods?(delete transitionMethods[name],!0):!1},Transitionable.prototype.set=function(endState,transition,callback){if(!transition)return this.reset(endState),callback&&callback(),this;var action=[endState,transition];return this.actionQueue.push(action),this.callbackQueue.push(callback),this.currentAction||_loadNext.call(this),this},Transitionable.prototype.reset=function(startState,startVelocity){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=startState,this.velocity=startVelocity,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},Transitionable.prototype.delay=function(duration,callback){this.set(this.get(),{duration:duration,curve:function(){return 0}},callback)},Transitionable.prototype.get=function(timestamp){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(timestamp)),this.state},Transitionable.prototype.isActive=function(){return!!this.currentAction},Transitionable.prototype.halt=function(){return this.set(this.get())},module.exports=Transitionable},{"./MultipleTransition":85,"./TweenTransition":90}],89:[function(_dereq_,module){function TransitionableTransform(transform){this._final=Transform.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new Transitionable(this._finalTranslate),this.rotate=new Transitionable(this._finalRotate),this.skew=new Transitionable(this._finalSkew),this.scale=new Transitionable(this._finalScale),transform&&this.set(transform)
}function _build(){return Transform.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function _buildFinal(){return Transform.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var Transitionable=_dereq_("./Transitionable"),Transform=_dereq_("../core/Transform"),Utility=_dereq_("../utilities/Utility");TransitionableTransform.prototype.setTranslate=function(translate,transition,callback){return this._finalTranslate=translate,this._final=_buildFinal.call(this),this.translate.set(translate,transition,callback),this},TransitionableTransform.prototype.setScale=function(scale,transition,callback){return this._finalScale=scale,this._final=_buildFinal.call(this),this.scale.set(scale,transition,callback),this},TransitionableTransform.prototype.setRotate=function(eulerAngles,transition,callback){return this._finalRotate=eulerAngles,this._final=_buildFinal.call(this),this.rotate.set(eulerAngles,transition,callback),this},TransitionableTransform.prototype.setSkew=function(skewAngles,transition,callback){return this._finalSkew=skewAngles,this._final=_buildFinal.call(this),this.skew.set(skewAngles,transition,callback),this},TransitionableTransform.prototype.set=function(transform,transition,callback){var components=Transform.interpret(transform);this._finalTranslate=components.translate,this._finalRotate=components.rotate,this._finalSkew=components.skew,this._finalScale=components.scale,this._final=transform;var _callback=callback?Utility.after(4,callback):null;return this.translate.set(components.translate,transition,_callback),this.rotate.set(components.rotate,transition,_callback),this.skew.set(components.skew,transition,_callback),this.scale.set(components.scale,transition,_callback),this},TransitionableTransform.prototype.setDefaultTransition=function(transition){this.translate.setDefault(transition),this.rotate.setDefault(transition),this.skew.setDefault(transition),this.scale.setDefault(transition)},TransitionableTransform.prototype.get=function(){return this.isActive()?_build.call(this):this._final},TransitionableTransform.prototype.getFinal=function(){return this._final},TransitionableTransform.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},TransitionableTransform.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},module.exports=TransitionableTransform},{"../core/Transform":15,"../utilities/Utility":95,"./Transitionable":88}],90:[function(_dereq_,module){function TweenTransition(options){this.options=Object.create(TweenTransition.DEFAULT_OPTIONS),options&&this.setOptions(options),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function _interpolate(a,b,t){return(1-t)*a+t*b}function _clone(obj){return obj instanceof Object?obj instanceof Array?obj.slice(0):Object.create(obj):obj}function _normalize(transition,defaultTransition){var result={curve:defaultTransition.curve};return defaultTransition.duration&&(result.duration=defaultTransition.duration),defaultTransition.speed&&(result.speed=defaultTransition.speed),transition instanceof Object&&(void 0!==transition.duration&&(result.duration=transition.duration),transition.curve&&(result.curve=transition.curve),transition.speed&&(result.speed=transition.speed)),"string"==typeof result.curve&&(result.curve=TweenTransition.getCurve(result.curve)),result}function _calculateVelocity(current,start,curve,duration,t){var velocity,eps=1e-7,speed=(curve(t)-curve(t-eps))/eps;if(current instanceof Array){velocity=[];for(var i=0;i<current.length;i++)velocity[i]="number"==typeof current[i]?speed*(current[i]-start[i])/duration:0}else velocity=speed*(current-start)/duration;return velocity}function _calculateState(start,end,t){var state;if(start instanceof Array){state=[];for(var i=0;i<start.length;i++)state[i]="number"==typeof start[i]?_interpolate(start[i],end[i],t):start[i]}else state=_interpolate(start,end,t);return state}TweenTransition.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},TweenTransition.SUPPORTS_MULTIPLE=!0,TweenTransition.DEFAULT_OPTIONS={curve:TweenTransition.Curves.linear,duration:500,speed:0};var registeredCurves={};TweenTransition.registerCurve=function(curveName,curve){return registeredCurves[curveName]?!1:(registeredCurves[curveName]=curve,!0)},TweenTransition.unregisterCurve=function(curveName){return registeredCurves[curveName]?(delete registeredCurves[curveName],!0):!1},TweenTransition.getCurve=function(curveName){var curve=registeredCurves[curveName];if(void 0!==curve)return curve;throw new Error("curve not registered")},TweenTransition.getCurves=function(){return registeredCurves},TweenTransition.prototype.setOptions=function(options){void 0!==options.curve&&(this.options.curve=options.curve),void 0!==options.duration&&(this.options.duration=options.duration),void 0!==options.speed&&(this.options.speed=options.speed)},TweenTransition.prototype.set=function(endValue,transition,callback){if(!transition)return this.reset(endValue),void(callback&&callback());if(this._startValue=_clone(this.get()),transition=_normalize(transition,this.options),transition.speed){var startValue=this._startValue;if(startValue instanceof Object){var variance=0;for(var i in startValue)variance+=(endValue[i]-startValue[i])*(endValue[i]-startValue[i]);transition.duration=Math.sqrt(variance)/transition.speed}else transition.duration=Math.abs(endValue-startValue)/transition.speed}this._startTime=Date.now(),this._endValue=_clone(endValue),this._startVelocity=_clone(transition.velocity),this._duration=transition.duration,this._curve=transition.curve,this._active=!0,this._callback=callback},TweenTransition.prototype.reset=function(startValue,startVelocity){if(this._callback){var callback=this._callback;this._callback=void 0,callback()}this.state=_clone(startValue),this.velocity=_clone(startVelocity),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},TweenTransition.prototype.getVelocity=function(){return this.velocity},TweenTransition.prototype.get=function(timestamp){return this.update(timestamp),this.state},TweenTransition.prototype.update=function(timestamp){if(this._active){if(timestamp||(timestamp=Date.now()),!(this._updateTime>=timestamp)){this._updateTime=timestamp;var timeSinceStart=timestamp-this._startTime;if(timeSinceStart>=this._duration)this.state=this._endValue,this.velocity=_calculateVelocity(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>timeSinceStart)this.state=this._startValue,this.velocity=this._startVelocity;else{var t=timeSinceStart/this._duration;this.state=_calculateState(this._startValue,this._endValue,this._curve(t)),this.velocity=_calculateVelocity(this.state,this._startValue,this._curve,this._duration,t)}}}else if(this._callback){var callback=this._callback;this._callback=void 0,callback()}},TweenTransition.prototype.isActive=function(){return this._active},TweenTransition.prototype.halt=function(){this.reset(this.get())},TweenTransition.registerCurve("linear",TweenTransition.Curves.linear),TweenTransition.registerCurve("easeIn",TweenTransition.Curves.easeIn),TweenTransition.registerCurve("easeOut",TweenTransition.Curves.easeOut),TweenTransition.registerCurve("easeInOut",TweenTransition.Curves.easeInOut),TweenTransition.registerCurve("easeOutBounce",TweenTransition.Curves.easeOutBounce),TweenTransition.registerCurve("spring",TweenTransition.Curves.spring),TweenTransition.customCurve=function(v1,v2){return v1=v1||0,v2=v2||0,function(t){return v1*t+(-2*v1-v2+3)*t*t+(v1+v2-2)*t*t*t}},module.exports=TweenTransition},{}],91:[function(_dereq_,module){function WallTransition(state){state=state||0,this.endState=new Vector(state),this.initState=new Vector,this.spring=new Spring({anchor:this.endState}),this.wall=new Wall,this._restTolerance=1e-10,this._dimensions=1,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new PE,this.particle=new Particle,this.PE.addBody(this.particle),this.PE.attach([this.wall,this.spring],this.particle)}function _getEnergy(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function _setAbsoluteRestTolerance(){var distance=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===distance?this._restTolerance:this._restTolerance*distance}function _wake(){this.PE.wake()}function _sleep(){this.PE.sleep()}function _setTarget(target){this.endState.set(target);var dist=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:0===dist?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)}),_setAbsoluteRestTolerance.call(this)}function _setParticlePosition(p){this.particle.position.set(p)}function _setParticleVelocity(v){this.particle.velocity.set(v)}function _getParticlePosition(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function _getParticleVelocity(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function _setCallback(callback){this._callback=callback}function _update(){if(this.PE.isSleeping()){if(this._callback){var cb=this._callback;this._callback=void 0,cb()}}else{var energy=_getEnergy.call(this);energy<this._absRestTolerance&&(_sleep.call(this),_setParticlePosition.call(this,this.endState),_setParticleVelocity.call(this,[0,0,0]))}}function _setupDefinition(def){var defaults=WallTransition.DEFAULT_OPTIONS;void 0===def.period&&(def.period=defaults.period),void 0===def.dampingRatio&&(def.dampingRatio=defaults.dampingRatio),void 0===def.velocity&&(def.velocity=defaults.velocity),void 0===def.restitution&&(def.restitution=defaults.restitution),this.spring.setOptions({period:def.period,dampingRatio:def.dampingRatio}),this.wall.setOptions({restitution:def.restitution}),_setParticleVelocity.call(this,def.velocity)}var PE=_dereq_("../physics/PhysicsEngine"),Particle=_dereq_("../physics/bodies/Particle"),Spring=_dereq_("../physics/forces/Spring"),Wall=_dereq_("../physics/constraints/Wall"),Vector=_dereq_("../math/Vector");WallTransition.SUPPORTS_MULTIPLE=3,WallTransition.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,restitution:.5},WallTransition.prototype.reset=function(state,velocity){this._dimensions=state instanceof Array?state.length:0,this.initState.set(state),_setParticlePosition.call(this,state),velocity&&_setParticleVelocity.call(this,velocity),_setTarget.call(this,state),_setCallback.call(this,void 0)},WallTransition.prototype.getVelocity=function(){return _getParticleVelocity.call(this)},WallTransition.prototype.setVelocity=function(velocity){this.call(this,_setParticleVelocity(velocity))},WallTransition.prototype.isActive=function(){return!this.PE.isSleeping()},WallTransition.prototype.halt=function(){this.set(this.get())},WallTransition.prototype.get=function(){return _update.call(this),_getParticlePosition.call(this)},WallTransition.prototype.set=function(state,definition,callback){return definition?(this._dimensions=state instanceof Array?state.length:0,_wake.call(this),_setupDefinition.call(this,definition),_setTarget.call(this,state),void _setCallback.call(this,callback)):(this.reset(state),void(callback&&callback()))},module.exports=WallTransition},{"../math/Vector":41,"../physics/PhysicsEngine":48,"../physics/bodies/Particle":51,"../physics/constraints/Wall":60,"../physics/forces/Spring":68}],92:[function(_dereq_,module){module.exports={CachedMap:_dereq_("./CachedMap"),Easing:_dereq_("./Easing"),MultipleTransition:_dereq_("./MultipleTransition"),SnapTransition:_dereq_("./SnapTransition"),SpringTransition:_dereq_("./SpringTransition"),Transitionable:_dereq_("./Transitionable"),TransitionableTransform:_dereq_("./TransitionableTransform"),TweenTransition:_dereq_("./TweenTransition"),WallTransition:_dereq_("./WallTransition")}},{"./CachedMap":83,"./Easing":84,"./MultipleTransition":85,"./SnapTransition":86,"./SpringTransition":87,"./Transitionable":88,"./TransitionableTransform":89,"./TweenTransition":90,"./WallTransition":91}],93:[function(_dereq_,module){var KeyCodes={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};module.exports=KeyCodes},{}],94:[function(_dereq_,module){function addTimerFunction(fn){return FamousEngine.on(_event,fn),fn}function setTimeout(fn,duration){var t=getTime(),callback=function(){var t2=getTime();t2-t>=duration&&(fn.apply(this,arguments),FamousEngine.removeListener(_event,callback))};return addTimerFunction(callback)}function setInterval(fn,duration){var t=getTime(),callback=function(){var t2=getTime();t2-t>=duration&&(fn.apply(this,arguments),t=getTime())};return addTimerFunction(callback)}function after(fn,numTicks){if(void 0===numTicks)return void 0;var callback=function(){numTicks--,0>=numTicks&&(fn.apply(this,arguments),clear(callback))};return addTimerFunction(callback)}function every(fn,numTicks){numTicks=numTicks||1;var initial=numTicks,callback=function(){numTicks--,0>=numTicks&&(fn.apply(this,arguments),numTicks=initial)};return addTimerFunction(callback)}function clear(fn){FamousEngine.removeListener(_event,fn)}function debounce(func,wait){var timeout,ctx,timestamp,result,args;return function(){ctx=this,args=arguments,timestamp=getTime();var fn=function(){var last=getTime-timestamp;wait>last?timeout=setTimeout(fn,wait-last):(timeout=null,result=func.apply(ctx,args))};return clear(timeout),timeout=setTimeout(fn,wait),result}}var FamousEngine=_dereq_("../core/Engine"),_event="prerender",getTime=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};module.exports={setTimeout:setTimeout,setInterval:setInterval,debounce:debounce,after:after,every:every,clear:clear}},{"../core/Engine":4}],95:[function(_dereq_,module){var Utility={};Utility.Direction={X:0,Y:1,Z:2},Utility.after=function(count,callback){var counter=count;return function(){counter--,0===counter&&callback.apply(this,arguments)}},Utility.loadURL=function(url,callback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){4===this.readyState&&callback&&callback(this.responseText)},xhr.open("GET",url),xhr.send()},Utility.createDocumentFragmentFromHTML=function(html){var element=document.createElement("div");element.innerHTML=html;for(var result=document.createDocumentFragment();element.hasChildNodes();)result.appendChild(element.firstChild);return result},Utility.clone=function(b){var a;if("object"==typeof b){a=b instanceof Array?[]:{};for(var key in b)if("object"==typeof b[key]&&null!==b[key])if(b[key]instanceof Array){a[key]=new Array(b[key].length);for(var i=0;i<b[key].length;i++)a[key][i]=Utility.clone(b[key][i])}else a[key]=Utility.clone(b[key]);else a[key]=b[key]}else a=b;return a},module.exports=Utility},{}],96:[function(_dereq_,module){module.exports={KeyCodes:_dereq_("./KeyCodes"),Timer:_dereq_("./Timer"),Utility:_dereq_("./Utility")}},{"./KeyCodes":93,"./Timer":94,"./Utility":95}],97:[function(_dereq_,module){function ContextualView(options){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||ContextualView.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._eventInput=new EventHandler,this._eventOutput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput),this._id=Entity.register(this)}var Entity=_dereq_("../core/Entity"),EventHandler=(_dereq_("../core/Transform"),_dereq_("../core/EventHandler")),OptionsManager=_dereq_("../core/OptionsManager");ContextualView.DEFAULT_OPTIONS={},ContextualView.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},ContextualView.prototype.getOptions=function(key){return this._optionsManager.getOptions(key)},ContextualView.prototype.render=function(){return this._id},ContextualView.prototype.commit=function(){},module.exports=ContextualView},{"../core/Entity":5,"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Transform":15}],98:[function(_dereq_,module){function Deck(){SequentialLayout.apply(this,arguments),this.state=new Transitionable(0),this._isOpen=!1,this.setOutputFunction(function(input,offset,index){var state=_getState.call(this),positionMatrix=this.options.direction===Utility.Direction.X?Transform.translate(state*offset,0,.001*(state-1)*offset):Transform.translate(0,state*offset,.001*(state-1)*offset),output=input.render();if(this.options.stackRotation){var amount=this.options.stackRotation*index*(1-state);output={transform:Transform.rotateZ(amount),origin:[.5,.5],target:output}}return{transform:positionMatrix,size:input.getSize(),target:output}})}function _getState(returnFinal){return returnFinal?this._isOpen?1:0:this.state.get()}function _setState(pos,transition,callback){this.state.halt(),this.state.set(pos,transition,callback)}var Transform=_dereq_("../core/Transform"),OptionsManager=_dereq_("../core/OptionsManager"),Transitionable=_dereq_("../transitions/Transitionable"),Utility=_dereq_("../utilities/Utility"),SequentialLayout=_dereq_("./SequentialLayout");Deck.prototype=Object.create(SequentialLayout.prototype),Deck.prototype.constructor=Deck,Deck.DEFAULT_OPTIONS=OptionsManager.patch(SequentialLayout.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),Deck.prototype.getSize=function(){var originalSize=SequentialLayout.prototype.getSize.apply(this,arguments),firstSize=this._items?this._items.get().getSize():[0,0];firstSize||(firstSize=[0,0]);var state=_getState.call(this),invState=1-state;return[firstSize[0]*invState+originalSize[0]*state,firstSize[1]*invState+originalSize[1]*state]},Deck.prototype.isOpen=function(){return this._isOpen},Deck.prototype.open=function(callback){this._isOpen=!0,_setState.call(this,1,this.options.transition,callback)},Deck.prototype.close=function(callback){this._isOpen=!1,_setState.call(this,0,this.options.transition,callback)},Deck.prototype.toggle=function(callback){this._isOpen?this.close(callback):this.open(callback)},module.exports=Deck},{"../core/OptionsManager":10,"../core/Transform":15,"../transitions/Transitionable":88,"../utilities/Utility":95,"./SequentialLayout":110}],99:[function(_dereq_,module){function DrawerLayout(options){this.options=Object.create(DrawerLayout.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._position=new Transitionable(0),this._direction=_getDirectionFromSide(this.options.side),this._orientation=_getOrientationFromSide(this.options.side),this._isOpen=!1,this._cachedLength=0,this.drawer=new RenderNode,this.content=new RenderNode,this._eventInput=new EventHandler,this._eventOutput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput),this._eventInput.on("update",_handleUpdate.bind(this)),this._eventInput.on("end",_handleEnd.bind(this))}function _getDirectionFromSide(side){var SIDES=DrawerLayout.SIDES;return side===SIDES.LEFT||side===SIDES.RIGHT?DIRECTION_X:DIRECTION_Y}function _getOrientationFromSide(side){var SIDES=DrawerLayout.SIDES;return side===SIDES.LEFT||side===SIDES.TOP?1:-1}function _resolveNodeSize(node){var size,options=this.options;if(options.drawerLength)size=options.drawerLength;else{var nodeSize=node.getSize();size=nodeSize?nodeSize[this._direction]:options.drawerLength}return this._orientation*size}function _handleUpdate(data){var MIN_LENGTH,MAX_LENGTH,newPosition=this.getPosition()+data.delta;this._cachedLength=_resolveNodeSize.call(this,this.drawer),1===this._orientation?(MIN_LENGTH=0,MAX_LENGTH=this._cachedLength):(MIN_LENGTH=this._cachedLength,MAX_LENGTH=0),newPosition>MAX_LENGTH?newPosition=MAX_LENGTH:MIN_LENGTH>newPosition&&(newPosition=MIN_LENGTH),this.setPosition(newPosition)}function _handleEnd(data){var velocity=data.velocity,position=this._orientation*this.getPosition(),options=this.options,MAX_LENGTH=this._orientation*this._cachedLength,positionThreshold=options.positionThreshold||MAX_LENGTH/2,velocityThreshold=options.velocityThreshold;if(options.transition instanceof Object&&(options.transition.velocity=data.velocity),0===position)return void(this._isOpen=!1);if(position===MAX_LENGTH)return void(this._isOpen=!0);var shouldToggle=Math.abs(velocity)>velocityThreshold||!this._isOpen&&position>positionThreshold||this._isOpen&&positionThreshold>position;shouldToggle?this.toggle():this.reset()}var RenderNode=_dereq_("../core/RenderNode"),Transform=_dereq_("../core/Transform"),OptionsManager=_dereq_("../core/OptionsManager"),Transitionable=_dereq_("../transitions/Transitionable"),EventHandler=_dereq_("../core/EventHandler"),DIRECTION_X=0,DIRECTION_Y=1;DrawerLayout.SIDES={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},DrawerLayout.DEFAULT_OPTIONS={side:DrawerLayout.SIDES.LEFT,drawerLength:0,velocityThreshold:0,positionThreshold:0,transition:!0},DrawerLayout.prototype.setOptions=function(options){this._optionsManager.setOptions(options),void 0!==options.side&&(this._direction=_getDirectionFromSide(options.side),this._orientation=_getOrientationFromSide(options.side))},DrawerLayout.prototype.open=function(transition,callback){transition instanceof Function&&(callback=transition),void 0===transition&&(transition=this.options.transition),this._cachedLength=_resolveNodeSize.call(this,this.drawer),this.setPosition(this._cachedLength,transition,callback),this._isOpen||(this._isOpen=!0,this._eventOutput.emit("open"))},DrawerLayout.prototype.close=function(transition,callback){transition instanceof Function&&(callback=transition),void 0===transition&&(transition=this.options.transition),this.setPosition(0,transition,callback),this._isOpen&&(this._isOpen=!1,this._eventOutput.emit("close"))},DrawerLayout.prototype.setPosition=function(position,transition,callback){this._position.isActive()&&this._position.halt(),this._position.set(position,transition,callback)},DrawerLayout.prototype.getPosition=function(){return this._position.get()},DrawerLayout.prototype.setProgress=function(progress,transition,callback){return this._position.set(progress*this._cachedLength,transition,callback)},DrawerLayout.prototype.getProgress=function(){return this._position.get()/this._cachedLength},DrawerLayout.prototype.toggle=function(transition){this._isOpen?this.close(transition):this.open(transition)},DrawerLayout.prototype.reset=function(transition){this._isOpen?this.open(transition):this.close(transition)},DrawerLayout.prototype.isOpen=function(){return this._isOpen},DrawerLayout.prototype.render=function(){var position=this.getPosition();(!this._isOpen&&0>position&&1===this._orientation||position>0&&-1===this._orientation)&&(position=0,this.setPosition(position));var contentTransform=this._direction===DIRECTION_X?Transform.translate(position,0,0):Transform.translate(0,position,0);return[{transform:Transform.behind,target:this.drawer.render()},{transform:contentTransform,target:this.content.render()}]},module.exports=DrawerLayout},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":88}],100:[function(_dereq_,module){function EdgeSwapper(options){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new RenderController(options),this._controller.inTransformFrom(CachedMap.create(_transformMap.bind(this,1e-4))),this._controller.outTransformFrom(CachedMap.create(_transformMap.bind(this,-1e-4))),this._eventInput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),this._entityId=Entity.register(this),options&&this.setOptions(options)}function _transformMap(zMax,progress){return Transform.translate(this._size[0]*(1-progress),0,zMax*(1-progress))}var CachedMap=_dereq_("../transitions/CachedMap"),Entity=_dereq_("../core/Entity"),EventHandler=_dereq_("../core/EventHandler"),Transform=_dereq_("../core/Transform"),RenderController=_dereq_("./RenderController");EdgeSwapper.prototype.show=function(content){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=content,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},EdgeSwapper.prototype.setOptions=function(options){this._controller.setOptions(options)},EdgeSwapper.prototype.render=function(){return this._entityId},EdgeSwapper.prototype.commit=function(context){return this._size[0]=context.size[0],this._size[1]=context.size[1],{transform:context.transform,opacity:context.opacity,origin:context.origin,size:context.size,target:this._controller.render()}},module.exports=EdgeSwapper},{"../core/Entity":5,"../core/EventHandler":7,"../core/Transform":15,"../transitions/CachedMap":83,"./RenderController":106}],101:[function(_dereq_,module){function FlexibleLayout(options){this.options=Object.create(FlexibleLayout.DEFAULT_OPTIONS),this.optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this.id=Entity.register(this),this._ratios=new Transitionable(this.options.ratios),this._nodes=[],this._size=[0,0],this._cachedDirection=null,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new EventHandler,EventHandler.setOutputHandler(this,this._eventOutput)}function _reflow(ratios,length,direction){var currTransform,ratio,node,i,translation=0,flexLength=length,ratioSum=0;for(this._cachedLengths=[],this._cachedTransforms=[],i=0;i<ratios.length;i++)ratio=ratios[i],node=this._nodes[i],"number"!=typeof ratio?flexLength-=node.getSize()[direction]||0:ratioSum+=ratio;for(i=0;i<ratios.length;i++)node=this._nodes[i],ratio=ratios[i],length="number"==typeof ratio?flexLength*ratio/ratioSum:node.getSize()[direction],currTransform=direction===FlexibleLayout.DIRECTION_X?Transform.translate(translation,0,0):Transform.translate(0,translation,0),this._cachedTransforms.push(currTransform),this._cachedLengths.push(length),translation+=length}function _trueSizedDirty(ratios,direction){for(var i=0;i<ratios.length;i++)if("number"!=typeof ratios[i]&&this._nodes[i].getSize()[direction]!==this._cachedLengths[i])return!0;return!1}var Entity=_dereq_("../core/Entity"),Transform=_dereq_("../core/Transform"),OptionsManager=_dereq_("../core/OptionsManager"),EventHandler=_dereq_("../core/EventHandler"),Transitionable=_dereq_("../transitions/Transitionable");FlexibleLayout.DIRECTION_X=0,FlexibleLayout.DIRECTION_Y=1,FlexibleLayout.DEFAULT_OPTIONS={direction:FlexibleLayout.DIRECTION_X,transition:!1,ratios:[]},FlexibleLayout.prototype.render=function(){return this.id},FlexibleLayout.prototype.setOptions=function(options){this.optionsManager.setOptions(options)},FlexibleLayout.prototype.sequenceFrom=function(sequence){if(this._nodes=sequence,0===this._ratios.get().length){for(var ratios=[],i=0;i<this._nodes.length;i++)ratios.push(1);this.setRatios(ratios)}},FlexibleLayout.prototype.setRatios=function(ratios,transition,callback){void 0===transition&&(transition=this.options.transition);var currRatios=this._ratios;0===currRatios.get().length&&(transition=void 0),currRatios.isActive()&&currRatios.halt(),currRatios.set(ratios,transition,callback),this._ratiosDirty=!0},FlexibleLayout.prototype.getSize=function(){return this._size},FlexibleLayout.prototype.commit=function(context){var size,parentSize=context.size,parentTransform=context.transform,parentOrigin=context.origin,parentOpacity=context.opacity,ratios=this._ratios.get(),direction=this.options.direction,length=parentSize[direction];(length!==this._size[direction]||this._ratiosDirty||this._ratios.isActive()||direction!==this._cachedDirection||_trueSizedDirty.call(this,ratios,direction))&&(_reflow.call(this,ratios,length,direction),length!==this._size[direction]&&(this._size[0]=parentSize[0],this._size[1]=parentSize[1]),direction!==this._cachedDirection&&(this._cachedDirection=direction),this._ratiosDirty&&(this._ratiosDirty=!1));for(var result=[],i=0;i<ratios.length;i++)size=[void 0,void 0],length=this._cachedLengths[i],size[direction]=length,result.push({transform:this._cachedTransforms[i],size:size,target:this._nodes[i].render()});return parentSize&&0!==parentOrigin[0]&&0!==parentOrigin[1]&&(parentTransform=Transform.moveThen([-parentSize[0]*parentOrigin[0],-parentSize[1]*parentOrigin[1],0],parentTransform)),{transform:parentTransform,size:parentSize,opacity:parentOpacity,target:result}},module.exports=FlexibleLayout},{"../core/Entity":5,"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Transform":15,"../transitions/Transitionable":88}],102:[function(_dereq_,module){function Flipper(options){this.options=Object.create(Flipper.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this.angle=new Transitionable(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var Transform=_dereq_("../core/Transform"),Transitionable=_dereq_("../transitions/Transitionable"),OptionsManager=(_dereq_("../core/RenderNode"),_dereq_("../core/OptionsManager"));Flipper.DIRECTION_X=0,Flipper.DIRECTION_Y=1;var SEPERATION_LENGTH=1;Flipper.DEFAULT_OPTIONS={transition:!0,direction:Flipper.DIRECTION_X},Flipper.prototype.flip=function(transition,callback){var angle=this.flipped?0:Math.PI;this.setAngle(angle,transition,callback),this.flipped=!this.flipped},Flipper.prototype.setAngle=function(angle,transition,callback){void 0===transition&&(transition=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(angle,transition,callback)},Flipper.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},Flipper.prototype.setFront=function(node){this.frontNode=node},Flipper.prototype.setBack=function(node){this.backNode=node},Flipper.prototype.render=function(){var frontTransform,backTransform,angle=this.angle.get();this.options.direction===Flipper.DIRECTION_X?(frontTransform=Transform.rotateY(angle),backTransform=Transform.rotateY(angle+Math.PI)):(frontTransform=Transform.rotateX(angle),backTransform=Transform.rotateX(angle+Math.PI));var result=[];return this.frontNode&&result.push({transform:frontTransform,target:this.frontNode.render()}),this.backNode&&result.push({transform:Transform.moveThen([0,0,SEPERATION_LENGTH],backTransform),target:this.backNode.render()}),result},module.exports=Flipper},{"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":88}],103:[function(_dereq_,module){function GridLayout(options){this.options=Object.create(GridLayout.DEFAULT_OPTIONS),this.optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this.id=Entity.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new EventHandler,EventHandler.setOutputHandler(this,this._eventOutput)}function _reflow(size,cols,rows){var usableSize=[size[0],size[1]];
usableSize[0]-=this.options.gutterSize[0]*(cols-1),usableSize[1]-=this.options.gutterSize[1]*(rows-1);for(var currX,rowSize=Math.round(usableSize[1]/rows),colSize=Math.round(usableSize[0]/cols),currY=0,currIndex=0,i=0;rows>i;i++){currX=0;for(var j=0;cols>j;j++)void 0===this._modifiers[currIndex]?_createModifier.call(this,currIndex,[colSize,rowSize],[currX,currY,0],1):_animateModifier.call(this,currIndex,[colSize,rowSize],[currX,currY,0],1),currIndex++,currX+=colSize+this.options.gutterSize[0];currY+=rowSize+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[size[0],size[1]],this._activeCount=rows*cols,i=this._activeCount;i<this._modifiers.length;i++)_animateModifier.call(this,i,[Math.round(colSize),Math.round(rowSize)],[0,0],0);this._eventOutput.emit("reflow")}function _createModifier(index,size,position,opacity){var transitionItem={transform:new TransitionableTransform(Transform.translate.apply(null,position)),opacity:new Transitionable(opacity),size:new Transitionable(size)},modifier=new Modifier({transform:transitionItem.transform,opacity:transitionItem.opacity,size:transitionItem.size});this._states[index]=transitionItem,this._modifiers[index]=modifier}function _animateModifier(index,size,position,opacity){var currState=this._states[index],currSize=currState.size,currOpacity=currState.opacity,currTransform=currState.transform,transition=this.options.transition;currTransform.halt(),currOpacity.halt(),currSize.halt(),currTransform.setTranslate(position,transition),currSize.set(size,transition),currOpacity.set(opacity,transition)}var Entity=_dereq_("../core/Entity"),Transform=(_dereq_("../core/RenderNode"),_dereq_("../core/Transform")),ViewSequence=_dereq_("../core/ViewSequence"),EventHandler=_dereq_("../core/EventHandler"),Modifier=_dereq_("../core/Modifier"),OptionsManager=_dereq_("../core/OptionsManager"),Transitionable=_dereq_("../transitions/Transitionable"),TransitionableTransform=_dereq_("../transitions/TransitionableTransform");GridLayout.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},GridLayout.prototype.render=function(){return this.id},GridLayout.prototype.setOptions=function(options){return this.optionsManager.setOptions(options)},GridLayout.prototype.sequenceFrom=function(sequence){sequence instanceof Array&&(sequence=new ViewSequence(sequence)),this.sequence=sequence},GridLayout.prototype.commit=function(context){var transform=context.transform,opacity=context.opacity,origin=context.origin,size=context.size,cols=this.options.dimensions[0],rows=this.options.dimensions[1];(size[0]!==this._contextSizeCache[0]||size[1]!==this._contextSizeCache[1]||cols!==this._dimensionsCache[0]||rows!==this._dimensionsCache[1])&&_reflow.call(this,size,cols,rows);for(var sequence=this.sequence,result=[],currIndex=0;sequence&&currIndex<this._modifiers.length;){var item=sequence.get(),modifier=this._modifiers[currIndex];currIndex>=this._activeCount&&this._states[currIndex].opacity.isActive()&&(this._modifiers.splice(currIndex,1),this._states.splice(currIndex,1)),item&&result.push(modifier.modify({origin:origin,target:item.render()})),sequence=sequence.getNext(),currIndex++}return size&&(transform=Transform.moveThen([-size[0]*origin[0],-size[1]*origin[1],0],transform)),{transform:transform,opacity:opacity,size:size,target:result}},module.exports=GridLayout},{"../core/Entity":5,"../core/EventHandler":7,"../core/Modifier":9,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../core/ViewSequence":17,"../transitions/Transitionable":88,"../transitions/TransitionableTransform":89}],104:[function(_dereq_,module){function HeaderFooterLayout(options){this.options=Object.create(HeaderFooterLayout.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._entityId=Entity.register(this),this.header=new RenderNode,this.footer=new RenderNode,this.content=new RenderNode}function _resolveNodeSize(node,defaultSize){var nodeSize=node.getSize();return nodeSize?nodeSize[this.options.direction]:defaultSize}function _outputTransform(offset){return this.options.direction===HeaderFooterLayout.DIRECTION_X?Transform.translate(offset,0,0):Transform.translate(0,offset,0)}function _finalSize(directionSize,size){return this.options.direction===HeaderFooterLayout.DIRECTION_X?[directionSize,size[1]]:[size[0],directionSize]}var Entity=_dereq_("../core/Entity"),RenderNode=_dereq_("../core/RenderNode"),Transform=_dereq_("../core/Transform"),OptionsManager=_dereq_("../core/OptionsManager");HeaderFooterLayout.DIRECTION_X=0,HeaderFooterLayout.DIRECTION_Y=1,HeaderFooterLayout.DEFAULT_OPTIONS={direction:HeaderFooterLayout.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},HeaderFooterLayout.prototype.render=function(){return this._entityId},HeaderFooterLayout.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},HeaderFooterLayout.prototype.commit=function(context){var transform=context.transform,origin=context.origin,size=context.size,opacity=context.opacity,headerSize=void 0!==this.options.headerSize?this.options.headerSize:_resolveNodeSize.call(this,this.header,this.options.defaultHeaderSize),footerSize=void 0!==this.options.footerSize?this.options.footerSize:_resolveNodeSize.call(this,this.footer,this.options.defaultFooterSize),contentSize=size[this.options.direction]-headerSize-footerSize;size&&(transform=Transform.moveThen([-size[0]*origin[0],-size[1]*origin[1],0],transform));var result=[{size:_finalSize.call(this,headerSize,size),target:this.header.render()},{transform:_outputTransform.call(this,headerSize),size:_finalSize.call(this,contentSize,size),target:this.content.render()},{transform:_outputTransform.call(this,headerSize+contentSize),size:_finalSize.call(this,footerSize,size),target:this.footer.render()}];return{transform:transform,opacity:opacity,size:size,target:result}},module.exports=HeaderFooterLayout},{"../core/Entity":5,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15}],105:[function(_dereq_,module){function Lightbox(options){this.options=Object.create(Lightbox.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var Transform=_dereq_("../core/Transform"),Modifier=_dereq_("../core/Modifier"),RenderNode=_dereq_("../core/RenderNode"),Utility=_dereq_("../utilities/Utility"),OptionsManager=_dereq_("../core/OptionsManager"),Transitionable=_dereq_("../transitions/Transitionable"),TransitionableTransform=_dereq_("../transitions/TransitionableTransform");Lightbox.DEFAULT_OPTIONS={inTransform:Transform.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:Transform.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:Transform.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},Lightbox.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},Lightbox.prototype.show=function(renderable,transition,callback){if(!renderable)return this.hide(callback);if(transition instanceof Function&&(callback=transition,transition=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,renderable,transition,callback));this.hide()}this._showing=!0;var stateItem={transform:new TransitionableTransform(this.options.inTransform),origin:new Transitionable(this.options.inOrigin),align:new Transitionable(this.options.inAlign),opacity:new Transitionable(this.options.inOpacity)},transform=new Modifier({transform:stateItem.transform,opacity:stateItem.opacity,origin:stateItem.origin,align:stateItem.align}),node=new RenderNode;node.add(transform).add(renderable),this.nodes.push(node),this.states.push(stateItem),this.transforms.push(transform);var _cb=callback?Utility.after(3,callback):void 0;transition||(transition=this.options.inTransition),stateItem.transform.set(this.options.showTransform,transition,_cb),stateItem.opacity.set(this.options.showOpacity,transition,_cb),stateItem.origin.set(this.options.showOrigin,transition,_cb),stateItem.align.set(this.options.showAlign,transition,_cb)},Lightbox.prototype.hide=function(transition,callback){if(this._showing){this._showing=!1,transition instanceof Function&&(callback=transition,transition=void 0);var node=this.nodes[this.nodes.length-1],transform=this.transforms[this.transforms.length-1],stateItem=this.states[this.states.length-1],_cb=Utility.after(3,function(){this.nodes.splice(this.nodes.indexOf(node),1),this.states.splice(this.states.indexOf(stateItem),1),this.transforms.splice(this.transforms.indexOf(transform),1),callback&&callback.call(this)}.bind(this));transition||(transition=this.options.outTransition),stateItem.transform.set(this.options.outTransform,transition,_cb),stateItem.opacity.set(this.options.outOpacity,transition,_cb),stateItem.origin.set(this.options.outOrigin,transition,_cb),stateItem.align.set(this.options.outAlign,transition,_cb)}},Lightbox.prototype.render=function(){for(var result=[],i=0;i<this.nodes.length;i++)result.push(this.nodes[i].render());return result},module.exports=Lightbox},{"../core/Modifier":9,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":88,"../transitions/TransitionableTransform":89,"../utilities/Utility":95}],106:[function(_dereq_,module){function RenderController(){View.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=RenderController.DefaultMap.transform,this.inOpacityMap=RenderController.DefaultMap.opacity,this.inOriginMap=RenderController.DefaultMap.origin,this.outTransformMap=RenderController.DefaultMap.transform,this.outOpacityMap=RenderController.DefaultMap.opacity,this.outOriginMap=RenderController.DefaultMap.origin,this._output=[]}function _mappedState(map,state){return map(state.get())}var Modifier=_dereq_("../core/Modifier"),RenderNode=_dereq_("../core/RenderNode"),Transform=_dereq_("../core/Transform"),Transitionable=_dereq_("../transitions/Transitionable"),View=_dereq_("../core/View");RenderController.prototype=Object.create(View.prototype),RenderController.prototype.constructor=RenderController,RenderController.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},RenderController.DefaultMap={transform:function(){return Transform.identity},opacity:function(progress){return progress},origin:null},RenderController.prototype.inTransformFrom=function(transform){if(transform instanceof Function)this.inTransformMap=transform;else{if(!transform||!transform.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=transform.get.bind(transform)}return this},RenderController.prototype.inOpacityFrom=function(opacity){if(opacity instanceof Function)this.inOpacityMap=opacity;else{if(!opacity||!opacity.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=opacity.get.bind(opacity)}return this},RenderController.prototype.inOriginFrom=function(origin){if(origin instanceof Function)this.inOriginMap=origin;else{if(!origin||!origin.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=origin.get.bind(origin)}return this},RenderController.prototype.outTransformFrom=function(transform){if(transform instanceof Function)this.outTransformMap=transform;else{if(!transform||!transform.get)throw new Error("outTransformFrom takes only function or getter object");this.outTransformMap=transform.get.bind(transform)}return this},RenderController.prototype.outOpacityFrom=function(opacity){if(opacity instanceof Function)this.outOpacityMap=opacity;else{if(!opacity||!opacity.get)throw new Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=opacity.get.bind(opacity)}return this},RenderController.prototype.outOriginFrom=function(origin){if(origin instanceof Function)this.outOriginMap=origin;else{if(!origin||!origin.get)throw new Error("outOriginFrom takes only function or getter object");this.outOriginMap=origin.get.bind(origin)}return this},RenderController.prototype.show=function(renderable,transition,callback){if(!renderable)return this.hide(callback);if(transition instanceof Function&&(callback=transition,transition=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=renderable:(this._nextRenderable=renderable,this.hide(function(){this._nextRenderable===renderable&&this.show(this._nextRenderable,callback),this._nextRenderable=null})));this.hide()}var state=null,renderableIndex=this._renderables.indexOf(renderable);if(renderableIndex>=0){this._showing=renderableIndex,state=this._states[renderableIndex],state.halt();var outgoingIndex=this._outgoingRenderables.indexOf(renderable);outgoingIndex>=0&&this._outgoingRenderables.splice(outgoingIndex,1)}else{state=new Transitionable(0);var modifier=new Modifier({transform:this.inTransformMap?_mappedState.bind(this,this.inTransformMap,state):null,opacity:this.inOpacityMap?_mappedState.bind(this,this.inOpacityMap,state):null,origin:this.inOriginMap?_mappedState.bind(this,this.inOriginMap,state):null}),node=new RenderNode;node.add(modifier).add(renderable),this._showing=this._nodes.length,this._nodes.push(node),this._modifiers.push(modifier),this._states.push(state),this._renderables.push(renderable)}transition||(transition=this.options.inTransition),state.set(1,transition,callback)},RenderController.prototype.hide=function(transition,callback){if(!(this._showing<0)){var index=this._showing;this._showing=-1,transition instanceof Function&&(callback=transition,transition=void 0);var node=this._nodes[index],modifier=this._modifiers[index],state=this._states[index],renderable=this._renderables[index];modifier.transformFrom(this.outTransformMap?_mappedState.bind(this,this.outTransformMap,state):null),modifier.opacityFrom(this.outOpacityMap?_mappedState.bind(this,this.outOpacityMap,state):null),modifier.originFrom(this.outOriginMap?_mappedState.bind(this,this.outOriginMap,state):null),this._outgoingRenderables.indexOf(renderable)<0&&this._outgoingRenderables.push(renderable),transition||(transition=this.options.outTransition),state.halt(),state.set(0,transition,function(node,modifier,state,renderable){if(this._outgoingRenderables.indexOf(renderable)>=0){var index=this._nodes.indexOf(node);this._nodes.splice(index,1),this._modifiers.splice(index,1),this._states.splice(index,1),this._renderables.splice(index,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(renderable),1),this._showing>=index&&this._showing--}callback&&callback.call(this)}.bind(this,node,modifier,state,renderable))}},RenderController.prototype.render=function(){var result=this._output;result.length>this._nodes.length&&result.splice(this._nodes.length);for(var i=0;i<this._nodes.length;i++)result[i]=this._nodes[i].render();return result},module.exports=RenderController},{"../core/Modifier":9,"../core/RenderNode":11,"../core/Transform":15,"../core/View":16,"../transitions/Transitionable":88}],107:[function(_dereq_,module){function ScrollContainer(options){this.options=Object.create(ScrollContainer.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this.container=new ContainerSurface(this.options.container),this.scrollview=new Scrollview(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new EventHandler,EventHandler.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var ContainerSurface=_dereq_("../surfaces/ContainerSurface"),EventHandler=_dereq_("../core/EventHandler"),Scrollview=_dereq_("./Scrollview"),OptionsManager=(_dereq_("../utilities/Utility"),_dereq_("../core/OptionsManager"));ScrollContainer.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},ScrollContainer.prototype.setOptions=function(options){return this._optionsManager.setOptions(options)},ScrollContainer.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},ScrollContainer.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},ScrollContainer.prototype.render=function(){return this.container.render()},module.exports=ScrollContainer},{"../core/EventHandler":7,"../core/OptionsManager":10,"../surfaces/ContainerSurface":75,"../utilities/Utility":95,"./Scrollview":109}],108:[function(_dereq_,module){function Scroller(options){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),options&&this._optionsManager.setOptions(options),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new Group,this.group.add({render:_innerRender.bind(this)}),this._entityId=Entity.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new EventHandler,this._eventOutput=new EventHandler,EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput)}function _sizeForDir(size){size||(size=this._contextSize);var dimension=this.options.direction;return void 0===size[dimension]?this._contextSize[dimension]:size[dimension]}function _output(node,offset,target){var size=node.getSize?node.getSize():this._contextSize,transform=this._outputFunction(offset);return target.push({transform:transform,target:node.render()}),_sizeForDir.call(this,size)}function _getClipSize(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?_sizeForDir.call(this,this.getCumulativeSize()):_sizeForDir.call(this,this._contextSize)}function _innerRender(){for(var size=null,position=this._position,result=[],offset=-this._positionOffset,clipSize=_getClipSize.call(this),currNode=this._node;currNode&&offset-position<clipSize+this.options.margin;)offset+=_output.call(this,currNode,offset,result),currNode=currNode.getNext?currNode.getNext():null;var sizeNode=this._node,nodesSize=_sizeForDir.call(this,sizeNode.getSize());if(clipSize>offset){for(;sizeNode&&clipSize>nodesSize;)sizeNode=sizeNode.getPrevious(),sizeNode&&(nodesSize+=_sizeForDir.call(this,sizeNode.getSize()));for(sizeNode=this._node;sizeNode&&clipSize>nodesSize;)sizeNode=sizeNode.getNext(),sizeNode&&(nodesSize+=_sizeForDir.call(this,sizeNode.getSize()))}for(!currNode&&clipSize-EDGE_TOLERANCE>offset-position?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:offset-clipSize})):!this._node.getPrevious()&&-EDGE_TOLERANCE>position?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),currNode=this._node&&this._node.getPrevious?this._node.getPrevious():null,offset=-this._positionOffset,currNode&&(size=currNode.getSize?currNode.getSize():this._contextSize,offset-=_sizeForDir.call(this,size));currNode&&offset-position>-(clipSize+this.options.margin);)_output.call(this,currNode,offset,result),currNode=currNode.getPrevious?currNode.getPrevious():null,currNode&&(size=currNode.getSize?currNode.getSize():this._contextSize,offset-=_sizeForDir.call(this,size));return result}var Entity=_dereq_("../core/Entity"),Group=_dereq_("../core/Group"),OptionsManager=_dereq_("../core/OptionsManager"),Transform=_dereq_("../core/Transform"),Utility=_dereq_("../utilities/Utility"),ViewSequence=_dereq_("../core/ViewSequence"),EventHandler=_dereq_("../core/EventHandler");Scroller.DEFAULT_OPTIONS={direction:Utility.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var EDGE_TOLERANCE=0;Scroller.prototype.getCumulativeSize=function(index){return void 0===index&&(index=this._node._.cumulativeSizes.length-1),this._node._.getSize(index)},Scroller.prototype.setOptions=function(options){options.groupScroll!==this.options.groupScroll&&(options.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(options)},Scroller.prototype.onEdge=function(){return this._onEdge},Scroller.prototype.outputFrom=function(fn,masterFn){fn||(fn=function(offset){return this.options.direction===Utility.Direction.X?Transform.translate(offset,0):Transform.translate(0,offset)}.bind(this),masterFn||(masterFn=fn)),this._outputFunction=fn,this._masterOutputFunction=masterFn?masterFn:function(offset){return Transform.inverse(fn(-offset))}},Scroller.prototype.positionFrom=function(position){position instanceof Function?this._positionGetter=position:position&&position.get?this._positionGetter=position.get.bind(position):(this._positionGetter=null,this._position=position),this._positionGetter&&(this._position=this._positionGetter.call(this))},Scroller.prototype.sequenceFrom=function(node){node instanceof Array&&(node=new ViewSequence({array:node})),this._node=node,this._positionOffset=0},Scroller.prototype.getSize=function(actual){return actual?this._contextSize:this._size},Scroller.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},Scroller.prototype.commit=function(context){var transform=context.transform,opacity=context.opacity,origin=context.origin,size=context.size;this.options.clipSize||size[0]===this._contextSize[0]&&size[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=size[0],this._contextSize[1]=size[1],this.options.direction===Utility.Direction.X?(this._size[0]=_getClipSize.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=_getClipSize.call(this)));var scrollTransform=this._masterOutputFunction(-this._position);return{transform:Transform.multiply(transform,scrollTransform),size:size,opacity:opacity,origin:origin,target:this.group.render()}},module.exports=Scroller},{"../core/Entity":5,"../core/EventHandler":7,"../core/Group":8,"../core/OptionsManager":10,"../core/Transform":15,"../core/ViewSequence":17,"../utilities/Utility":95}],109:[function(_dereq_,module){function Scrollview(options){this.options=Object.create(Scrollview.DEFAULT_OPTIONS),this._optionsManager=new OptionsManager(this.options),this._scroller=new Scroller(this.options),this.sync=new GenericSync(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==Utility.Direction.Y}),this._physicsEngine=new PhysicsEngine,this._particle=new Particle,this._physicsEngine.addBody(this._particle),this.spring=new Spring({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new Drag({forceFunction:Drag.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new Drag({forceFunction:Drag.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=SpringStates.NONE,this._onEdge=EdgeStates.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new EventHandler,this._eventOutput=new EventHandler,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),EventHandler.setInputHandler(this,this._eventInput),EventHandler.setOutputHandler(this,this._eventOutput),_bindEvents.call(this),options&&this.setOptions(options)}function _handleStart(event){this._touchCount=event.count,void 0===event.count&&(this._touchCount=1),_detachAgents.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function _handleMove(event){var velocity=-event.velocity,delta=-event.delta;if(this._onEdge!==EdgeStates.NONE&&event.slip&&(0>velocity&&this._onEdge===EdgeStates.TOP||velocity>0&&this._onEdge===EdgeStates.BOTTOM?this._earlyEnd||(_handleEnd.call(this,event),this._earlyEnd=!0):this._earlyEnd&&Math.abs(velocity)>Math.abs(this.getVelocity())&&_handleStart.call(this,event)),!this._earlyEnd){if(this._touchVelocity=velocity,event.slip){var speedLimit=this.options.speedLimit;-speedLimit>velocity?velocity=-speedLimit:velocity>speedLimit&&(velocity=speedLimit),this.setVelocity(velocity);var deltaLimit=16*speedLimit;delta>deltaLimit?delta=deltaLimit:-deltaLimit>delta&&(delta=-deltaLimit)}this.setPosition(this.getPosition()+delta),this._displacement+=delta,this._springState===SpringStates.NONE&&_normalizeState.call(this)}}function _handleEnd(event){if(this._touchCount=event.count||0,!this._touchCount){_detachAgents.call(this),this._onEdge!==EdgeStates.NONE&&_setSpring.call(this,this._edgeSpringPosition,SpringStates.EDGE),_attachAgents.call(this);var velocity=-event.velocity,speedLimit=this.options.speedLimit;event.slip&&(speedLimit*=this.options.edgeGrip),-speedLimit>velocity?velocity=-speedLimit:velocity>speedLimit&&(velocity=speedLimit),this.setVelocity(velocity),this._touchVelocity=0,this._needsPaginationCheck=!0}}function _bindEvents(){this._eventInput.bindThis(this),this._eventInput.on("start",_handleStart),this._eventInput.on("update",_handleMove),this._eventInput.on("end",_handleEnd),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(data){this._edgeSpringPosition=data.position,_handleEdge.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(particle){this._springState===SpringStates.NONE&&_normalizeState.call(this),this._displacement=particle.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==SpringStates.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function _attachAgents(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function _detachAgents(){this._springState=SpringStates.NONE,this._physicsEngine.detachAll()}function _nodeSizeForDirection(node){var direction=this.options.direction,nodeSize=node.getSize();return nodeSize?nodeSize[direction]:this._scroller.getSize()[direction]}function _handleEdge(edge){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=edge,this._touchCount||this._springState===SpringStates.EDGE||_setSpring.call(this,this._edgeSpringPosition,SpringStates.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(_detachAgents.call(this),_attachAgents.call(this))}function _handlePagination(){if(!this._touchCount&&this._springState!==SpringStates.EDGE){var velocity=this.getVelocity();if(!(Math.abs(velocity)>=this.options.pageStopSpeed)){var position=this.getPosition(),velocitySwitch=Math.abs(velocity)>this.options.pageSwitchSpeed,nodeSize=_nodeSizeForDirection.call(this,this._node),positionNext=position>.5*nodeSize,velocityNext=velocity>0,velocityPrev=0>velocity;this._needsPaginationCheck=!1,positionNext&&!velocitySwitch||velocitySwitch&&velocityNext?this.goToNextPage():velocitySwitch&&velocityPrev?this.goToPreviousPage():_setSpring.call(this,0,SpringStates.PAGE)}}}function _setSpring(position,springState){var springOptions;springState===SpringStates.EDGE?(this._edgeSpringPosition=position,springOptions={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):springState===SpringStates.PAGE&&(this._pageSpringPosition=position,springOptions={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(springOptions),springState&&!this._springState&&(_detachAgents.call(this),this._springState=springState,_attachAgents.call(this)),this._springState=springState}function _normalizeState(){var offset=0,position=this.getPosition();position+=(0>position?-.5:.5)>>0;for(var nodeSize=_nodeSizeForDirection.call(this,this._node),nextNode=this._node.getNext();offset+position>=nodeSize&&nextNode;)offset-=nodeSize,this._scroller.sequenceFrom(nextNode),this._node=nextNode,nextNode=this._node.getNext(),nodeSize=_nodeSizeForDirection.call(this,this._node);for(var previousNodeSize,previousNode=this._node.getPrevious();0>=offset+position&&previousNode;)previousNodeSize=_nodeSizeForDirection.call(this,previousNode),this._scroller.sequenceFrom(previousNode),this._node=previousNode,offset+=previousNodeSize,previousNode=this._node.getPrevious();offset&&_shiftOrigin.call(this,offset),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*nodeSize&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*nodeSize&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function _shiftOrigin(amount){this._edgeSpringPosition+=amount,this._pageSpringPosition+=amount,this.setPosition(this.getPosition()+amount),this._totalShift+=amount,this._springState===SpringStates.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===SpringStates.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var PhysicsEngine=_dereq_("../physics/PhysicsEngine"),Particle=_dereq_("../physics/bodies/Particle"),Drag=_dereq_("../physics/forces/Drag"),Spring=_dereq_("../physics/forces/Spring"),EventHandler=_dereq_("../core/EventHandler"),OptionsManager=_dereq_("../core/OptionsManager"),ViewSequence=_dereq_("../core/ViewSequence"),Scroller=_dereq_("../views/Scroller"),Utility=_dereq_("../utilities/Utility"),GenericSync=_dereq_("../inputs/GenericSync"),ScrollSync=_dereq_("../inputs/ScrollSync"),TouchSync=_dereq_("../inputs/TouchSync");GenericSync.register({scroll:ScrollSync,touch:TouchSync});var SpringStates={NONE:0,EDGE:1,PAGE:2},EdgeStates={TOP:-1,NONE:0,BOTTOM:1};Scrollview.DEFAULT_OPTIONS={direction:Utility.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},Scrollview.prototype.getCurrentIndex=function(){return this._node.index},Scrollview.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===EdgeStates.TOP)return null;if(this.getPosition()>1&&this._springState===SpringStates.NONE)return _setSpring.call(this,0,SpringStates.PAGE),this._node;var previousNode=this._node.getPrevious();if(previousNode){var previousNodeSize=_nodeSizeForDirection.call(this,previousNode);this._scroller.sequenceFrom(previousNode),this._node=previousNode,_shiftOrigin.call(this,previousNodeSize),_setSpring.call(this,0,SpringStates.PAGE)}return previousNode},Scrollview.prototype.goToNextPage=function(){if(!this._node||this._onEdge===EdgeStates.BOTTOM)return null;var nextNode=this._node.getNext();if(nextNode){var currentNodeSize=_nodeSizeForDirection.call(this,this._node);this._scroller.sequenceFrom(nextNode),this._node=nextNode,_shiftOrigin.call(this,-currentNodeSize),_setSpring.call(this,0,SpringStates.PAGE)}return nextNode},Scrollview.prototype.goToPage=function(index){var i,currentIndex=this.getCurrentIndex();if(currentIndex>index)for(i=0;currentIndex-index>i;i++)this.goToPreviousPage();
if(index>currentIndex)for(i=0;index-currentIndex>i;i++)this.goToNextPage()},Scrollview.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},Scrollview.prototype.getPosition=function(){return this._particle.getPosition1D()},Scrollview.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},Scrollview.prototype.getOffset=Scrollview.prototype.getPosition,Scrollview.prototype.setPosition=function(x){this._particle.setPosition1D(x)},Scrollview.prototype.setOffset=Scrollview.prototype.setPosition,Scrollview.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},Scrollview.prototype.setVelocity=function(v){this._particle.setVelocity1D(v)},Scrollview.prototype.setOptions=function(options){void 0!==options.direction&&("x"===options.direction?options.direction=Utility.Direction.X:"y"===options.direction&&(options.direction=Utility.Direction.Y)),options.groupScroll!==this.options.groupScroll&&(options.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(options),this._scroller.setOptions(options),void 0!==options.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==options.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==options.edgePeriod||void 0!==options.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(options.rails||void 0!==options.direction||void 0!==options.syncScale||options.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===Utility.Direction.X?GenericSync.DIRECTION_X:GenericSync.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},Scrollview.prototype.sequenceFrom=function(node){return node instanceof Array&&(node=new ViewSequence({array:node,trackSize:!0})),this._node=node,this._scroller.sequenceFrom(node)},Scrollview.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},Scrollview.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&_handlePagination.call(this),this._scroller.render()},module.exports=Scrollview},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/ViewSequence":17,"../inputs/GenericSync":27,"../inputs/ScrollSync":32,"../inputs/TouchSync":33,"../physics/PhysicsEngine":48,"../physics/bodies/Particle":51,"../physics/forces/Drag":63,"../physics/forces/Spring":68,"../utilities/Utility":95,"../views/Scroller":108}],110:[function(_dereq_,module){function SequentialLayout(options){this._items=null,this._size=null,this._outputFunction=SequentialLayout.DEFAULT_OUTPUT_FUNCTION,this.options=Utility.clone(this.constructor.DEFAULT_OPTIONS||SequentialLayout.DEFAULT_OPTIONS),this.optionsManager=new OptionsManager(this.options),options&&this.setOptions(options)}var OptionsManager=_dereq_("../core/OptionsManager"),Transform=_dereq_("../core/Transform"),ViewSequence=_dereq_("../core/ViewSequence"),Utility=_dereq_("../utilities/Utility");SequentialLayout.DEFAULT_OPTIONS={direction:Utility.Direction.Y,itemSpacing:0},SequentialLayout.DEFAULT_OUTPUT_FUNCTION=function(input,offset){var transform=this.options.direction===Utility.Direction.X?Transform.translate(offset,0):Transform.translate(0,offset);return{transform:transform,target:input.render()}},SequentialLayout.prototype.getSize=function(){return this._size||this.render(),this._size},SequentialLayout.prototype.sequenceFrom=function(items){return items instanceof Array&&(items=new ViewSequence(items)),this._items=items,this},SequentialLayout.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},SequentialLayout.prototype.setOutputFunction=function(outputFunction){return this._outputFunction=outputFunction,this},SequentialLayout.prototype.render=function(){var length=0,secondaryDirection=1^this.options.direction,currentNode=this._items,item=null,itemSize=[],output={},result=[],i=0;for(this._size=[0,0];currentNode&&(item=currentNode.get());)item.getSize&&(itemSize=item.getSize()),output=this._outputFunction.call(this,item,length,i++),result.push(output),itemSize&&(itemSize[this.options.direction]&&(length+=itemSize[this.options.direction]),itemSize[secondaryDirection]>this._size[secondaryDirection]&&(this._size[secondaryDirection]=itemSize[secondaryDirection])),currentNode=currentNode.getNext(),this.options.itemSpacing&&currentNode&&(length+=this.options.itemSpacing);return this._size[this.options.direction]=length,result},module.exports=SequentialLayout},{"../core/OptionsManager":10,"../core/Transform":15,"../core/ViewSequence":17,"../utilities/Utility":95}],111:[function(_dereq_,module){module.exports={ContextualView:_dereq_("./ContextualView"),Deck:_dereq_("./Deck"),DrawerLayout:_dereq_("./DrawerLayout"),EdgeSwapper:_dereq_("./EdgeSwapper"),FlexibleLayout:_dereq_("./FlexibleLayout"),Flipper:_dereq_("./Flipper"),GridLayout:_dereq_("./GridLayout"),HeaderFooterLayout:_dereq_("./HeaderFooterLayout"),Lightbox:_dereq_("./Lightbox"),RenderController:_dereq_("./RenderController"),ScrollContainer:_dereq_("./ScrollContainer"),Scroller:_dereq_("./Scroller"),Scrollview:_dereq_("./Scrollview"),SequentialLayout:_dereq_("./SequentialLayout")}},{"./ContextualView":97,"./Deck":98,"./DrawerLayout":99,"./EdgeSwapper":100,"./FlexibleLayout":101,"./Flipper":102,"./GridLayout":103,"./HeaderFooterLayout":104,"./Lightbox":105,"./RenderController":106,"./ScrollContainer":107,"./Scroller":108,"./Scrollview":109,"./SequentialLayout":110}],112:[function(_dereq_,module){function NavigationBar(){View.apply(this,arguments),this.title=new Surface({classes:this.options.classes,content:this.options.content}),this.back=new Surface({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.backContent}),this.back.on("click",function(){this._eventOutput.emit("back",{})}.bind(this)),this.more=new Surface({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.moreContent}),this.more.on("click",function(){this._eventOutput.emit("more",{})}.bind(this)),this.layout=new Scene({id:"master",size:this.options.size,target:[{transform:Transform.inFront,origin:[0,.5],target:this.back},{origin:[.5,.5],target:this.title},{transform:Transform.inFront,origin:[1,.5],target:this.more}]}),this._add(this.layout),this._optionsManager.on("change",function(event){var key=event.id,data=event.value;"size"===key?(this.layout.id.master.setSize(data),this.title.setSize(data),this.back.setSize([data[1],data[1]]),this.more.setSize([data[1],data[1]])):"backClasses"===key?this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}):"backContent"===key?this.back.setContent(this.options.backContent):"classes"===key?(this.title.setOptions({classes:this.options.classes}),this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}),this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)})):"content"===key?this.setContent(this.options.content):"moreClasses"===key?this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)}):"moreContent"===key&&this.more.setContent(this.options.content)}.bind(this))}var Scene=_dereq_("../core/Scene"),Surface=_dereq_("../core/Surface"),Transform=_dereq_("../core/Transform"),View=_dereq_("../core/View");NavigationBar.prototype=Object.create(View.prototype),NavigationBar.prototype.constructor=NavigationBar,NavigationBar.DEFAULT_OPTIONS={size:[void 0,50],backClasses:["back"],backContent:"&#x25c0;",classes:["navigation"],content:"",moreClasses:["more"],moreContent:"&#x271a;"},NavigationBar.prototype.setContent=function(content){return this.title.setContent(content)},module.exports=NavigationBar},{"../core/Scene":12,"../core/Surface":14,"../core/Transform":15,"../core/View":16}],113:[function(_dereq_,module){function Slider(options){this.options=Object.create(Slider.DEFAULT_OPTIONS),this.optionsManager=new OptionsManager(this.options),options&&this.setOptions(options),this.indicator=new CanvasSurface({size:this.options.indicatorSize,classes:["slider-back"]}),this.label=new Surface({size:this.options.labelSize,content:this.options.label,properties:{pointerEvents:"none"},classes:["slider-label"]}),this.eventOutput=new EventHandler,this.eventInput=new EventHandler,EventHandler.setInputHandler(this,this.eventInput),EventHandler.setOutputHandler(this,this.eventOutput);var scale=(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0];this.sync=new GenericSync(["mouse","touch"],{scale:scale,direction:GenericSync.DIRECTION_X}),this.indicator.pipe(this.sync),this.sync.pipe(this),this.eventInput.on("update",function(data){this.set(data.position)}.bind(this)),this._drawPos=0,_updateLabel.call(this)}function _updateLabel(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var Surface=_dereq_("../core/Surface"),CanvasSurface=_dereq_("../surfaces/CanvasSurface"),Transform=_dereq_("../core/Transform"),EventHandler=_dereq_("../core/EventHandler"),Utilities=_dereq_("../math/Utilities"),OptionsManager=_dereq_("../core/OptionsManager"),MouseSync=_dereq_("../inputs/MouseSync"),TouchSync=_dereq_("../inputs/TouchSync"),GenericSync=_dereq_("../inputs/GenericSync");GenericSync.register({mouse:MouseSync,touch:TouchSync}),Slider.DEFAULT_OPTIONS={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,value:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},Slider.prototype.setOptions=function(options){return this.optionsManager.setOptions(options)},Slider.prototype.get=function(){return this.options.value},Slider.prototype.set=function(value){value!==this.options.value&&(this.options.value=Utilities.clamp(value,this.options.range),_updateLabel.call(this),this.eventOutput.emit("change",{value:value}))},Slider.prototype.getSize=function(){return this.options.size},Slider.prototype.render=function(){var range=this.options.range,fillSize=Math.floor((this.get()-range[0])/(range[1]-range[0])*this.options.indicatorSize[0]);if(fillSize<this._drawPos)this.indicator.getContext("2d").clearRect(fillSize,0,this._drawPos-fillSize+1,this.options.indicatorSize[1]);else if(fillSize>this._drawPos){var ctx=this.indicator.getContext("2d");ctx.fillStyle=this.options.fillColor,ctx.fillRect(this._drawPos-1,0,fillSize-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=fillSize,{size:this.options.size,target:[{origin:[0,0],target:this.indicator.render()},{transform:Transform.translate(0,0,1),origin:[0,0],target:this.label.render()}]}},module.exports=Slider},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Surface":14,"../core/Transform":15,"../inputs/GenericSync":27,"../inputs/MouseSync":28,"../inputs/TouchSync":33,"../math/Utilities":40,"../surfaces/CanvasSurface":74}],114:[function(_dereq_,module){function TabBar(){View.apply(this,arguments),this.layout=new GridLayout,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._add(this.layout),this._optionsManager.on("change",_updateOptions.bind(this))}function _updateOptions(data){var id=data.id,value=data.value;if("direction"===id)this.layout.setOptions({dimensions:_resolveGridDimensions.call(this.buttons.length,this.options.direction)});else if("buttons"===id)for(var i in this.buttons)this.buttons[i].setOptions(value);else if("sections"===id)for(var sectionId in this.options.sections)this.defineSection(sectionId,this.options.sections[sectionId])}function _resolveGridDimensions(count,direction){return direction===Utility.Direction.X?[count,1]:[1,count]}var Utility=_dereq_("../utilities/Utility"),View=_dereq_("../core/View"),GridLayout=_dereq_("../views/GridLayout"),ToggleButton=_dereq_("./ToggleButton");TabBar.prototype=Object.create(View.prototype),TabBar.prototype.constructor=TabBar,TabBar.DEFAULT_OPTIONS={sections:[],widget:ToggleButton,size:[void 0,50],direction:Utility.Direction.X,buttons:{toggleMode:ToggleButton.ON}},TabBar.prototype.defineSection=function(id,content){var button,i=this._buttonIds[id];if(void 0===i){i=this.buttons.length,this._buttonIds[id]=i;var widget=this.options.widget;button=new widget,this.buttons[i]=button,this.layout.setOptions({dimensions:_resolveGridDimensions(this.buttons.length,this.options.direction)})}else button=this.buttons[i],button.unbind("select",this._buttonCallbacks[id]);this.options.buttons&&button.setOptions(this.options.buttons),button.setOptions(content),this._buttonCallbacks[id]=this.select.bind(this,id),button.on("select",this._buttonCallbacks[id])},TabBar.prototype.select=function(id){var btn=this._buttonIds[id];this.buttons[btn]&&this.buttons[btn].isSelected()?this._eventOutput.emit("select",{id:id}):this.buttons[btn]&&this.buttons[btn].select();for(var i=0;i<this.buttons.length;i++)i!==btn&&this.buttons[i].deselect()},module.exports=TabBar},{"../core/View":16,"../utilities/Utility":95,"../views/GridLayout":103,"./ToggleButton":115}],115:[function(_dereq_,module){function ToggleButton(options){this.options={content:"",offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:ToggleButton.TOGGLE,crossfade:!0},this._eventOutput=new EventHandler,EventHandler.setOutputHandler(this,this._eventOutput),this.offSurface=new Surface,this.offSurface.on("click",function(){this.options.toggleMode!==ToggleButton.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this._eventOutput),this.onSurface=new Surface,this.onSurface.on("click",function(){this.options.toggleMode!==ToggleButton.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this._eventOutput),this.arbiter=new RenderController({overlap:this.options.crossfade}),this.deselect(),options&&this.setOptions(options)}var Surface=_dereq_("../core/Surface"),EventHandler=_dereq_("../core/EventHandler"),RenderController=_dereq_("../views/RenderController");ToggleButton.OFF=0,ToggleButton.ON=1,ToggleButton.TOGGLE=2,ToggleButton.prototype.select=function(){this.selected=!0,this.arbiter.show(this.onSurface,this.options.inTransition),this._eventOutput.emit("select")},ToggleButton.prototype.deselect=function(){this.selected=!1,this.arbiter.show(this.offSurface,this.options.outTransition),this._eventOutput.emit("deselect")},ToggleButton.prototype.isSelected=function(){return this.selected},ToggleButton.prototype.setOptions=function(options){void 0!==options.content&&(this.options.content=options.content,this.offSurface.setContent(this.options.content),this.onSurface.setContent(this.options.content)),options.offClasses&&(this.options.offClasses=options.offClasses,this.offSurface.setClasses(this.options.offClasses)),options.onClasses&&(this.options.onClasses=options.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==options.size&&(this.options.size=options.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==options.toggleMode&&(this.options.toggleMode=options.toggleMode),void 0!==options.outTransition&&(this.options.outTransition=options.outTransition),void 0!==options.inTransition&&(this.options.inTransition=options.inTransition),void 0!==options.crossfade&&(this.options.crossfade=options.crossfade,this.arbiter.setOptions({overlap:this.options.crossfade}))},ToggleButton.prototype.getSize=function(){return this.options.size},ToggleButton.prototype.render=function(){return this.arbiter.render()},module.exports=ToggleButton},{"../core/EventHandler":7,"../core/Surface":14,"../views/RenderController":106}],116:[function(_dereq_,module){module.exports={NavigationBar:_dereq_("./NavigationBar"),Slider:_dereq_("./Slider"),TabBar:_dereq_("./TabBar"),ToggleButton:_dereq_("./ToggleButton")}},{"./NavigationBar":112,"./Slider":113,"./TabBar":114,"./ToggleButton":115}]},{},[23])(23)}),browserify_shim__define__module__export__("undefined"!=typeof famous?famous:window.famous)}.call(global,void 0,void 0,void 0,void 0,function(ex){module.exports=ex})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);
//# sourceMappingURL=app.js.map